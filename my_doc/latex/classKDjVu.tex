\hypertarget{classKDjVu}{\section{K\+Dj\+Vu Class Reference}
\label{classKDjVu}\index{K\+Dj\+Vu@{K\+Dj\+Vu}}
}


Qt (K\+D\+E) encapsulation of the Dj\+Vu\+Libre.  




{\ttfamily \#include $<$kdjvu.\+h$>$}

\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classKDjVu_1_1Annotation}{Annotation}
\item 
class \hyperlink{classKDjVu_1_1LineAnnotation}{Line\+Annotation}
\item 
class \hyperlink{classKDjVu_1_1Link}{Link}
\item 
class \hyperlink{classKDjVu_1_1Page}{Page}
\item 
class \hyperlink{classKDjVu_1_1PageLink}{Page\+Link}
\item 
class \hyperlink{classKDjVu_1_1Private}{Private}
\item 
class \hyperlink{classKDjVu_1_1TextAnnotation}{Text\+Annotation}
\item 
class \hyperlink{classKDjVu_1_1TextEntity}{Text\+Entity}
\item 
class \hyperlink{classKDjVu_1_1UrlLink}{Url\+Link}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classKDjVu_a616b53cbee98267de0ba2d26fc7d31c4}{K\+Dj\+Vu} ()
\item 
\hyperlink{classKDjVu_ae6b2a9ce935439f8479bc6b9f0577b67}{$\sim$\+K\+Dj\+Vu} ()
\item 
bool \hyperlink{classKDjVu_a223ea1608a7b3ed9314bd89a2534dfd5}{open\+File} (const Q\+String \&file\+Name)
\item 
void \hyperlink{classKDjVu_af9c1d642f5ef455739abadf09ed44586}{close\+File} ()
\item 
const Q\+Vector$<$ \hyperlink{classKDjVu_1_1Page}{K\+Dj\+Vu\+::\+Page} $\ast$ $>$ \& \hyperlink{classKDjVu_aea351abdd42f5494382d2d3d20c1a94e}{pages} () const 
\item 
Q\+Variant \hyperlink{classKDjVu_ae1a73203fc07dc0c81996810ca2f7ae3}{meta\+Data} (const Q\+String \&key) const 
\item 
const Q\+Dom\+Document $\ast$ \hyperlink{classKDjVu_a48975c0c9c80a7b85600812c22ed5fda}{document\+Bookmarks} () const 
\item 
void \hyperlink{classKDjVu_a2f2185ed09a1fe26c597f9582f4c34f2}{links\+And\+Annotations\+For\+Page} (int page\+Num, \hyperlink{classQList}{Q\+List}$<$ \hyperlink{classKDjVu_1_1Link}{K\+Dj\+Vu\+::\+Link} $\ast$ $>$ $\ast$links, \hyperlink{classQList}{Q\+List}$<$ \hyperlink{classKDjVu_1_1Annotation}{K\+Dj\+Vu\+::\+Annotation} $\ast$ $>$ $\ast$annotations) const 
\item 
Q\+Image \hyperlink{classKDjVu_a912d8a8a28dfd28bf871c0c1726b266e}{image} (int page, int width, int height, int rotation)
\item 
bool \hyperlink{classKDjVu_a476b8e76dc69d3872166fdf76ae2a8c2}{export\+As\+Post\+Script} (const Q\+String \&file\+Name, const \hyperlink{classQList}{Q\+List}$<$ int $>$ \&page\+List) const 
\item 
bool \hyperlink{classKDjVu_adfba2185adbbd950b89344f576afac23}{export\+As\+Post\+Script} (Q\+File $\ast$file, const \hyperlink{classQList}{Q\+List}$<$ int $>$ \&page\+List) const 
\item 
\hyperlink{classQList}{Q\+List}$<$ \hyperlink{classKDjVu_1_1TextEntity}{K\+Dj\+Vu\+::\+Text\+Entity} $>$ \hyperlink{classKDjVu_a658d09462a1b727a001c6f7f183a3f7e}{text\+Entities} (int page, const Q\+String \&granularity) const 
\item 
void \hyperlink{classKDjVu_a175f29677ef28f549a709b337f917d92}{set\+Cache\+Enabled} (bool enable)
\item 
bool \hyperlink{classKDjVu_ada3da14d01ead551278e089ed49ce4e2}{is\+Cache\+Enabled} () const 
\item 
int \hyperlink{classKDjVu_a5b74281ec02d098b0bac883552fbb2e7}{page\+Number} (const Q\+String \&name) const 
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Qt (K\+D\+E) encapsulation of the Dj\+Vu\+Libre. 

Definition at line 31 of file kdjvu.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classKDjVu_a616b53cbee98267de0ba2d26fc7d31c4}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\index{K\+Dj\+Vu@{K\+Dj\+Vu}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{K\+Dj\+Vu}]{\setlength{\rightskip}{0pt plus 5cm}K\+Dj\+Vu\+::\+K\+Dj\+Vu (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classKDjVu_a616b53cbee98267de0ba2d26fc7d31c4}


Definition at line 638 of file kdjvu.\+cpp.


\begin{DoxyCode}
638              : d( \textcolor{keyword}{new} Private )
639 \{
640     \textcolor{comment}{// creating the djvu context}
641     d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt} = ddjvu\_context\_create( \textcolor{stringliteral}{"KDjVu"} );
642     \textcolor{comment}{// creating the rendering format}
643 \textcolor{preprocessor}{#if DDJVUAPI\_VERSION >= 18}
644     d->\hyperlink{classKDjVu_1_1Private_aad4bfbe2fe3646d6c9f862e6575c00cb}{m\_format} = ddjvu\_format\_create( DDJVU\_FORMAT\_RGBMASK32, 4, 
      \hyperlink{classKDjVu_1_1Private_a4faf2c57e9e0b65a5adf0d55115c6ae1}{Private::s\_formatmask} );
645 \textcolor{preprocessor}{#else}
646     d->\hyperlink{classKDjVu_1_1Private_aad4bfbe2fe3646d6c9f862e6575c00cb}{m\_format} = ddjvu\_format\_create( DDJVU\_FORMAT\_RGBMASK32, 3, 
      \hyperlink{classKDjVu_1_1Private_a4faf2c57e9e0b65a5adf0d55115c6ae1}{Private::s\_formatmask} );
647 \textcolor{preprocessor}{#endif}
648     ddjvu\_format\_set\_row\_order( d->\hyperlink{classKDjVu_1_1Private_aad4bfbe2fe3646d6c9f862e6575c00cb}{m\_format}, 1 );
649     ddjvu\_format\_set\_y\_direction( d->\hyperlink{classKDjVu_1_1Private_aad4bfbe2fe3646d6c9f862e6575c00cb}{m\_format}, 1 );
650 \}
\end{DoxyCode}
\hypertarget{classKDjVu_ae6b2a9ce935439f8479bc6b9f0577b67}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!````~K\+Dj\+Vu@{$\sim$\+K\+Dj\+Vu}}
\index{````~K\+Dj\+Vu@{$\sim$\+K\+Dj\+Vu}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{$\sim$\+K\+Dj\+Vu}]{\setlength{\rightskip}{0pt plus 5cm}K\+Dj\+Vu\+::$\sim$\+K\+Dj\+Vu (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classKDjVu_ae6b2a9ce935439f8479bc6b9f0577b67}


Definition at line 653 of file kdjvu.\+cpp.


\begin{DoxyCode}
654 \{
655     \hyperlink{classKDjVu_af9c1d642f5ef455739abadf09ed44586}{closeFile}();
656 
657     ddjvu\_format\_release( d->\hyperlink{classKDjVu_1_1Private_aad4bfbe2fe3646d6c9f862e6575c00cb}{m\_format} );
658     ddjvu\_context\_release( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt} );
659 
660     \textcolor{keyword}{delete} d;
661 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classKDjVu_af9c1d642f5ef455739abadf09ed44586}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!close\+File@{close\+File}}
\index{close\+File@{close\+File}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{close\+File}]{\setlength{\rightskip}{0pt plus 5cm}void K\+Dj\+Vu\+::close\+File (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classKDjVu_af9c1d642f5ef455739abadf09ed44586}
Close the file currently opened, if any. 

Definition at line 748 of file kdjvu.\+cpp.


\begin{DoxyCode}
749 \{
750     \textcolor{comment}{// deleting the old TOC}
751     \textcolor{keyword}{delete} d->\hyperlink{classKDjVu_1_1Private_a44dd323816fabcc89971ce3d0b9b72a7}{m\_docBookmarks};
752     d->\hyperlink{classKDjVu_1_1Private_a44dd323816fabcc89971ce3d0b9b72a7}{m\_docBookmarks} = 0;
753     \textcolor{comment}{// deleting the pages}
754     qDeleteAll( d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages} );
755     d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.clear();
756     \textcolor{comment}{// releasing the djvu pages}
757     QVector<ddjvu\_page\_t *>::Iterator it = d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.begin(), itEnd = d->
      \hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.end();
758     \textcolor{keywordflow}{for} ( ; it != itEnd; ++it )
759         ddjvu\_page\_release( *it );
760     d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.clear();
761     \textcolor{comment}{// clearing the image cache}
762     qDeleteAll( d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache} );
763     d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.clear();
764     \textcolor{comment}{// clearing the old metadata}
765     d->\hyperlink{classKDjVu_1_1Private_a48e70e9e1d6e964cacaf5bc8295dcba7}{m\_metaData}.clear();
766     \textcolor{comment}{// cleaing the page names mapping}
767     d->\hyperlink{classKDjVu_1_1Private_ad9d14bf5618d9bd6fc6c0595f7122bf5}{m\_pageNamesCache}.clear();
768     \textcolor{comment}{// releasing the old document}
769     \textcolor{keywordflow}{if} ( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} )
770         ddjvu\_document\_release( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} );
771     d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} = 0;
772 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a48975c0c9c80a7b85600812c22ed5fda}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!document\+Bookmarks@{document\+Bookmarks}}
\index{document\+Bookmarks@{document\+Bookmarks}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{document\+Bookmarks}]{\setlength{\rightskip}{0pt plus 5cm}const Q\+Dom\+Document $\ast$ K\+Dj\+Vu\+::document\+Bookmarks (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_a48975c0c9c80a7b85600812c22ed5fda}
Get an X\+M\+L document with the bookmarks of the current document (if any). The X\+M\+L will look like this\+: \begin{DoxyVerb}* <!DOCTYPE KDjVuBookmarks>
* <item title="Title 1" destination="dest1">
*   <item title="Title 1.1" destination="dest1.1" />
*   ...
* </item>
* <item title="Title 2" destination="dest2">
* \end{DoxyVerb}
 

Definition at line 780 of file kdjvu.\+cpp.


\begin{DoxyCode}
781 \{
782     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a44dd323816fabcc89971ce3d0b9b72a7}{m\_docBookmarks} )
783         d->\hyperlink{classKDjVu_1_1Private_a0272321e85183ccde6326dc13a21c2bb}{readBookmarks}();
784     \textcolor{keywordflow}{return} d->\hyperlink{classKDjVu_1_1Private_a44dd323816fabcc89971ce3d0b9b72a7}{m\_docBookmarks};
785 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a476b8e76dc69d3872166fdf76ae2a8c2}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!export\+As\+Post\+Script@{export\+As\+Post\+Script}}
\index{export\+As\+Post\+Script@{export\+As\+Post\+Script}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{export\+As\+Post\+Script}]{\setlength{\rightskip}{0pt plus 5cm}bool K\+Dj\+Vu\+::export\+As\+Post\+Script (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{file\+Name, }
\item[{const {\bf Q\+List}$<$ int $>$ \&}]{page\+List}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_a476b8e76dc69d3872166fdf76ae2a8c2}
Export the currently open document as Post\+Script file {\ttfamily file\+Name}. \begin{DoxyReturn}{Returns}
whether the exporting was successful 
\end{DoxyReturn}


Definition at line 1028 of file kdjvu.\+cpp.


\begin{DoxyCode}
1029 \{
1030     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} || fileName.trimmed().isEmpty() || pageList.isEmpty() )
1031         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1032 
1033     QFile f( fileName );
1034     f.open( QIODevice::ReadWrite );
1035     \textcolor{keywordtype}{bool} ret = \hyperlink{classKDjVu_a476b8e76dc69d3872166fdf76ae2a8c2}{exportAsPostScript}( &f, pageList );
1036     \textcolor{keywordflow}{if} ( ret )
1037     \{
1038         f.close();
1039     \}
1040     \textcolor{keywordflow}{return} ret;
1041 \}
\end{DoxyCode}
\hypertarget{classKDjVu_adfba2185adbbd950b89344f576afac23}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!export\+As\+Post\+Script@{export\+As\+Post\+Script}}
\index{export\+As\+Post\+Script@{export\+As\+Post\+Script}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{export\+As\+Post\+Script}]{\setlength{\rightskip}{0pt plus 5cm}bool K\+Dj\+Vu\+::export\+As\+Post\+Script (
\begin{DoxyParamCaption}
\item[{Q\+File $\ast$}]{file, }
\item[{const {\bf Q\+List}$<$ int $>$ \&}]{page\+List}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_adfba2185adbbd950b89344f576afac23}
Export the currently open document as Post\+Script file. \begin{DoxyReturn}{Returns}
whether the exporting was successful 
\end{DoxyReturn}


Definition at line 1043 of file kdjvu.\+cpp.


\begin{DoxyCode}
1044 \{
1045     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} || !file || pageList.isEmpty() )
1046         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1047 
1048     FILE* f = fdopen( file->handle(), \textcolor{stringliteral}{"w+"} );
1049     \textcolor{keywordflow}{if} ( !f )
1050     \{
1051         kDebug() << \textcolor{stringliteral}{"error while getting the FILE*"};
1052         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1053     \}
1054 
1055     QString pl;
1056     \textcolor{keywordflow}{foreach} ( \textcolor{keywordtype}{int} p, pageList )
1057     \{
1058         \textcolor{keywordflow}{if} ( !pl.isEmpty() )
1059             pl += QString::fromLatin1( \textcolor{stringliteral}{","} );
1060         pl += QString::number( p );
1061     \}
1062     pl.prepend( \textcolor{stringliteral}{"-page="} );
1063 
1064     \textcolor{comment}{// setting the options}
1065     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} optc = 1;
1066     \textcolor{keyword}{const} \textcolor{keywordtype}{char} ** optv = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}**)malloc( 1 * \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char}* ) );
1067     QByteArray plb = pl.toAscii();
1068     optv[0] = plb.constData();
1069 
1070     ddjvu\_job\_t *printjob = ddjvu\_document\_print( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document}, f, optc, optv );
1071     \textcolor{keywordflow}{while} ( !ddjvu\_job\_done( printjob ) )
1072        handle\_ddjvu\_messages( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, \textcolor{keyword}{true} );
1073 
1074     free( optv );
1075 
1076     \textcolor{keywordflow}{return} fclose( f ) == 0;
1077 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a912d8a8a28dfd28bf871c0c1726b266e}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!image@{image}}
\index{image@{image}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{image}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Image K\+Dj\+Vu\+::image (
\begin{DoxyParamCaption}
\item[{int}]{page, }
\item[{int}]{width, }
\item[{int}]{height, }
\item[{int}]{rotation}
\end{DoxyParamCaption}
)}}\label{classKDjVu_a912d8a8a28dfd28bf871c0c1726b266e}
Check if the image for the specified {\ttfamily page} with the specified {\ttfamily width}, {\ttfamily height} and {\ttfamily rotation} is already in cache, and returns it. If not, a null image is returned. 

Definition at line 908 of file kdjvu.\+cpp.


\begin{DoxyCode}
909 \{
910     \textcolor{keywordflow}{if} ( d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled} )
911     \{
912     \textcolor{keywordtype}{bool} found = \textcolor{keyword}{false};
913     \hyperlink{classQList}{QList<ImageCacheItem*>::Iterator} it = d->
      \hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.begin(), itEnd = d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.end();
914     \textcolor{keywordflow}{for} ( ; ( it != itEnd ) && !found; ++it )
915     \{
916         \hyperlink{classImageCacheItem}{ImageCacheItem}* cur = *it;
917         \textcolor{keywordflow}{if} ( ( cur->\hyperlink{classImageCacheItem_aa3d72c87b3f029cc5b284f68a48252c6}{page} == page ) &&
918              ( rotation % 2 == 0
919                ? cur->\hyperlink{classImageCacheItem_a1481bdd684cf00f3f895302ad8b65720}{width} == width && cur->\hyperlink{classImageCacheItem_a5b8016e759dfeab649311a6af44f6c34}{height} == height
920                : cur->\hyperlink{classImageCacheItem_a1481bdd684cf00f3f895302ad8b65720}{width} == height && cur->\hyperlink{classImageCacheItem_a5b8016e759dfeab649311a6af44f6c34}{height} == width ) )
921             found = \textcolor{keyword}{true};
922     \}
923     \textcolor{keywordflow}{if} ( found )
924     \{
925         \textcolor{comment}{// taking the element and pushing to the top of the list}
926         --it;
927         \hyperlink{classImageCacheItem}{ImageCacheItem}* cur2 = *it;
928         d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.erase( it );
929         d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.push\_front( cur2 );
930 
931         \textcolor{keywordflow}{return} cur2->\hyperlink{classImageCacheItem_a4c12636231b58e37862371b73eceef9a}{img};
932     \}
933     \}
934 
935     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.at( page ) )
936     \{
937         ddjvu\_page\_t *newpage = ddjvu\_page\_create\_by\_pageno( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document}, page );
938         \textcolor{comment}{// wait for the new page to be loaded}
939         ddjvu\_status\_t sts;
940         \textcolor{keywordflow}{while} ( ( sts = ddjvu\_page\_decoding\_status( newpage ) ) < DDJVU\_JOB\_OK )
941             handle\_ddjvu\_messages( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, \textcolor{keyword}{true} );
942         d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}[page] = newpage;
943     \}
944     ddjvu\_page\_t *djvupage = d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}[page];
945 
946 \textcolor{comment}{/*}
947 \textcolor{comment}{    if ( ddjvu\_page\_get\_rotation( djvupage ) != flipRotation( rotation ) )}
948 \textcolor{comment}{    \{}
949 \textcolor{comment}{// TODO: test documents with initial rotation != 0}
950 \textcolor{comment}{//        ddjvu\_page\_set\_rotation( djvupage, m\_pages.at( page )->orientation() );}
951 \textcolor{comment}{        ddjvu\_page\_set\_rotation( djvupage, (ddjvu\_page\_rotation\_t)flipRotation( rotation ) );}
952 \textcolor{comment}{    \}}
953 \textcolor{comment}{*/}
954 
955     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} xdelta = 1500;
956     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} ydelta = 1500;
957 
958     \textcolor{keywordtype}{int} xparts = width / xdelta + 1;
959     \textcolor{keywordtype}{int} yparts = height / ydelta + 1;
960 
961     QImage newimg;
962 
963     \textcolor{keywordtype}{int} res = 10000;
964     \textcolor{keywordflow}{if} ( ( xparts == 1 ) && ( yparts == 1 ) )
965     \{
966          \textcolor{comment}{// only one part -- render at once with no need to auxiliary image}
967          newimg = d->\hyperlink{classKDjVu_1_1Private_aeb06ba931fdafc7b463603fb7481d477}{generateImageTile}( djvupage, res,
968                  width, 0, xdelta, height, 0, ydelta );
969     \}
970     \textcolor{keywordflow}{else}
971     \{
972         \textcolor{comment}{// more than one part -- need to render piece-by-piece and to compose}
973         \textcolor{comment}{// the results}
974         newimg = QImage( width, height, QImage::Format\_RGB32 );
975         QPainter p;
976         p.begin( &newimg );
977         \textcolor{keywordtype}{int} parts = xparts * yparts;
978         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < parts; ++i )
979         \{
980             \textcolor{keywordtype}{int} row = i % xparts;
981             \textcolor{keywordtype}{int} col = i / xparts;
982             \textcolor{keywordtype}{int} tmpres = 0;
983             QImage tempp = d->\hyperlink{classKDjVu_1_1Private_aeb06ba931fdafc7b463603fb7481d477}{generateImageTile}( djvupage, tmpres,
984                     width, row, xdelta, height, col, ydelta );
985             \textcolor{keywordflow}{if} ( tmpres )
986             \{
987                 p.drawImage( row * xdelta, col * ydelta, tempp );
988             \}
989             res = qMin( tmpres, res );
990         \}
991         p.end();
992     \}
993 
994     \textcolor{keywordflow}{if} ( res && d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled} )
995     \{
996         \textcolor{comment}{// delete all the cached pixmaps for the current page with a size that}
997         \textcolor{comment}{// differs no more than 35% of the new pixmap size}
998         \textcolor{keywordtype}{int} imgsize = newimg.width() * newimg.height();
999         \textcolor{keywordflow}{if} ( imgsize > 0 )
1000         \{
1001             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i = 0; i < d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.count(); )
1002             \{
1003                 \hyperlink{classImageCacheItem}{ImageCacheItem}* cur = d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.at(i);
1004                 \textcolor{keywordflow}{if} ( ( cur->\hyperlink{classImageCacheItem_aa3d72c87b3f029cc5b284f68a48252c6}{page} == page ) &&
1005                      ( abs( cur->\hyperlink{classImageCacheItem_a4c12636231b58e37862371b73eceef9a}{img}.width() * cur->\hyperlink{classImageCacheItem_a4c12636231b58e37862371b73eceef9a}{img}.height() - imgsize ) < imgsize * 0.35 ) )
1006                 \{
1007                     d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.removeAt( i );
1008                     \textcolor{keyword}{delete} cur;
1009                 \}
1010                 \textcolor{keywordflow}{else}
1011                     ++i;
1012             \}
1013         \}
1014 
1015         \textcolor{comment}{// the image cache has too many elements, remove the last}
1016         \textcolor{keywordflow}{if} ( d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.size() >= 10 )
1017         \{
1018             \textcolor{keyword}{delete} d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.last();
1019             d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.removeLast();
1020         \}
1021         \hyperlink{classImageCacheItem}{ImageCacheItem}* ich = \textcolor{keyword}{new} \hyperlink{classImageCacheItem}{ImageCacheItem}( page, width, height, newimg )
      ;
1022         d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.push\_front( ich );
1023     \}
1024 
1025     \textcolor{keywordflow}{return} newimg;
1026 \}
\end{DoxyCode}
\hypertarget{classKDjVu_ada3da14d01ead551278e089ed49ce4e2}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!is\+Cache\+Enabled@{is\+Cache\+Enabled}}
\index{is\+Cache\+Enabled@{is\+Cache\+Enabled}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{is\+Cache\+Enabled}]{\setlength{\rightskip}{0pt plus 5cm}bool K\+Dj\+Vu\+::is\+Cache\+Enabled (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_ada3da14d01ead551278e089ed49ce4e2}
\begin{DoxyReturn}{Returns}
whether the internal rendered pages cache is enabled 
\end{DoxyReturn}


Definition at line 1147 of file kdjvu.\+cpp.


\begin{DoxyCode}
1148 \{
1149     \textcolor{keywordflow}{return} d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled};
1150 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a2f2185ed09a1fe26c597f9582f4c34f2}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!links\+And\+Annotations\+For\+Page@{links\+And\+Annotations\+For\+Page}}
\index{links\+And\+Annotations\+For\+Page@{links\+And\+Annotations\+For\+Page}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{links\+And\+Annotations\+For\+Page}]{\setlength{\rightskip}{0pt plus 5cm}void K\+Dj\+Vu\+::links\+And\+Annotations\+For\+Page (
\begin{DoxyParamCaption}
\item[{int}]{page\+Num, }
\item[{{\bf Q\+List}$<$ {\bf K\+Dj\+Vu\+::\+Link} $\ast$ $>$ $\ast$}]{links, }
\item[{{\bf Q\+List}$<$ {\bf K\+Dj\+Vu\+::\+Annotation} $\ast$ $>$ $\ast$}]{annotations}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_a2f2185ed09a1fe26c597f9582f4c34f2}
Reads the links and the annotations for the page {\ttfamily page\+Num} 

For both {\ttfamily links} and {\ttfamily annotations} , you can pass either a valid pointer (in case you want to extract that kind of information), or a null pointer (if you don't want that information). 

Definition at line 787 of file kdjvu.\+cpp.


\begin{DoxyCode}
788 \{
789     \textcolor{keywordflow}{if} ( ( pageNum < 0 ) || ( pageNum >= d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.count() ) || ( !links && !annotations ) )
790         \textcolor{keywordflow}{return};
791 
792     \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} annots;
793     \textcolor{keywordflow}{while} ( ( annots = ddjvu\_document\_get\_pageanno( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document}, pageNum ) ) == 
      miniexp\_dummy )
794         handle\_ddjvu\_messages( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, \textcolor{keyword}{true} );
795 
796     \textcolor{keywordflow}{if} ( !miniexp\_listp( annots ) )
797         \textcolor{keywordflow}{return};
798 
799     \textcolor{keywordflow}{if} ( links )
800         links->clear();
801     \textcolor{keywordflow}{if} ( annotations )
802         annotations->clear();
803 
804     \textcolor{keywordtype}{int} l = miniexp\_length( annots );
805     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < l; ++i )
806     \{
807         \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} cur = miniexp\_nth( i, annots );
808         \textcolor{keywordtype}{int} \hyperlink{dvi_2util_8cpp_acc54804c2bc92eef873c373c37b69ff7}{num} = miniexp\_length( cur );
809         \textcolor{keywordflow}{if} ( ( num < 4 ) || !miniexp\_symbolp( miniexp\_nth( 0, cur ) ) ||
810              ( qstrncmp( miniexp\_to\_name( miniexp\_nth( 0, cur ) ), \textcolor{stringliteral}{"maparea"}, 7 ) != 0 ) )
811             \textcolor{keywordflow}{continue};
812 
813         QString target;
814         QString type;
815         \textcolor{keywordflow}{if} ( miniexp\_symbolp( miniexp\_nth( 0, miniexp\_nth( 3, cur ) ) ) )
816             type = QString::fromUtf8( miniexp\_to\_name( miniexp\_nth( 0, miniexp\_nth( 3, cur ) ) ) );
817         \hyperlink{classKDjVu_1_1Link}{KDjVu::Link}* link = 0;
818         \hyperlink{classKDjVu_1_1Annotation}{KDjVu::Annotation}* ann = 0;
819         \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} urlexp = miniexp\_nth( 1, cur );
820         \textcolor{keywordflow}{if} ( links &&
821              ( type == QLatin1String( \textcolor{stringliteral}{"rect"} ) ||
822                type == QLatin1String( \textcolor{stringliteral}{"oval"} ) ||
823                type == QLatin1String( \textcolor{stringliteral}{"poly"} ) ) )
824         \{
825             \textcolor{keywordflow}{if} ( miniexp\_stringp( urlexp ) )
826             \{
827                 target = QString::fromUtf8( miniexp\_to\_str( miniexp\_nth( 1, cur ) ) );
828             \}
829             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( miniexp\_listp( urlexp ) && ( miniexp\_length( urlexp ) == 3 ) &&
830                       miniexp\_symbolp( miniexp\_nth( 0, urlexp ) ) &&
831                       ( qstrncmp( miniexp\_to\_name( miniexp\_nth( 0, urlexp ) ), \textcolor{stringliteral}{"url"}, 3 ) == 0 ) )
832             \{
833                 target = QString::fromUtf8( miniexp\_to\_str( miniexp\_nth( 1, urlexp ) ) );
834             \}
835             \textcolor{keywordflow}{if} ( target.isEmpty() || ( ( target.length() > 0 ) && target.at(0) == QLatin1Char( \textcolor{charliteral}{'#'} ) ) )
836             \{
837                 \hyperlink{classKDjVu_1_1PageLink}{KDjVu::PageLink}* plink = \textcolor{keyword}{new} \hyperlink{classKDjVu_1_1PageLink}{KDjVu::PageLink}();
838                 plink->m\_page = target;
839                 link = plink;
840             \}
841             \textcolor{keywordflow}{else}
842             \{
843                 \hyperlink{classKDjVu_1_1UrlLink}{KDjVu::UrlLink}* ulink = \textcolor{keyword}{new} \hyperlink{classKDjVu_1_1UrlLink}{KDjVu::UrlLink}();
844                 ulink->m\_url = target;
845                 link = ulink;
846             \}
847         \}
848         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( annotations &&
849                   ( type == QLatin1String( \textcolor{stringliteral}{"text"} ) ||
850                     type == QLatin1String( \textcolor{stringliteral}{"line"} ) ) )
851         \{
852             \textcolor{keywordflow}{if} ( type == QLatin1String( \textcolor{stringliteral}{"text"} ) )
853             \{
854                 \hyperlink{classKDjVu_1_1TextAnnotation}{KDjVu::TextAnnotation} * textann = \textcolor{keyword}{new} 
      \hyperlink{classKDjVu_1_1TextAnnotation}{KDjVu::TextAnnotation}( cur );
855                 ann = textann;
856             \}
857             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( type == QLatin1String( \textcolor{stringliteral}{"line"} ) )
858             \{
859                 \hyperlink{classKDjVu_1_1LineAnnotation}{KDjVu::LineAnnotation} * lineann = \textcolor{keyword}{new} 
      \hyperlink{classKDjVu_1_1LineAnnotation}{KDjVu::LineAnnotation}( cur );
860                 ann = lineann;
861             \}
862         \}
863         \textcolor{keywordflow}{if} ( link \textcolor{comment}{/* safety check */} && links )
864         \{
865             link->m\_area = \hyperlink{classKDjVu_1_1Link_ae7930012fef50123e69d2c97897afd9aa6c0cf99a52f0b175a8feaaaa76edceeb}{KDjVu::Link::UnknownArea};
866             \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} area = miniexp\_nth( 3, cur );
867             \textcolor{keywordtype}{int} arealength = miniexp\_length( area );
868             \textcolor{keywordflow}{if} ( ( arealength == 5 ) && ( type == QLatin1String( \textcolor{stringliteral}{"rect"} ) || type == QLatin1String( \textcolor{stringliteral}{"oval"} 
      ) ) )
869             \{
870                 link->m\_point = QPoint( miniexp\_to\_int( miniexp\_nth( 1, area ) ), miniexp\_to\_int( 
      miniexp\_nth( 2, area ) ) );
871                 link->m\_size = QSize( miniexp\_to\_int( miniexp\_nth( 3, area ) ), miniexp\_to\_int( miniexp\_nth
      ( 4, area ) ) );
872                 \textcolor{keywordflow}{if} ( type == QLatin1String( \textcolor{stringliteral}{"rect"} ) )
873                 \{
874                     link->m\_area = \hyperlink{classKDjVu_1_1Link_ae7930012fef50123e69d2c97897afd9aa6897a602cd1401eb6d0ccc4bd5127ed1}{KDjVu::Link::RectArea};
875                 \}
876                 \textcolor{keywordflow}{else}
877                 \{
878                     link->m\_area = \hyperlink{classKDjVu_1_1Link_ae7930012fef50123e69d2c97897afd9aa47d6a7b999bac1147973a3b3d272516c}{KDjVu::Link::EllipseArea};
879                 \}
880             \}
881             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( arealength > 0 ) && ( arealength % 2 == 1 ) &&
882                       type == QLatin1String( \textcolor{stringliteral}{"poly"} ) )
883             \{
884                 link->m\_area = \hyperlink{classKDjVu_1_1Link_ae7930012fef50123e69d2c97897afd9aa354fba105f6cef2461151c1b9e23024e}{KDjVu::Link::PolygonArea};
885                 QPolygon poly;
886                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 1; j < arealength; j += 2 ) 
887                 \{
888                     poly << QPoint( miniexp\_to\_int( miniexp\_nth( j, area ) ), miniexp\_to\_int( miniexp\_nth( 
      j + 1, area ) ) );
889                 \}
890                 link->m\_poly = poly;
891             \}
892 
893             \textcolor{keywordflow}{if} ( link->m\_area != \hyperlink{classKDjVu_1_1Link_ae7930012fef50123e69d2c97897afd9aa6c0cf99a52f0b175a8feaaaa76edceeb}{KDjVu::Link::UnknownArea} )
894                 links->append( link );
895         \}
896         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ann \textcolor{comment}{/* safety check */} && annotations )
897         \{
898             annotations->append( ann );
899         \}
900     \}
901 \}
\end{DoxyCode}
\hypertarget{classKDjVu_ae1a73203fc07dc0c81996810ca2f7ae3}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!meta\+Data@{meta\+Data}}
\index{meta\+Data@{meta\+Data}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{meta\+Data}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Variant K\+Dj\+Vu\+::meta\+Data (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{key}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_ae1a73203fc07dc0c81996810ca2f7ae3}
Get the metadata for the specified {\ttfamily key}, or a null variant otherwise. 

Definition at line 774 of file kdjvu.\+cpp.


\begin{DoxyCode}
775 \{
776     QHash<QString, QVariant>::ConstIterator it = d->\hyperlink{classKDjVu_1_1Private_a48e70e9e1d6e964cacaf5bc8295dcba7}{m\_metaData}.constFind( key );
777     \textcolor{keywordflow}{return} it != d->\hyperlink{classKDjVu_1_1Private_a48e70e9e1d6e964cacaf5bc8295dcba7}{m\_metaData}.constEnd() ? it.value() : QVariant();
778 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a223ea1608a7b3ed9314bd89a2534dfd5}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!open\+File@{open\+File}}
\index{open\+File@{open\+File}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{open\+File}]{\setlength{\rightskip}{0pt plus 5cm}bool K\+Dj\+Vu\+::open\+File (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{file\+Name}
\end{DoxyParamCaption}
)}}\label{classKDjVu_a223ea1608a7b3ed9314bd89a2534dfd5}
Opens the file {\ttfamily file\+Name}, closing the old one if necessary. 

Definition at line 663 of file kdjvu.\+cpp.


\begin{DoxyCode}
664 \{
665     \textcolor{comment}{// first, close the old file}
666     \textcolor{keywordflow}{if} ( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} )
667         \hyperlink{classKDjVu_af9c1d642f5ef455739abadf09ed44586}{closeFile}();
668 
669     \textcolor{comment}{// load the document...}
670     d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} = ddjvu\_document\_create\_by\_filename( d->
      \hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, QFile::encodeName( fileName ), \textcolor{keyword}{true} );
671     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} ) \textcolor{keywordflow}{return} \textcolor{keyword}{false};
672     \textcolor{comment}{// ...and wait for its loading}
673     wait\_for\_ddjvu\_message( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, DDJVU\_DOCINFO );
674     \textcolor{keywordflow}{if} ( ddjvu\_document\_decoding\_error( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} ) )
675     \{
676         ddjvu\_document\_release( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} );
677         d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} = 0;
678         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
679     \}
680 
681     kDebug() << \textcolor{stringliteral}{"# of pages:"} << ddjvu\_document\_get\_pagenum( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} );
682     \textcolor{keywordtype}{int} numofpages = ddjvu\_document\_get\_pagenum( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} );
683     d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.clear();
684     d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.resize( numofpages );
685     d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.clear();
686     d->\hyperlink{classKDjVu_1_1Private_a7c2361a6591fe13e69bc7982a3efd780}{m\_pages\_cache}.resize( numofpages );
687 
688     \textcolor{comment}{// get the document type}
689     QString doctype;
690     \textcolor{keywordflow}{switch} ( ddjvu\_document\_get\_type( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} ) )
691     \{
692         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_UNKNOWN:
693             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Unknown"} );
694             \textcolor{keywordflow}{break};
695         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_SINGLEPAGE:
696             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Single Page"} );
697             \textcolor{keywordflow}{break};
698         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_BUNDLED:
699             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Bundled"} );
700             \textcolor{keywordflow}{break};
701         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_INDIRECT:
702             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Indirect"} );
703             \textcolor{keywordflow}{break};
704         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_OLD\_BUNDLED:
705             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Bundled (old)"} );
706             \textcolor{keywordflow}{break};
707         \textcolor{keywordflow}{case} DDJVU\_DOCTYPE\_OLD\_INDEXED:
708             doctype = i18nc( \textcolor{stringliteral}{"Type of DjVu document"}, \textcolor{stringliteral}{"Indexed (old)"} );
709             \textcolor{keywordflow}{break};
710     \}
711     \textcolor{keywordflow}{if} ( !doctype.isEmpty() )
712         d->\hyperlink{classKDjVu_1_1Private_a48e70e9e1d6e964cacaf5bc8295dcba7}{m\_metaData}[ \textcolor{stringliteral}{"documentType"} ] = doctype;
713     \textcolor{comment}{// get the number of components}
714     d->\hyperlink{classKDjVu_1_1Private_a48e70e9e1d6e964cacaf5bc8295dcba7}{m\_metaData}[ \textcolor{stringliteral}{"componentFile"} ] = ddjvu\_document\_get\_filenum( d->
      \hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} );
715 
716     \textcolor{comment}{// read the pages}
717     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < numofpages; ++i )
718     \{
719         ddjvu\_status\_t sts;
720         ddjvu\_pageinfo\_t info;
721         \textcolor{keywordflow}{while} ( ( sts = ddjvu\_document\_get\_pageinfo( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document}, i, &info ) ) < 
      DDJVU\_JOB\_OK )
722             handle\_ddjvu\_messages( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, \textcolor{keyword}{true} );
723         \textcolor{keywordflow}{if} ( sts >= DDJVU\_JOB\_FAILED )
724         \{
725             kDebug().nospace() << \textcolor{stringliteral}{"\(\backslash\)t>>> page "} << i << \textcolor{stringliteral}{" failed: "} << sts;
726             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
727         \}
728 
729         \hyperlink{classKDjVu_1_1Page}{KDjVu::Page} *p = \textcolor{keyword}{new} \hyperlink{classKDjVu_1_1Page}{KDjVu::Page}();
730         p->m\_width = info.width;
731         p->m\_height = info.height;
732         p->m\_dpi = info.dpi;
733 \textcolor{preprocessor}{#if DDJVUAPI\_VERSION >= 18}
734         p->m\_orientation = flipRotation( info.rotation );
735 \textcolor{preprocessor}{#else}
736         p->m\_orientation = 0;
737 \textcolor{preprocessor}{#endif}
738         d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}[i] = p;
739     \}
740 
741     \textcolor{comment}{// reading the metadata from the first page only should be enough}
742     \textcolor{keywordflow}{if} ( numofpages > 0 )
743         d->\hyperlink{classKDjVu_1_1Private_a7b150f97629079f814eeb91368cc3dcc}{readMetaData}( 0 );
744 
745     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
746 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a5b74281ec02d098b0bac883552fbb2e7}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!page\+Number@{page\+Number}}
\index{page\+Number@{page\+Number}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{page\+Number}]{\setlength{\rightskip}{0pt plus 5cm}int K\+Dj\+Vu\+::page\+Number (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{name}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_a5b74281ec02d098b0bac883552fbb2e7}
Return the page number of the page whose title is {\ttfamily name}. 

Definition at line 1152 of file kdjvu.\+cpp.


\begin{DoxyCode}
1153 \{
1154     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document} )
1155         \textcolor{keywordflow}{return} -1;
1156 
1157     \textcolor{keywordflow}{return} d->\hyperlink{classKDjVu_1_1Private_aaba1afe5cef39023edfae2f4333d2c10}{pageWithName}( name );
1158 \}
\end{DoxyCode}
\hypertarget{classKDjVu_aea351abdd42f5494382d2d3d20c1a94e}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!pages@{pages}}
\index{pages@{pages}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{pages}]{\setlength{\rightskip}{0pt plus 5cm}const Q\+Vector$<$ {\bf K\+Dj\+Vu\+::\+Page} $\ast$ $>$ \& K\+Dj\+Vu\+::pages (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_aea351abdd42f5494382d2d3d20c1a94e}
The pages of the current document, or an empty vector otherwise. \begin{DoxyNote}{Note}
\hyperlink{classKDjVu}{K\+Dj\+Vu} handles the pages, so you don't need to delete them manually 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
a vector with the pages of the current document 
\end{DoxyReturn}


Definition at line 903 of file kdjvu.\+cpp.


\begin{DoxyCode}
904 \{
905     \textcolor{keywordflow}{return} d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages};
906 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a175f29677ef28f549a709b337f917d92}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!set\+Cache\+Enabled@{set\+Cache\+Enabled}}
\index{set\+Cache\+Enabled@{set\+Cache\+Enabled}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{set\+Cache\+Enabled}]{\setlength{\rightskip}{0pt plus 5cm}void K\+Dj\+Vu\+::set\+Cache\+Enabled (
\begin{DoxyParamCaption}
\item[{bool}]{enable}
\end{DoxyParamCaption}
)}}\label{classKDjVu_a175f29677ef28f549a709b337f917d92}
Enable or disable the internal rendered pages cache. 

Definition at line 1134 of file kdjvu.\+cpp.


\begin{DoxyCode}
1135 \{
1136     \textcolor{keywordflow}{if} ( enable == d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled} )
1137         \textcolor{keywordflow}{return};
1138 
1139     d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled} = enable;
1140     \textcolor{keywordflow}{if} ( !d->\hyperlink{classKDjVu_1_1Private_a61eaa61e0d4e31a7e411a481df9827ee}{m\_cacheEnabled} )
1141     \{
1142         qDeleteAll( d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache} );
1143         d->\hyperlink{classKDjVu_1_1Private_a447ca81b4cc0237ac52aa8bfadd1258e}{mImgCache}.clear();
1144     \}
1145 \}
\end{DoxyCode}
\hypertarget{classKDjVu_a658d09462a1b727a001c6f7f183a3f7e}{\index{K\+Dj\+Vu@{K\+Dj\+Vu}!text\+Entities@{text\+Entities}}
\index{text\+Entities@{text\+Entities}!K\+Dj\+Vu@{K\+Dj\+Vu}}
\subsubsection[{text\+Entities}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Q\+List}$<$ {\bf K\+Dj\+Vu\+::\+Text\+Entity} $>$ K\+Dj\+Vu\+::text\+Entities (
\begin{DoxyParamCaption}
\item[{int}]{page, }
\item[{const Q\+String \&}]{granularity}
\end{DoxyParamCaption}
) const}}\label{classKDjVu_a658d09462a1b727a001c6f7f183a3f7e}
Return the list of the text entities for the specified {\ttfamily page}, that matches the specified {\ttfamily granularity}. 

Definition at line 1079 of file kdjvu.\+cpp.


\begin{DoxyCode}
1080 \{
1081     \textcolor{keywordflow}{if} ( ( page < 0 ) || ( page >= d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.count() ) )
1082         \textcolor{keywordflow}{return} \hyperlink{classQList}{QList<KDjVu::TextEntity>}();
1083 
1084     \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} r;
1085     \textcolor{keywordflow}{while} ( ( r = ddjvu\_document\_get\_pagetext( d->\hyperlink{classKDjVu_1_1Private_a183f9508738c71bb5abab150619a5ccd}{m\_djvu\_document}, page, 0 ) ) == 
      miniexp\_dummy )
1086         handle\_ddjvu\_messages( d->\hyperlink{classKDjVu_1_1Private_a5a52150a7ab9bbd584d6d73d68ae9ba1}{m\_djvu\_cxt}, \textcolor{keyword}{true} );
1087 
1088     \textcolor{keywordflow}{if} ( r == miniexp\_nil )
1089         \textcolor{keywordflow}{return} \hyperlink{classQList}{QList<KDjVu::TextEntity>}();
1090 
1091     \hyperlink{classQList}{QList<KDjVu::TextEntity>} ret;
1092 
1093     \textcolor{keywordtype}{int} height = d->\hyperlink{classKDjVu_1_1Private_a0c009b87dde95717ec9e9a8f701e6628}{m\_pages}.at( page )->height();
1094 
1095     QQueue<miniexp\_t> queue;
1096     queue.enqueue( r );
1097 
1098     \textcolor{keywordflow}{while} ( !queue.isEmpty() )
1099     \{
1100         \hyperlink{kdjvu_8h_a58955b1a7edfc6e6ccb48402f744802b}{miniexp\_t} cur = queue.dequeue();
1101 
1102         \textcolor{keywordflow}{if} ( miniexp\_listp( cur )
1103              && ( miniexp\_length( cur ) > 0 )
1104              && miniexp\_symbolp( miniexp\_nth( 0, cur ) ) )
1105         \{
1106             \textcolor{keywordtype}{int} \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} = miniexp\_length( cur );
1107             QString sym = QString::fromUtf8( miniexp\_to\_name( miniexp\_nth( 0, cur ) ) );
1108             \textcolor{keywordflow}{if} ( sym == granularity )
1109             \{
1110                 \textcolor{keywordflow}{if} ( size >= 6 )
1111                 \{
1112                     \textcolor{keywordtype}{int} xmin = miniexp\_to\_int( miniexp\_nth( 1, cur ) );
1113                     \textcolor{keywordtype}{int} ymin = miniexp\_to\_int( miniexp\_nth( 2, cur ) );
1114                     \textcolor{keywordtype}{int} xmax = miniexp\_to\_int( miniexp\_nth( 3, cur ) );
1115                     \textcolor{keywordtype}{int} ymax = miniexp\_to\_int( miniexp\_nth( 4, cur ) );
1116                     QRect rect( xmin, height - ymax, xmax - xmin, ymax - ymin );
1117                     \hyperlink{classKDjVu_1_1TextEntity}{KDjVu::TextEntity} entity;
1118                     entity.m\_rect = rect;
1119                     entity.m\_text = QString::fromUtf8( miniexp\_to\_str( miniexp\_nth( 5, cur ) ) );
1120                     ret.append( entity );
1121                 \}
1122             \}
1123             \textcolor{keywordflow}{else}
1124             \{
1125                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 5; i < \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size}; ++i )
1126                     queue.enqueue( miniexp\_nth( i, cur ) );
1127             \}
1128         \}
1129     \}
1130 
1131     \textcolor{keywordflow}{return} ret;
1132 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
generators/djvu/\hyperlink{kdjvu_8h}{kdjvu.\+h}\item 
generators/djvu/\hyperlink{kdjvu_8cpp}{kdjvu.\+cpp}\end{DoxyCompactItemize}
