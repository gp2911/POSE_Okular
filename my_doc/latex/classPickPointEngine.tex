\hypertarget{classPickPointEngine}{\section{Pick\+Point\+Engine Class Reference}
\label{classPickPointEngine}\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}}
}


\hyperlink{classPickPointEngine}{Pick\+Point\+Engine}.  


Inheritance diagram for Pick\+Point\+Engine\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classPickPointEngine}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPickPointEngine_a645c9139ab72aaf37bf974a2a50f0276}{Pick\+Point\+Engine} (const Q\+Dom\+Element \&engine\+Element)
\item 
\hyperlink{classPickPointEngine_a1b09b40f537cd9653259bd37630f0198}{$\sim$\+Pick\+Point\+Engine} ()
\item 
Q\+Rect \hyperlink{classPickPointEngine_a7dd04c96b28fbf6dba26c5f277827ece}{event} (\hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133}{Event\+Type} type, \hyperlink{classAnnotatorEngine_ac2e3b75e12bacbb6974d15dd53954567}{Button} button, double n\+X, double n\+Y, double x\+Scale, double y\+Scale, const \hyperlink{classOkular_1_1Page}{Okular\+::\+Page} $\ast$page)
\item 
void \hyperlink{classPickPointEngine_a1af9d4c401554caa10918985dbd7aae2}{paint} (Q\+Painter $\ast$painter, double x\+Scale, double y\+Scale, const Q\+Rect \&)
\item 
\hyperlink{classQList}{Q\+List}$<$ \hyperlink{classOkular_1_1Annotation}{Okular\+::\+Annotation} $\ast$ $>$ \hyperlink{classPickPointEngine_a4a3cc45d8861f30637b2aa5ee85cc6c3}{end} ()
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\hyperlink{classPickPointEngine}{Pick\+Point\+Engine}. 

Definition at line 43 of file pageviewannotator.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classPickPointEngine_a645c9139ab72aaf37bf974a2a50f0276}{\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\subsubsection[{Pick\+Point\+Engine}]{\setlength{\rightskip}{0pt plus 5cm}Pick\+Point\+Engine\+::\+Pick\+Point\+Engine (
\begin{DoxyParamCaption}
\item[{const Q\+Dom\+Element \&}]{engine\+Element}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classPickPointEngine_a645c9139ab72aaf37bf974a2a50f0276}


Definition at line 46 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
47             : \hyperlink{classAnnotatorEngine_a42302fe858494d3e3ad90b8607c543ef}{AnnotatorEngine}( engineElement ), clicked( \textcolor{keyword}{false} ), pixmap( 0 ),
48               xscale( 1.0 ), yscale( 1.0 )
49         \{
50             \textcolor{comment}{// parse engine specific attributes}
51             hoverIconName = engineElement.attribute( \textcolor{stringliteral}{"hoverIcon"} );
52             iconName = \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"icon"} );
53             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"type"} ) == \textcolor{stringliteral}{"Stamp"} && !iconName.simplified().
      isEmpty() )
54                 hoverIconName = iconName;
55             center = QVariant( engineElement.attribute( \textcolor{stringliteral}{"center"} ) ).toBool();
56             \textcolor{keywordtype}{bool} ok = \textcolor{keyword}{true};
57             \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} = engineElement.attribute( \textcolor{stringliteral}{"size"}, \textcolor{stringliteral}{"32"} ).toInt( &ok );
58             \textcolor{keywordflow}{if} ( !ok )
59                 \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} = 32;
60             m\_block = QVariant( engineElement.attribute( \textcolor{stringliteral}{"block"} ) ).toBool();
61 
62             \textcolor{comment}{// create engine objects}
63             \textcolor{keywordflow}{if} ( !hoverIconName.simplified().isEmpty() )
64                 pixmap = \textcolor{keyword}{new} QPixmap( \hyperlink{namespaceGuiUtils_a5ba797636890ba5fbc39db6a092f4bd5}{GuiUtils::loadStamp}( hoverIconName, QSize( 
      \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size}, \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} ) ) );
65         \}
\end{DoxyCode}
\hypertarget{classPickPointEngine_a1b09b40f537cd9653259bd37630f0198}{\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!````~Pick\+Point\+Engine@{$\sim$\+Pick\+Point\+Engine}}
\index{````~Pick\+Point\+Engine@{$\sim$\+Pick\+Point\+Engine}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\subsubsection[{$\sim$\+Pick\+Point\+Engine}]{\setlength{\rightskip}{0pt plus 5cm}Pick\+Point\+Engine\+::$\sim$\+Pick\+Point\+Engine (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classPickPointEngine_a1b09b40f537cd9653259bd37630f0198}


Definition at line 67 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
68         \{
69             \textcolor{keyword}{delete} pixmap;
70         \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classPickPointEngine_a4a3cc45d8861f30637b2aa5ee85cc6c3}{\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!end@{end}}
\index{end@{end}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\subsubsection[{end}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Q\+List}$<$ {\bf Okular\+::\+Annotation}$\ast$ $>$ Pick\+Point\+Engine\+::end (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPickPointEngine_a4a3cc45d8861f30637b2aa5ee85cc6c3}


Implements \hyperlink{classAnnotatorEngine_a50455740303878b891195132df27a2ab}{Annotator\+Engine}.



Definition at line 145 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
146         \{
147             \textcolor{comment}{// find out annotation's description node}
148             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.isNull() )
149             \{
150                 \hyperlink{classAnnotatorEngine_a0df119b4d87a1e3ea8ed60a96d7ff444}{m\_creationCompleted} = \textcolor{keyword}{false};
151                 clicked = \textcolor{keyword}{false};
152                 \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}();
153             \}
154 
155             \textcolor{comment}{// find out annotation's type}
156             \hyperlink{classOkular_1_1Annotation}{Okular::Annotation} * ann = 0;
157             \textcolor{keyword}{const} QString typeString = \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"type"} );
158             \textcolor{comment}{// create TextAnnotation from path}
159             \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"FreeText"})  \textcolor{comment}{//<annotation type="Text"}
160             \{
161                 \textcolor{comment}{//note dialog}
162                 \textcolor{keyword}{const} QString prompt = i18n( \textcolor{stringliteral}{"Text of the new note:"} );
163                 \textcolor{keywordtype}{bool} resok;
164                 \textcolor{keyword}{const} QString note = KInputDialog::getMultiLineText( i18n( \textcolor{stringliteral}{"New Text Note"} ), prompt, 
      QString(), &resok );
165                 \textcolor{keywordflow}{if}(resok)
166                 \{
167                     \textcolor{comment}{//add note}
168                     \hyperlink{classOkular_1_1TextAnnotation}{Okular::TextAnnotation} * ta = \textcolor{keyword}{new} 
      \hyperlink{classOkular_1_1TextAnnotation}{Okular::TextAnnotation}();
169                     ann = ta;
170                     ta->\hyperlink{classOkular_1_1Annotation_ab91b36dc7ecfd9cacba7761ec58145fd}{setFlags}( ta->\hyperlink{classOkular_1_1Annotation_a3d6f7ee5057155b90e76c24768880947}{flags}() | 
      \hyperlink{classOkular_1_1Annotation_a8a214541446745761efeda70b3a4302ea31a80c8e10831d2dccdf80cadb74fb3c}{Okular::Annotation::FixedRotation} );
171                     ta->\hyperlink{classOkular_1_1Annotation_a65a7316062031c6fdf578835245ddbd1}{setContents}( note );
172                     ta->\hyperlink{classOkular_1_1TextAnnotation_aa755aebfdc64ce680064d4e9f64dde92}{setTextType}( \hyperlink{classOkular_1_1TextAnnotation_af560204454bf812797bc95bea730b06ea2a746e9125e8cf53627335a8af01b998}{Okular::TextAnnotation::InPlace}
       );
173                     \textcolor{comment}{//set alignment}
174                     \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"align"} ) )
175                         ta->\hyperlink{classOkular_1_1TextAnnotation_a469a5ee0efdbb56d009262f80a8dec23}{setInplaceAlignment}( 
      \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"align"} ).toInt() );
176                     \textcolor{comment}{//set font}
177                     \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"font"} ) )
178                     \{
179                         QFont f;
180                         f.fromString( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"font"} ) );
181                         ta->\hyperlink{classOkular_1_1TextAnnotation_adcf0c9d4bbf9445753ff1f082432378b}{setTextFont}( f );
182                     \}
183                     \textcolor{comment}{//set boundary}
184                     rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = qMin(startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x},point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x});
185                     rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = qMin(startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y},point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y});
186                     rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = qMax(startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x},point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x});
187                     rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = qMax(startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y},point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y});
188                     kDebug().nospace() << \textcolor{stringliteral}{"xyScale="} << xscale << \textcolor{stringliteral}{","} << yscale;
189                     \textcolor{keyword}{static} \textcolor{keywordtype}{int} padding = 2;
190                     \textcolor{keyword}{const} QFontMetricsF mf(ta->\hyperlink{classOkular_1_1TextAnnotation_aa48f194058046e70141412a5e85e7199}{textFont}());
191                     \textcolor{keyword}{const} QRectF rcf = mf.boundingRect( \hyperlink{classOkular_1_1NormalizedRect}{Okular::NormalizedRect}( rect.
      \hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left}, rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top}, 1.0, 1.0 ).\hyperlink{classOkular_1_1NormalizedRect_a006897c5fcff2c3a97b4141f1a967513}{geometry}( (\textcolor{keywordtype}{int})pagewidth, (\textcolor{keywordtype}{int})pageheight ).adjusted( padding, 
      padding, -padding, -padding ),
192                                                   Qt::AlignTop | Qt::AlignLeft | Qt::TextWordWrap, ta->
      \hyperlink{classOkular_1_1Annotation_a3b0c9fcbe9d01e06bfcc7216d0035908}{contents}() );
193                     rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = qMax(rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right}, rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left}+(rcf.width()+padding*2)/pagewidth
      );
194                     rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = qMax(rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom}, rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top}+(rcf.height()+padding*2)/
      pageheight);
195                     ta->\hyperlink{classOkular_1_1Annotation_a560281f35ace621f48181a7c7977ca7f}{window}().\hyperlink{classOkular_1_1Annotation_1_1Window_a14857528578516a321a4901c49aaf60f}{setSummary}( i18n( \textcolor{stringliteral}{"Inline Note"} ) );
196                 \}
197             \}
198             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"Text"})
199             \{
200                 \hyperlink{classOkular_1_1TextAnnotation}{Okular::TextAnnotation} * ta = \textcolor{keyword}{new} 
      \hyperlink{classOkular_1_1TextAnnotation}{Okular::TextAnnotation}();
201                 ann = ta;
202                 ta->\hyperlink{classOkular_1_1TextAnnotation_aa755aebfdc64ce680064d4e9f64dde92}{setTextType}( \hyperlink{classOkular_1_1TextAnnotation_af560204454bf812797bc95bea730b06eaf7d7133e8e4850bf030e108537a9887b}{Okular::TextAnnotation::Linked} );
203                 ta->\hyperlink{classOkular_1_1TextAnnotation_a4fc186a6617f71488283fa6f7dcf8222}{setTextIcon}( iconName );
204                 \textcolor{comment}{//ta->window.flags &= ~(Okular::Annotation::Hidden);}
205                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} iconhei=0.03;
206                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x};
207                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y};
208                 rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right}=rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left}+iconhei;
209                 rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom}=rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top}+iconhei*xscale/yscale;
210                 ta->\hyperlink{classOkular_1_1Annotation_a560281f35ace621f48181a7c7977ca7f}{window}().\hyperlink{classOkular_1_1Annotation_1_1Window_a14857528578516a321a4901c49aaf60f}{setSummary}( i18n( \textcolor{stringliteral}{"Pop-up Note"} ) );
211             \}
212             \textcolor{comment}{// create StampAnnotation from path}
213             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"Stamp"} )
214             \{
215                 \hyperlink{classOkular_1_1StampAnnotation}{Okular::StampAnnotation} * sa = \textcolor{keyword}{new} 
      \hyperlink{classOkular_1_1StampAnnotation}{Okular::StampAnnotation}();
216                 ann = sa;
217                 sa->\hyperlink{classOkular_1_1StampAnnotation_a3bfe9da6d3494b762bc5561c6169179b}{setStampIconName}( iconName );
218                 \textcolor{comment}{// set boundary}
219                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} );
220                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} );
221                 rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} );
222                 rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} );
223                 \textcolor{keyword}{const} QRectF rcf = rect.\hyperlink{classOkular_1_1NormalizedRect_a006897c5fcff2c3a97b4141f1a967513}{geometry}( (\textcolor{keywordtype}{int})xscale, (\textcolor{keywordtype}{int})yscale );
224                 \textcolor{keyword}{const} \textcolor{keywordtype}{int} ml = ( rcf.bottomRight() - rcf.topLeft() ).toPoint().manhattanLength();
225                 \textcolor{keywordflow}{if} ( ml <= QApplication::startDragDistance() )
226                 \{
227                     \textcolor{keyword}{const} \textcolor{keywordtype}{double} stampxscale = \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} / xscale;
228                     \textcolor{keyword}{const} \textcolor{keywordtype}{double} stampyscale = \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} / yscale;
229                     \textcolor{keywordflow}{if} ( center )
230                     \{
231                         rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} - stampxscale / 2;
232                         rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} - stampyscale / 2;
233                     \}
234                     \textcolor{keywordflow}{else}
235                     \{
236                         rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x};
237                         rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y};
238                     \}
239                     rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} + stampxscale;
240                     rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} + stampyscale;
241                 \}
242             \}
243             \textcolor{comment}{// create GeomAnnotation}
244             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"GeomSquare"} || typeString == \textcolor{stringliteral}{"GeomCircle"} )
245             \{
246                 \hyperlink{classOkular_1_1GeomAnnotation}{Okular::GeomAnnotation} * ga = \textcolor{keyword}{new} 
      \hyperlink{classOkular_1_1GeomAnnotation}{Okular::GeomAnnotation}();
247                 ann = ga;
248                 \textcolor{comment}{// set the type}
249                 \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"GeomSquare"} )
250                     ga->\hyperlink{classOkular_1_1GeomAnnotation_a5e9487a727fc9299b69db657bb69fd89}{setGeometricalType}( 
      \hyperlink{classOkular_1_1GeomAnnotation_a511623ed10a8d1f18cfd5987fadee682a5c7718299cc7aad186005a1bd0c86e9e}{Okular::GeomAnnotation::InscribedSquare} );
251                 \textcolor{keywordflow}{else}
252                     ga->\hyperlink{classOkular_1_1GeomAnnotation_a5e9487a727fc9299b69db657bb69fd89}{setGeometricalType}( 
      \hyperlink{classOkular_1_1GeomAnnotation_a511623ed10a8d1f18cfd5987fadee682a30a6611d755c0404efaf196327194bfc}{Okular::GeomAnnotation::InscribedCircle} );
253                 \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"width"} ) )
254                     ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_af0643b15b59d282c196f0c6114493d9e}{setWidth}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"width"} ).
      toDouble() );
255                 \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"innerColor"} ) )
256                     ga->\hyperlink{classOkular_1_1GeomAnnotation_ab47f1690d00f9ee6efc70c19aeb2e7e8}{setGeometricalInnerColor}( QColor( 
      \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"innerColor"} ) ) );
257                 \textcolor{comment}{//set boundary}
258                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} );
259                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} );
260                 rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} );
261                 rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} );
262             \}
263 
264             \hyperlink{classAnnotatorEngine_a0df119b4d87a1e3ea8ed60a96d7ff444}{m\_creationCompleted} = \textcolor{keyword}{false};
265             clicked = \textcolor{keyword}{false};
266 
267             \textcolor{comment}{// safety check}
268             \textcolor{keywordflow}{if} ( !ann )
269                 \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}();
270 
271             \textcolor{comment}{// set common attributes}
272             ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_a1c916cd50a0a4114188136d47943ef00}{setColor}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"color"} ) ?
273                     \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"color"} ) : 
      \hyperlink{classAnnotatorEngine_a8911b0455be7eedfb2c102ce19acdce2}{m\_engineColor} );
274             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"opacity"} ) )
275                 ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_a5bf0bdd3bf954271ed4ba831316a7ee7}{setOpacity}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"opacity"}, \textcolor{stringliteral}{
      "1.0"} ).toDouble() );
276 
277             \textcolor{comment}{// set the bounding rectangle, and make sure that the newly created}
278             \textcolor{comment}{// annotation lies within the page by translating it if necessary}
279             \textcolor{keywordflow}{if} ( rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} > 1 )
280             \{
281                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} -= rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} - 1;
282                 rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = 1;
283             \}
284             \textcolor{keywordflow}{if} ( rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} > 1 )
285             \{
286                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} -= rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} - 1;
287                 rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = 1;
288             \}
289             ann->\hyperlink{classOkular_1_1Annotation_a6977075c78f130b71ddbbda924480f38}{setBoundingRectangle}( rect );
290 
291             \textcolor{comment}{// return annotation}
292             \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}() << ann;
293         \}
\end{DoxyCode}
\hypertarget{classPickPointEngine_a7dd04c96b28fbf6dba26c5f277827ece}{\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!event@{event}}
\index{event@{event}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\subsubsection[{event}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Rect Pick\+Point\+Engine\+::event (
\begin{DoxyParamCaption}
\item[{{\bf Event\+Type}}]{type, }
\item[{{\bf Button}}]{button, }
\item[{double}]{n\+X, }
\item[{double}]{n\+Y, }
\item[{double}]{x\+Scale, }
\item[{double}]{y\+Scale, }
\item[{const {\bf Okular\+::\+Page} $\ast$}]{page}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPickPointEngine_a7dd04c96b28fbf6dba26c5f277827ece}


Implements \hyperlink{classAnnotatorEngine_acca989fc60f9a6c20ed2518fafa8774e}{Annotator\+Engine}.



Definition at line 72 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
73         \{
74             xscale=xScale;
75             yscale=yScale;
76             pagewidth = page->\hyperlink{classOkular_1_1Page_a57114e88281da2a51b1bb0d5d4996d53}{width}();
77             pageheight = page->\hyperlink{classOkular_1_1Page_a67246a32b3e625946eb5c685b8372a4f}{height}();
78             \textcolor{comment}{// only proceed if pressing left button}
79             \textcolor{keywordflow}{if} ( button != \hyperlink{classAnnotatorEngine_ac2e3b75e12bacbb6974d15dd53954567a2719e853d63982d67e9d8aae3620178c}{Left} )
80                 \textcolor{keywordflow}{return} QRect();
81 
82             \textcolor{comment}{// start operation on click}
83             \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133a7f6f77a85d31dc6afd375db9a53d5069}{Press} && clicked == \textcolor{keyword}{false} )
84             \{
85                 clicked = \textcolor{keyword}{true};
86                 startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}=nX;
87                 startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}=nY;
88             \}
89             \textcolor{comment}{// repaint if moving while pressing}
90             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133a4efcf099c4a82b1eab7de0fb124563a8}{Move} && clicked == \textcolor{keyword}{true} )
91             \{
92             \}
93             \textcolor{comment}{// operation finished on release}
94             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133ac80dbad38d0461d9e546aa694c2abc1c}{Release} && clicked == \textcolor{keyword}{true} )
95             \{
96                 \hyperlink{classAnnotatorEngine_a0df119b4d87a1e3ea8ed60a96d7ff444}{m\_creationCompleted} = \textcolor{keyword}{true};
97             \}
98             \textcolor{keywordflow}{else}
99                 \textcolor{keywordflow}{return} QRect();
100 
101             \textcolor{comment}{// update variables and extents (zoom invariant rect)}
102             point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} = nX;
103             point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} = nY;
104             \textcolor{keywordflow}{if} ( center )
105             \{
106                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = nX - ( \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} / ( xScale * 2.0 ) );
107                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = nY - ( \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} / ( yScale * 2.0 ) );
108             \}
109             \textcolor{keywordflow}{else}
110             \{
111                 rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} = nX;
112                 rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} = nY;
113             \}
114             rect.\hyperlink{classOkular_1_1NormalizedRect_a12bbdbb865e6282c9a325b61638553f4}{right} = rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} + \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size};
115             rect.\hyperlink{classOkular_1_1NormalizedRect_a06fddfff238371f6f584360c0678741a}{bottom} = rect.\hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} + \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size};
116             QRect boundrect = rect.\hyperlink{classOkular_1_1NormalizedRect_a006897c5fcff2c3a97b4141f1a967513}{geometry}( (\textcolor{keywordtype}{int})xScale, (\textcolor{keywordtype}{int})yScale ).adjusted( 0, 0, 1, 1 );
117             \textcolor{keywordflow}{if} ( m\_block )
118             \{
119                 \textcolor{keyword}{const} \hyperlink{classOkular_1_1NormalizedRect}{Okular::NormalizedRect} tmprect( qMin( startpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ), qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ), qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ), qMax( startpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ) );
120                 boundrect |= tmprect.geometry( (\textcolor{keywordtype}{int})xScale, (\textcolor{keywordtype}{int})yScale ).adjusted( 0, 0, 1, 1 );
121             \}
122             \textcolor{keywordflow}{return} boundrect;
123         \}
\end{DoxyCode}
\hypertarget{classPickPointEngine_a1af9d4c401554caa10918985dbd7aae2}{\index{Pick\+Point\+Engine@{Pick\+Point\+Engine}!paint@{paint}}
\index{paint@{paint}!Pick\+Point\+Engine@{Pick\+Point\+Engine}}
\subsubsection[{paint}]{\setlength{\rightskip}{0pt plus 5cm}void Pick\+Point\+Engine\+::paint (
\begin{DoxyParamCaption}
\item[{Q\+Painter $\ast$}]{painter, }
\item[{double}]{x\+Scale, }
\item[{double}]{y\+Scale, }
\item[{const Q\+Rect \&}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPickPointEngine_a1af9d4c401554caa10918985dbd7aae2}


Implements \hyperlink{classAnnotatorEngine_a71b2e9fcbcca36caadefa79adb99c93f}{Annotator\+Engine}.



Definition at line 125 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
126         \{
127             \textcolor{keywordflow}{if} ( clicked )
128             \{
129                 \textcolor{keywordflow}{if} ( m\_block )
130                 \{
131                     \textcolor{keyword}{const} QPen origpen = painter->pen();
132                     QPen pen = painter->pen();
133                     pen.setStyle( Qt::DashLine );
134                     painter->setPen( pen );
135                     \textcolor{keyword}{const} \hyperlink{classOkular_1_1NormalizedRect}{Okular::NormalizedRect} tmprect( qMin( startpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ), qMin( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ), qMax( startpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}, point.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ), qMax( startpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}, point.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ) );
136                     \textcolor{keyword}{const} QRect realrect = tmprect.geometry( (\textcolor{keywordtype}{int})xScale, (\textcolor{keywordtype}{int})yScale );
137                     painter->drawRect( realrect );
138                     painter->setPen( origpen );
139                 \}
140                 \textcolor{keywordflow}{if} ( pixmap )
141                     painter->drawPixmap( QPointF( rect.\hyperlink{classOkular_1_1NormalizedRect_a76336fe9d733f2b559cf8df3ef48f9e7}{left} * xScale, rect.
      \hyperlink{classOkular_1_1NormalizedRect_acfb70f6417c993508d50090b512cb954}{top} * yScale ), *pixmap );
142             \}
143         \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
ui/\hyperlink{pageviewannotator_8cpp}{pageviewannotator.\+cpp}\end{DoxyCompactItemize}
