\hypertarget{classAnnotationPopup}{\section{Annotation\+Popup Class Reference}
\label{classAnnotationPopup}\index{Annotation\+Popup@{Annotation\+Popup}}
}


{\ttfamily \#include $<$annotationpopup.\+h$>$}

Inheritance diagram for Annotation\+Popup\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classAnnotationPopup}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structAnnotationPopup_1_1AnnotPagePair}{Annot\+Page\+Pair}
\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679}{Menu\+Mode} \{ \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679a40137692e843ce4f994737bd4a6f68f1}{Single\+Annotation\+Mode}, 
\hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679addf6a6dddf8c14065bb700f1835dafb9}{Multi\+Annotation\+Mode}
 \}
\end{DoxyCompactItemize}
\subsection*{Signals}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classAnnotationPopup_a2f542d2aa2c7cc85b4bc9045be5adcc9}{open\+Annotation\+Window} (\hyperlink{classOkular_1_1Annotation}{Okular\+::\+Annotation} $\ast$annotation, int page\+Number)
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classAnnotationPopup_a239651270ccd047fcba04c71f7b49a45}{Annotation\+Popup} (\hyperlink{classOkular_1_1Document}{Okular\+::\+Document} $\ast$document, \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679}{Menu\+Mode} mode, Q\+Widget $\ast$parent=0)
\item 
void \hyperlink{classAnnotationPopup_a3235e948e6dcc5ec49dc38df56d89a9c}{add\+Annotation} (\hyperlink{classOkular_1_1Annotation}{Okular\+::\+Annotation} $\ast$annotation, int page\+Number)
\item 
void \hyperlink{classAnnotationPopup_a54b930f61b3d40661d0af18667a1573f}{exec} (const Q\+Point \&point=Q\+Point())
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 23 of file annotationpopup.\+h.



\subsection{Member Enumeration Documentation}
\hypertarget{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679}{\index{Annotation\+Popup@{Annotation\+Popup}!Menu\+Mode@{Menu\+Mode}}
\index{Menu\+Mode@{Menu\+Mode}!Annotation\+Popup@{Annotation\+Popup}}
\subsubsection[{Menu\+Mode}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Annotation\+Popup\+::\+Menu\+Mode}}}\label{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679}
Describes the structure of the popup menu. \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{Single\+Annotation\+Mode@{Single\+Annotation\+Mode}!Annotation\+Popup@{Annotation\+Popup}}\index{Annotation\+Popup@{Annotation\+Popup}!Single\+Annotation\+Mode@{Single\+Annotation\+Mode}}\item[{\em 
\hypertarget{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679a40137692e843ce4f994737bd4a6f68f1}{Single\+Annotation\+Mode}\label{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679a40137692e843ce4f994737bd4a6f68f1}
}]The menu shows only entries to manipulate a single annotation, or multiple annotations as a group. \index{Multi\+Annotation\+Mode@{Multi\+Annotation\+Mode}!Annotation\+Popup@{Annotation\+Popup}}\index{Annotation\+Popup@{Annotation\+Popup}!Multi\+Annotation\+Mode@{Multi\+Annotation\+Mode}}\item[{\em 
\hypertarget{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679addf6a6dddf8c14065bb700f1835dafb9}{Multi\+Annotation\+Mode}\label{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679addf6a6dddf8c14065bb700f1835dafb9}
}]The menu shows entries to manipulate multiple annotations. \end{description}
\end{Desc}


Definition at line 31 of file annotationpopup.\+h.


\begin{DoxyCode}
32         \{
33             \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679a40137692e843ce4f994737bd4a6f68f1}{SingleAnnotationMode}, 
34             \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679addf6a6dddf8c14065bb700f1835dafb9}{MultiAnnotationMode}   
35         \};
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classAnnotationPopup_a239651270ccd047fcba04c71f7b49a45}{\index{Annotation\+Popup@{Annotation\+Popup}!Annotation\+Popup@{Annotation\+Popup}}
\index{Annotation\+Popup@{Annotation\+Popup}!Annotation\+Popup@{Annotation\+Popup}}
\subsubsection[{Annotation\+Popup}]{\setlength{\rightskip}{0pt plus 5cm}Annotation\+Popup\+::\+Annotation\+Popup (
\begin{DoxyParamCaption}
\item[{{\bf Okular\+::\+Document} $\ast$}]{document, }
\item[{{\bf Menu\+Mode}}]{mode, }
\item[{Q\+Widget $\ast$}]{parent = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{classAnnotationPopup_a239651270ccd047fcba04c71f7b49a45}


Definition at line 23 of file annotationpopup.\+cpp.


\begin{DoxyCode}
25     : mParent( parent ), mDocument( document ), mMenuMode( mode )
26 \{
27 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classAnnotationPopup_a3235e948e6dcc5ec49dc38df56d89a9c}{\index{Annotation\+Popup@{Annotation\+Popup}!add\+Annotation@{add\+Annotation}}
\index{add\+Annotation@{add\+Annotation}!Annotation\+Popup@{Annotation\+Popup}}
\subsubsection[{add\+Annotation}]{\setlength{\rightskip}{0pt plus 5cm}void Annotation\+Popup\+::add\+Annotation (
\begin{DoxyParamCaption}
\item[{{\bf Okular\+::\+Annotation} $\ast$}]{annotation, }
\item[{int}]{page\+Number}
\end{DoxyParamCaption}
)}}\label{classAnnotationPopup_a3235e948e6dcc5ec49dc38df56d89a9c}


Definition at line 29 of file annotationpopup.\+cpp.


\begin{DoxyCode}
30 \{
31     AnnotPagePair pair( annotation, pageNumber );
32     \textcolor{keywordflow}{if} ( !mAnnotations.contains( pair ) )
33       mAnnotations.append( pair );
34 \}
\end{DoxyCode}
\hypertarget{classAnnotationPopup_a54b930f61b3d40661d0af18667a1573f}{\index{Annotation\+Popup@{Annotation\+Popup}!exec@{exec}}
\index{exec@{exec}!Annotation\+Popup@{Annotation\+Popup}}
\subsubsection[{exec}]{\setlength{\rightskip}{0pt plus 5cm}void Annotation\+Popup\+::exec (
\begin{DoxyParamCaption}
\item[{const Q\+Point \&}]{point = {\ttfamily QPoint()}}
\end{DoxyParamCaption}
)}}\label{classAnnotationPopup_a54b930f61b3d40661d0af18667a1573f}


Definition at line 36 of file annotationpopup.\+cpp.


\begin{DoxyCode}
37 \{
38     \textcolor{keywordflow}{if} ( mAnnotations.isEmpty() )
39         \textcolor{keywordflow}{return};
40 
41     KMenu menu( mParent );
42 
43     QAction *action = 0;
44     \hyperlink{classOkular_1_1FileAttachmentAnnotation}{Okular::FileAttachmentAnnotation} *fileAttachAnnot = 0;
45 
46     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *actionTypeId = \textcolor{stringliteral}{"actionType"};
47 
48     \textcolor{keyword}{const} QString openId = QString::fromLatin1( \textcolor{stringliteral}{"open"} );
49     \textcolor{keyword}{const} QString deleteId = QString::fromLatin1( \textcolor{stringliteral}{"delete"} );
50     \textcolor{keyword}{const} QString deleteAllId = QString::fromLatin1( \textcolor{stringliteral}{"deleteAll"} );
51     \textcolor{keyword}{const} QString propertiesId = QString::fromLatin1( \textcolor{stringliteral}{"properties"} );
52     \textcolor{keyword}{const} QString saveId = QString::fromLatin1( \textcolor{stringliteral}{"save"} );
53 
54     \textcolor{keywordflow}{if} ( mMenuMode == \hyperlink{classAnnotationPopup_af8654f3f9c2a3377f86daf329f1e0679a40137692e843ce4f994737bd4a6f68f1}{SingleAnnotationMode} )
55     \{
56         \textcolor{keyword}{const} \textcolor{keywordtype}{bool} onlyOne = (mAnnotations.count() == 1);
57 
58         \textcolor{keyword}{const} AnnotPagePair &pair = mAnnotations.at(0);
59 
60         menu.addTitle( i18np( \textcolor{stringliteral}{"Annotation"}, \textcolor{stringliteral}{"%1 Annotations"}, mAnnotations.count() ) );
61 
62         action = menu.addAction( KIcon( \textcolor{stringliteral}{"comment"} ), i18n( \textcolor{stringliteral}{"&Open Pop-up Note"} ) );
63         action->setData( QVariant::fromValue( pair ) );
64         action->setEnabled( onlyOne );
65         action->setProperty( actionTypeId, openId );
66 
67         action = menu.addAction( KIcon( \textcolor{stringliteral}{"list-remove"} ), i18n( \textcolor{stringliteral}{"&Delete"} ) );
68         action->setEnabled( mDocument->\hyperlink{classOkular_1_1Document_a6dd7a475b14222c07d1c410311f35cdb}{isAllowed}( \hyperlink{namespaceOkular_a3601f4e702453ddf1125476dd6e7577ba6c10962833bd58ea0f8d63e448eba8e9}{Okular::AllowNotes} ) );
69         action->setProperty( actionTypeId, deleteAllId );
70 
71         \textcolor{keywordflow}{foreach} ( \textcolor{keyword}{const} AnnotPagePair& pair, mAnnotations )
72         \{
73             \textcolor{keywordflow}{if} ( !mDocument->\hyperlink{classOkular_1_1Document_a77f5c38224da847413dbe51c5e24ed08}{canRemovePageAnnotation}( pair.annotation ) )
74                 action->setEnabled( \textcolor{keyword}{false} );
75         \}
76 
77         action = menu.addAction( KIcon( \textcolor{stringliteral}{"configure"} ), i18n( \textcolor{stringliteral}{"&Properties"} ) );
78         action->setData( QVariant::fromValue( pair ) );
79         action->setEnabled( onlyOne );
80         action->setProperty( actionTypeId, propertiesId );
81 
82         \textcolor{keywordflow}{if} ( onlyOne && pair.annotation->subType() == 
      \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a7209cbfb5e13c0f80ac36f87c9575836}{Okular::Annotation::AFileAttachment} )
83         \{
84             menu.addSeparator();
85             fileAttachAnnot = \textcolor{keyword}{static\_cast<} \hyperlink{classOkular_1_1FileAttachmentAnnotation}{Okular::FileAttachmentAnnotation}
       * \textcolor{keyword}{>}( pair.annotation );
86             \textcolor{keyword}{const} QString saveText = i18nc( \textcolor{stringliteral}{"%1 is the name of the file to save"}, \textcolor{stringliteral}{"&Save '%1'..."}, 
      fileAttachAnnot->\hyperlink{classOkular_1_1FileAttachmentAnnotation_a22ff85c689647a6daa6bac053fe60cbb}{embeddedFile}()->\hyperlink{classOkular_1_1EmbeddedFile_a70fcfea705979ce6a31b989fc92a8f2b}{name}() );
87 
88             action = menu.addAction( KIcon( \textcolor{stringliteral}{"document-save"} ), saveText );
89             action->setData( QVariant::fromValue( pair ) );
90             action->setProperty( actionTypeId, saveId );
91         \}
92     \}
93     \textcolor{keywordflow}{else}
94     \{
95         \textcolor{keywordflow}{foreach} ( \textcolor{keyword}{const} AnnotPagePair& pair, mAnnotations )
96         \{
97             menu.addTitle( \hyperlink{namespaceGuiUtils_af15abd3dd32e982db3f842e807146835}{GuiUtils::captionForAnnotation}( pair.annotation ) 
      );
98 
99             action = menu.addAction( KIcon( \textcolor{stringliteral}{"comment"} ), i18n( \textcolor{stringliteral}{"&Open Pop-up Note"} ) );
100             action->setData( QVariant::fromValue( pair ) );
101             action->setProperty( actionTypeId, openId );
102 
103             action = menu.addAction( KIcon( \textcolor{stringliteral}{"list-remove"} ), i18n( \textcolor{stringliteral}{"&Delete"} ) );
104             action->setEnabled( mDocument->\hyperlink{classOkular_1_1Document_a6dd7a475b14222c07d1c410311f35cdb}{isAllowed}( 
      \hyperlink{namespaceOkular_a3601f4e702453ddf1125476dd6e7577ba6c10962833bd58ea0f8d63e448eba8e9}{Okular::AllowNotes} ) &&
105                                 mDocument->\hyperlink{classOkular_1_1Document_a77f5c38224da847413dbe51c5e24ed08}{canRemovePageAnnotation}( pair.annotation 
      ) );
106             action->setData( QVariant::fromValue( pair ) );
107             action->setProperty( actionTypeId, deleteId );
108 
109             action = menu.addAction( KIcon( \textcolor{stringliteral}{"configure"} ), i18n( \textcolor{stringliteral}{"&Properties"} ) );
110             action->setData( QVariant::fromValue( pair ) );
111             action->setProperty( actionTypeId, propertiesId );
112 
113             \textcolor{keywordflow}{if} ( pair.annotation->subType() == 
      \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a7209cbfb5e13c0f80ac36f87c9575836}{Okular::Annotation::AFileAttachment} )
114             \{
115                 menu.addSeparator();
116                 fileAttachAnnot = \textcolor{keyword}{static\_cast<} \hyperlink{classOkular_1_1FileAttachmentAnnotation}{Okular::FileAttachmentAnnotation}
       * \textcolor{keyword}{>}( pair.annotation );
117                 \textcolor{keyword}{const} QString saveText = i18nc( \textcolor{stringliteral}{"%1 is the name of the file to save"}, \textcolor{stringliteral}{"&Save '%1'..."}, 
      fileAttachAnnot->\hyperlink{classOkular_1_1FileAttachmentAnnotation_a22ff85c689647a6daa6bac053fe60cbb}{embeddedFile}()->\hyperlink{classOkular_1_1EmbeddedFile_a70fcfea705979ce6a31b989fc92a8f2b}{name}() );
118 
119                 action = menu.addAction( KIcon( \textcolor{stringliteral}{"document-save"} ), saveText );
120                 action->setData( QVariant::fromValue( pair ) );
121                 action->setProperty( actionTypeId, saveId );
122             \}
123         \}
124     \}
125 
126     QAction *choice = menu.exec( point.isNull() ? QCursor::pos() : point );
127 
128     \textcolor{comment}{// check if the user really selected an action}
129     \textcolor{keywordflow}{if} ( choice ) \{
130         \textcolor{keyword}{const} AnnotPagePair pair = choice->data().value<AnnotPagePair>();
131 
132         \textcolor{keyword}{const} QString actionType = choice->property( actionTypeId ).toString();
133         \textcolor{keywordflow}{if} ( actionType == openId ) \{
134             emit \hyperlink{classAnnotationPopup_a2f542d2aa2c7cc85b4bc9045be5adcc9}{openAnnotationWindow}( pair.annotation, pair.pageNumber );
135         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( actionType == deleteId ) \{
136             \textcolor{keywordflow}{if} ( pair.pageNumber != -1 )
137                 mDocument->\hyperlink{classOkular_1_1Document_af8ae711ce34ff903a589423e73a45cbb}{removePageAnnotation}( pair.pageNumber, pair.annotation );
138         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( actionType == deleteAllId ) \{
139             Q\_FOREACH ( \textcolor{keyword}{const} AnnotPagePair& pair, mAnnotations )
140             \{
141                 \textcolor{keywordflow}{if} ( pair.pageNumber != -1 )
142                     mDocument->\hyperlink{classOkular_1_1Document_af8ae711ce34ff903a589423e73a45cbb}{removePageAnnotation}( pair.pageNumber, pair.annotation )
      ;
143             \}
144         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( actionType == propertiesId ) \{
145             \textcolor{keywordflow}{if} ( pair.pageNumber != -1 ) \{
146                 \hyperlink{classAnnotsPropertiesDialog}{AnnotsPropertiesDialog} propdialog( mParent, mDocument, pair.
      pageNumber, pair.annotation );
147                 propdialog.exec();
148             \}
149         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( actionType == saveId ) \{
150             \textcolor{keyword}{const} \hyperlink{classOkular_1_1FileAttachmentAnnotation}{Okular::FileAttachmentAnnotation} * fileAttachAnnot = \textcolor{keyword}{
      static\_cast<} \hyperlink{classOkular_1_1FileAttachmentAnnotation}{Okular::FileAttachmentAnnotation} * \textcolor{keyword}{>}( pair.annotation );
151             \hyperlink{namespaceGuiUtils_a5e934d5070afd94f91b3a5fbfb8cbc04}{GuiUtils::saveEmbeddedFile}( fileAttachAnnot->
      \hyperlink{classOkular_1_1FileAttachmentAnnotation_a22ff85c689647a6daa6bac053fe60cbb}{embeddedFile}(), mParent );
152         \}
153     \}
154 \}
\end{DoxyCode}
\hypertarget{classAnnotationPopup_a2f542d2aa2c7cc85b4bc9045be5adcc9}{\index{Annotation\+Popup@{Annotation\+Popup}!open\+Annotation\+Window@{open\+Annotation\+Window}}
\index{open\+Annotation\+Window@{open\+Annotation\+Window}!Annotation\+Popup@{Annotation\+Popup}}
\subsubsection[{open\+Annotation\+Window}]{\setlength{\rightskip}{0pt plus 5cm}void Annotation\+Popup\+::open\+Annotation\+Window (
\begin{DoxyParamCaption}
\item[{{\bf Okular\+::\+Annotation} $\ast$}]{annotation, }
\item[{int}]{page\+Number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classAnnotationPopup_a2f542d2aa2c7cc85b4bc9045be5adcc9}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
ui/\hyperlink{annotationpopup_8h}{annotationpopup.\+h}\item 
ui/\hyperlink{annotationpopup_8cpp}{annotationpopup.\+cpp}\end{DoxyCompactItemize}
