\hypertarget{classPropertiesDialog}{\section{Properties\+Dialog Class Reference}
\label{classPropertiesDialog}\index{Properties\+Dialog@{Properties\+Dialog}}
}


{\ttfamily \#include $<$propertiesdialog.\+h$>$}

Inheritance diagram for Properties\+Dialog\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classPropertiesDialog}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPropertiesDialog_a3b4c76f2a9c95ff781a1415e905fb0b2}{Properties\+Dialog} (Q\+Widget $\ast$parent, \hyperlink{classOkular_1_1Document}{Okular\+::\+Document} $\ast$doc)
\item 
virtual \hyperlink{classPropertiesDialog_a253681b0ab44d80137861c5a47ac360f}{$\sim$\+Properties\+Dialog} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 29 of file propertiesdialog.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classPropertiesDialog_a3b4c76f2a9c95ff781a1415e905fb0b2}{\index{Properties\+Dialog@{Properties\+Dialog}!Properties\+Dialog@{Properties\+Dialog}}
\index{Properties\+Dialog@{Properties\+Dialog}!Properties\+Dialog@{Properties\+Dialog}}
\subsubsection[{Properties\+Dialog}]{\setlength{\rightskip}{0pt plus 5cm}Properties\+Dialog\+::\+Properties\+Dialog (
\begin{DoxyParamCaption}
\item[{Q\+Widget $\ast$}]{parent, }
\item[{{\bf Okular\+::\+Document} $\ast$}]{doc}
\end{DoxyParamCaption}
)}}\label{classPropertiesDialog_a3b4c76f2a9c95ff781a1415e905fb0b2}
for mime type fields, show icon as well

place icon left of mime type's name

retrieve icon and place it in a Q\+Label

retrieve icon and place it in a Q\+Label

mime type's name and label

only mime type name

default for any other document information 

Definition at line 39 of file propertiesdialog.\+cpp.


\begin{DoxyCode}
40     : KPageDialog( parent ), m\_document( doc ), m\_fontPage( 0 ),
41       m\_fontModel( 0 ), m\_fontInfo( 0 ), m\_fontProgressBar( 0 ),
42       m\_fontScanStarted( \textcolor{keyword}{false} )
43 \{
44   setFaceType( Tabbed );
45   setCaption( i18n( \textcolor{stringliteral}{"Unknown File"} ) );
46   setButtons( Ok );
47 
48   \textcolor{comment}{// PROPERTIES}
49   QFrame *page = \textcolor{keyword}{new} QFrame();
50   KPageWidgetItem *item = addPage( page, i18n( \textcolor{stringliteral}{"&Properties"} ) );
51   item->setIcon( KIcon( \textcolor{stringliteral}{"document-properties"} ) );
52 
53   \textcolor{comment}{// get document info, if not present display blank data and a warning}
54   \textcolor{keyword}{const} \hyperlink{classOkular_1_1DocumentInfo}{Okular::DocumentInfo} * info = doc->\hyperlink{classOkular_1_1Document_a9c0b854496aa923bd575593a299af7e4}{documentInfo}();
55   \textcolor{keywordflow}{if} ( !info ) \{
56     QVBoxLayout *layout = \textcolor{keyword}{new} QVBoxLayout( page );
57     layout->addWidget( \textcolor{keyword}{new} QLabel( i18n( \textcolor{stringliteral}{"No document opened."} ), page ) );
58     \textcolor{keywordflow}{return};
59   \}
60 
61   QFormLayout *layout = \textcolor{keyword}{new} QFormLayout( page );
62 
63   \textcolor{comment}{// mime name based on mimetype id}
64   QString mimeName = info->\hyperlink{classOkular_1_1DocumentInfo_a568ea22f19b034255be4c19f55ab1d82}{get}( \textcolor{stringliteral}{"mimeType"} ).section( \textcolor{charliteral}{'/'}, -1 ).toUpper();
65   setCaption( i18n( \textcolor{stringliteral}{"%1 Properties"}, mimeName ) );
66 
67   QDomElement docElement = info->documentElement();
68 
69   \textcolor{keywordtype}{int} valMaxWidth = 100;
70 
71   \textcolor{comment}{/* obtains the properties list, conveniently ordered */}
72   QStringList orderedProperties;
73   orderedProperties << \hyperlink{classOkular_1_1DocumentInfo_a70cb5aa15e85e1690c7793ee9f4832b2}{Okular::DocumentInfo::getKeyString}( 
      \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a7b8cead9bd84a1c0397d9f56daf0925f}{Okular::DocumentInfo::FilePath} )
74                     << \hyperlink{classOkular_1_1DocumentInfo_a70cb5aa15e85e1690c7793ee9f4832b2}{Okular::DocumentInfo::getKeyString}( 
      \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a81f3995418922c0bc020a9a578a3699e}{Okular::DocumentInfo::PagesSize} )
75                     << \hyperlink{classOkular_1_1DocumentInfo_a70cb5aa15e85e1690c7793ee9f4832b2}{Okular::DocumentInfo::getKeyString}( 
      \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791ac687d1236964fde6c969f511281feaf1}{Okular::DocumentInfo::DocumentSize} );
76   \textcolor{keywordflow}{for} (\hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791}{Okular::DocumentInfo::Key} ks = 
      \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791ae400626d63f14b61c55bd22aca9481e0}{Okular::DocumentInfo::Title}; 
77           ks <= \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a833799005454e6c7e389dcceddd42b19}{Okular::DocumentInfo::Keywords}; 
78           ks = \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791}{Okular::DocumentInfo::Key}( ks+1 ) ) \{
79       orderedProperties << \hyperlink{classOkular_1_1DocumentInfo_a70cb5aa15e85e1690c7793ee9f4832b2}{Okular::DocumentInfo::getKeyString}( ks );
80   \}
81   \textcolor{keywordflow}{for} ( QDomNode node = docElement.firstChild(); !node.isNull(); node = node.nextSibling() ) \{
82     \textcolor{keyword}{const} QDomElement element = node.toElement();
83 
84     \textcolor{keyword}{const} QString titleString = element.attribute( \textcolor{stringliteral}{"title"} );
85     \textcolor{keyword}{const} QString valueString = element.attribute( \textcolor{stringliteral}{"value"} );
86     \textcolor{keywordflow}{if} ( titleString.isEmpty() || valueString.isEmpty() )
87         \textcolor{keywordflow}{continue};
88     \textcolor{keywordflow}{if} ( !orderedProperties.contains( element.tagName() ) ) \{
89         orderedProperties << element.tagName();
90     \}
91   \}
92 
93   QDomNodeList list;
94   
95   \textcolor{keywordflow}{for} ( QStringList::Iterator it = orderedProperties.begin(); 
96           it != orderedProperties.end(); ++it ) \{
97       list = docElement.elementsByTagName( (*it) );
98       \textcolor{keywordflow}{if} ( list.count() == 1 ) \{
99 
100         QDomElement element = list.at(0).toElement();
101         \textcolor{keyword}{const} QString titleString = element.attribute( \textcolor{stringliteral}{"title"} );
102         \textcolor{keyword}{const} QString valueString = element.attribute( \textcolor{stringliteral}{"value"} );
103         \textcolor{keywordflow}{if} ( titleString.isEmpty() || valueString.isEmpty() )
104             \textcolor{keywordflow}{continue};
105 
106         \textcolor{comment}{// create labels and layout them}
107         QWidget *value = NULL;
108         \textcolor{keywordflow}{if} ( element.tagName() == \hyperlink{classOkular_1_1DocumentInfo_a70cb5aa15e85e1690c7793ee9f4832b2}{Okular::DocumentInfo::getKeyString}( 
      \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a786464e8e8c3e6ba1cd74e408487785b}{Okular::DocumentInfo::MimeType} ) ) \{
110             value = \textcolor{keyword}{new} QWidget( page );
112             QHBoxLayout *hboxLayout = \textcolor{keyword}{new} QHBoxLayout( value );
113             hboxLayout->setMargin( 0 );
115             KMimeType::Ptr mimeType = KMimeType::mimeType( valueString );
116             KSqueezedTextLabel *squeezed;
117             \textcolor{keywordflow}{if} (!mimeType.isNull()) \{
119                 QLabel *pixmapLabel = \textcolor{keyword}{new} QLabel( value );
120                 hboxLayout->addWidget( pixmapLabel, 0 );
121                 pixmapLabel->setPixmap( KIconLoader::global()->loadMimeTypeIcon( mimeType->iconName(), 
      KIconLoader::Small ) );
123                 squeezed = \textcolor{keyword}{new} KSqueezedTextLabel( i18nc( \textcolor{stringliteral}{"mimetype information, example: \(\backslash\)"PDF Document
       (application/pdf)\(\backslash\)""}, \textcolor{stringliteral}{"%1 (%2)"}, mimeType->comment(), valueString ), value );
124             \} \textcolor{keywordflow}{else} \{
126                 squeezed = \textcolor{keyword}{new} KSqueezedTextLabel( valueString, value );
127             \}
128             squeezed->setTextInteractionFlags( Qt::TextSelectableByMouse );
129             hboxLayout->addWidget( squeezed, 1 );
130         \} \textcolor{keywordflow}{else} \{
132             KSqueezedTextLabel *label = \textcolor{keyword}{new} KSqueezedTextLabel( valueString, page );
133             label->setTextInteractionFlags( Qt::TextSelectableByMouse );
134             value = label;
135         \}
136         layout->addRow( \textcolor{keyword}{new} QLabel( i18n( \textcolor{stringliteral}{"%1:"}, titleString ) ), value);
137 
138         \textcolor{comment}{// refine maximum width of 'value' labels}
139         valMaxWidth = qMax( valMaxWidth, fontMetrics().width( valueString ) );
140     \}
141   \}
142 
143   \textcolor{comment}{// FONTS}
144   QVBoxLayout *page2Layout = 0;
145   \textcolor{keywordflow}{if} ( doc->\hyperlink{classOkular_1_1Document_a8c43c3aa0d740b48813bfbd5deec7f1c}{canProvideFontInformation}() ) \{
146     \textcolor{comment}{// create fonts tab and layout it}
147     QFrame *page2 = \textcolor{keyword}{new} QFrame();
148     m\_fontPage = addPage(page2, i18n(\textcolor{stringliteral}{"&Fonts"}));
149     m\_fontPage->setIcon( KIcon( \textcolor{stringliteral}{"preferences-desktop-font"} ) );
150     page2Layout = \textcolor{keyword}{new} QVBoxLayout(page2);
151     page2Layout->setMargin(marginHint());
152     page2Layout->setSpacing(spacingHint());
153     \textcolor{comment}{// add a tree view}
154     QTreeView *view = \textcolor{keyword}{new} QTreeView(page2);
155     view->setContextMenuPolicy(Qt::CustomContextMenu);
156     connect(view, SIGNAL(customContextMenuRequested(QPoint)), \textcolor{keyword}{this}, SLOT(showFontsMenu(QPoint)));
157     page2Layout->addWidget(view);
158     view->setRootIsDecorated(\textcolor{keyword}{false});
159     view->setAlternatingRowColors(\textcolor{keyword}{true});
160     view->setSortingEnabled( \textcolor{keyword}{true} );
161     \textcolor{comment}{// creating a proxy model so we can sort the data}
162     QSortFilterProxyModel *proxymodel = \textcolor{keyword}{new} QSortFilterProxyModel(view);
163     proxymodel->setDynamicSortFilter( \textcolor{keyword}{true} );
164     proxymodel->setSortCaseSensitivity( Qt::CaseInsensitive );
165     m\_fontModel = \textcolor{keyword}{new} \hyperlink{classFontsListModel}{FontsListModel}(view);
166     proxymodel->setSourceModel(m\_fontModel);
167     view->setModel(proxymodel);
168     view->sortByColumn( 0, Qt::AscendingOrder );
169     m\_fontInfo = \textcolor{keyword}{new} QLabel( \textcolor{keyword}{this} );
170     page2Layout->addWidget( m\_fontInfo );
171     m\_fontInfo->setText( i18n( \textcolor{stringliteral}{"Reading font information..."} ) );
172     m\_fontInfo->hide();
173     m\_fontProgressBar = \textcolor{keyword}{new} QProgressBar( \textcolor{keyword}{this} );
174     page2Layout->addWidget( m\_fontProgressBar );
175     m\_fontProgressBar->setRange( 0, 100 );
176     m\_fontProgressBar->setValue( 0 );
177     m\_fontProgressBar->hide();
178   \}
179 
180   \textcolor{comment}{// current width: left columnt + right column + dialog borders}
181   \textcolor{keywordtype}{int} width = layout->minimumSize().width() + valMaxWidth + 2 * marginHint() + spacingHint() + 30;
182   \textcolor{keywordflow}{if} ( page2Layout )
183     width = qMax( width, page2Layout->sizeHint().width() + marginHint() + spacingHint() + 31 );
184   \textcolor{comment}{// stay inside the 2/3 of the screen width}
185   QRect screenContainer = KGlobalSettings::desktopGeometry( \textcolor{keyword}{this} );
186   width = qMin( width, 2*screenContainer.width()/3 );
187   resize(width, 1);
188 
189     connect( pageWidget(), SIGNAL(currentPageChanged(KPageWidgetItem*,KPageWidgetItem*)),
190              \textcolor{keyword}{this}, SLOT(pageChanged(KPageWidgetItem*,KPageWidgetItem*)) );
191 \}
\end{DoxyCode}
\hypertarget{classPropertiesDialog_a253681b0ab44d80137861c5a47ac360f}{\index{Properties\+Dialog@{Properties\+Dialog}!````~Properties\+Dialog@{$\sim$\+Properties\+Dialog}}
\index{````~Properties\+Dialog@{$\sim$\+Properties\+Dialog}!Properties\+Dialog@{Properties\+Dialog}}
\subsubsection[{$\sim$\+Properties\+Dialog}]{\setlength{\rightskip}{0pt plus 5cm}Properties\+Dialog\+::$\sim$\+Properties\+Dialog (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classPropertiesDialog_a253681b0ab44d80137861c5a47ac360f}


Definition at line 193 of file propertiesdialog.\+cpp.


\begin{DoxyCode}
194 \{
195     m\_document->\hyperlink{classOkular_1_1Document_a25f2f47f51c226d137a914d168ac5e1b}{stopFontReading}();
196 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
ui/\hyperlink{propertiesdialog_8h}{propertiesdialog.\+h}\item 
ui/\hyperlink{propertiesdialog_8cpp}{propertiesdialog.\+cpp}\end{DoxyCompactItemize}
