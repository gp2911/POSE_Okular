\hypertarget{classOOO_1_1Document}{\section{O\+O\+O\+:\+:Document Class Reference}
\label{classOOO_1_1Document}\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
}


{\ttfamily \#include $<$document.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classOOO_1_1Document_a6a85de1f3ac9d88c2afd63d92e5e5d37}{Document} (const Q\+String \&file\+Name)
\item 
\hyperlink{classOOO_1_1Document_ac2e3f62307dc22baac21ddc10fa1609c}{$\sim$\+Document} ()
\item 
bool \hyperlink{classOOO_1_1Document_a21834f917a7da6d07426ecb688fbcc1f}{open} ()
\item 
Q\+String \hyperlink{classOOO_1_1Document_a26f06a190450786328eceb700ebfe45e}{last\+Error\+String} () const 
\item 
Q\+Byte\+Array \hyperlink{classOOO_1_1Document_ae9806decd06b8f4df010384f6fc822b1}{content} () const 
\item 
Q\+Byte\+Array \hyperlink{classOOO_1_1Document_a5f8a28667907ec96db23d5d624d42ba8}{meta} () const 
\item 
Q\+Byte\+Array \hyperlink{classOOO_1_1Document_ac61a883d4055dc5e684ca26f6904e74b}{styles} () const 
\item 
\hyperlink{classQMap}{Q\+Map}$<$ Q\+String, Q\+Byte\+Array $>$ \hyperlink{classOOO_1_1Document_a16e6fac9143bdae9d0a56d317403b112}{images} () const 
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 21 of file document.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classOOO_1_1Document_a6a85de1f3ac9d88c2afd63d92e5e5d37}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!Document@{Document}}
\index{Document@{Document}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{Document}]{\setlength{\rightskip}{0pt plus 5cm}Document\+::\+Document (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{file\+Name}
\end{DoxyParamCaption}
)}}\label{classOOO_1_1Document_a6a85de1f3ac9d88c2afd63d92e5e5d37}


Definition at line 17 of file document.\+cpp.


\begin{DoxyCode}
18   : mFileName( fileName ), mManifest( 0 )
19 \{
20 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_ac2e3f62307dc22baac21ddc10fa1609c}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!````~Document@{$\sim$\+Document}}
\index{````~Document@{$\sim$\+Document}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{$\sim$\+Document}]{\setlength{\rightskip}{0pt plus 5cm}Document\+::$\sim$\+Document (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classOOO_1_1Document_ac2e3f62307dc22baac21ddc10fa1609c}


Definition at line 106 of file document.\+cpp.


\begin{DoxyCode}
107 \{
108   \textcolor{keyword}{delete} mManifest;
109 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classOOO_1_1Document_ae9806decd06b8f4df010384f6fc822b1}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!content@{content}}
\index{content@{content}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{content}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Byte\+Array Document\+::content (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classOOO_1_1Document_ae9806decd06b8f4df010384f6fc822b1}


Definition at line 116 of file document.\+cpp.


\begin{DoxyCode}
117 \{
118   \textcolor{keywordflow}{return} mContent;
119 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_a16e6fac9143bdae9d0a56d317403b112}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!images@{images}}
\index{images@{images}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{images}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Q\+Map}$<$ Q\+String, Q\+Byte\+Array $>$ Document\+::images (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classOOO_1_1Document_a16e6fac9143bdae9d0a56d317403b112}


Definition at line 131 of file document.\+cpp.


\begin{DoxyCode}
132 \{
133   \textcolor{keywordflow}{return} mImages;
134 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_a26f06a190450786328eceb700ebfe45e}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!last\+Error\+String@{last\+Error\+String}}
\index{last\+Error\+String@{last\+Error\+String}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{last\+Error\+String}]{\setlength{\rightskip}{0pt plus 5cm}Q\+String Document\+::last\+Error\+String (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classOOO_1_1Document_a26f06a190450786328eceb700ebfe45e}


Definition at line 111 of file document.\+cpp.


\begin{DoxyCode}
112 \{
113   \textcolor{keywordflow}{return} mErrorString;
114 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_a5f8a28667907ec96db23d5d624d42ba8}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!meta@{meta}}
\index{meta@{meta}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{meta}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Byte\+Array Document\+::meta (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classOOO_1_1Document_a5f8a28667907ec96db23d5d624d42ba8}


Definition at line 121 of file document.\+cpp.


\begin{DoxyCode}
122 \{
123   \textcolor{keywordflow}{return} mMeta;
124 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_a21834f917a7da6d07426ecb688fbcc1f}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!open@{open}}
\index{open@{open}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{open}]{\setlength{\rightskip}{0pt plus 5cm}bool Document\+::open (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classOOO_1_1Document_a21834f917a7da6d07426ecb688fbcc1f}


Definition at line 22 of file document.\+cpp.


\begin{DoxyCode}
23 \{
24   mContent.clear();
25   mStyles.clear();
26 
27   KZip zip( mFileName );
28   \textcolor{keywordflow}{if} ( !zip.open( QIODevice::ReadOnly ) ) \{
29     setError( i18n( \textcolor{stringliteral}{"Document is not a valid ZIP archive"} ) );
30     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
31   \}
32 
33   \textcolor{keyword}{const} KArchiveDirectory *directory = zip.directory();
34   \textcolor{keywordflow}{if} ( !directory ) \{
35     setError( i18n( \textcolor{stringliteral}{"Invalid document structure (main directory is missing)"} ) );
36     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
37   \}
38 
39   \textcolor{keyword}{const} QStringList entries = directory->entries();
40   \textcolor{keywordflow}{if} ( !entries.contains( \textcolor{stringliteral}{"META-INF"} ) ) \{
41     setError( i18n( \textcolor{stringliteral}{"Invalid document structure (META-INF directory is missing)"} ) );
42     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
43   \}
44   \textcolor{keyword}{const} KArchiveDirectory *metaInfDirectory = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveDirectory*\textcolor{keyword}{>}( directory->entry( \textcolor{stringliteral}{"
      META-INF"} ) );
45   \textcolor{keywordflow}{if} ( !(metaInfDirectory->entries().contains( \textcolor{stringliteral}{"manifest.xml"} ) ) ) \{
46     setError( i18n( \textcolor{stringliteral}{"Invalid document structure (META-INF/manifest.xml is missing)"} ) );
47     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
48   \}
49 
50   \textcolor{keyword}{const} KArchiveFile *file = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveFile*\textcolor{keyword}{>}( metaInfDirectory->entry( \textcolor{stringliteral}{"manifest.xml"} ) );
51   mManifest = \textcolor{keyword}{new} \hyperlink{classOOO_1_1Manifest}{Manifest}( mFileName, file->data() );
52 
53   \textcolor{comment}{// we should really get the file names from the manifest, but for now, we only care}
54   \textcolor{comment}{// if the manifest says the files are encrypted.}
55 
56   \textcolor{keywordflow}{if} ( !entries.contains( \textcolor{stringliteral}{"content.xml"} ) ) \{
57     setError( i18n( \textcolor{stringliteral}{"Invalid document structure (content.xml is missing)"} ) );
58     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
59   \}
60 
61   file = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveFile*\textcolor{keyword}{>}( directory->entry( \textcolor{stringliteral}{"content.xml"} ) );
62   \textcolor{keywordflow}{if} ( mManifest->\hyperlink{classOOO_1_1Manifest_ad4dc3e80fccd7589b98d47824154df15}{testIfEncrypted}( \textcolor{stringliteral}{"content.xml"} )  ) \{
63     mContent = mManifest->\hyperlink{classOOO_1_1Manifest_a5e88bb8ac85d60ed396a295cc7d2933f}{decryptFile}( \textcolor{stringliteral}{"content.xml"}, file->data() );
64   \} \textcolor{keywordflow}{else} \{
65     mContent = file->data();
66   \}
67 
68   \textcolor{keywordflow}{if} ( entries.contains( \textcolor{stringliteral}{"styles.xml"} ) ) \{
69     file = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveFile*\textcolor{keyword}{>}( directory->entry( \textcolor{stringliteral}{"styles.xml"} ) );
70     \textcolor{keywordflow}{if} ( mManifest->\hyperlink{classOOO_1_1Manifest_ad4dc3e80fccd7589b98d47824154df15}{testIfEncrypted}( \textcolor{stringliteral}{"styles.xml"} )  ) \{
71       mStyles = mManifest->\hyperlink{classOOO_1_1Manifest_a5e88bb8ac85d60ed396a295cc7d2933f}{decryptFile}( \textcolor{stringliteral}{"styles.xml"}, file->data() );
72     \} \textcolor{keywordflow}{else} \{
73       mStyles = file->data();
74     \}
75   \}
76 
77   \textcolor{keywordflow}{if} ( entries.contains( \textcolor{stringliteral}{"meta.xml"} ) ) \{
78     file = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveFile*\textcolor{keyword}{>}( directory->entry( \textcolor{stringliteral}{"meta.xml"} ) );
79     \textcolor{keywordflow}{if} ( mManifest->\hyperlink{classOOO_1_1Manifest_ad4dc3e80fccd7589b98d47824154df15}{testIfEncrypted}( \textcolor{stringliteral}{"meta.xml"} )  ) \{
80       mMeta = mManifest->\hyperlink{classOOO_1_1Manifest_a5e88bb8ac85d60ed396a295cc7d2933f}{decryptFile}( \textcolor{stringliteral}{"meta.xml"}, file->data() );
81     \} \textcolor{keywordflow}{else} \{
82       mMeta = file->data();
83     \}
84   \}
85 
86   \textcolor{keywordflow}{if} ( entries.contains( \textcolor{stringliteral}{"Pictures"} ) ) \{
87     \textcolor{keyword}{const} KArchiveDirectory *imagesDirectory = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveDirectory*\textcolor{keyword}{>}( directory->entry( \textcolor{stringliteral}{"
      Pictures"} ) );
88 
89     \textcolor{keyword}{const} QStringList imagesEntries = imagesDirectory->entries();
90     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < imagesEntries.count(); ++i ) \{
91       file = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }KArchiveFile*\textcolor{keyword}{>}( imagesDirectory->entry( imagesEntries[ i ] ) );
92       QString fullPath = QString( \textcolor{stringliteral}{"Pictures/%1"} ).arg( imagesEntries[ i ] );
93       \textcolor{keywordflow}{if} ( mManifest->\hyperlink{classOOO_1_1Manifest_ad4dc3e80fccd7589b98d47824154df15}{testIfEncrypted}( fullPath ) ) \{
94         mImages.insert( fullPath, mManifest->\hyperlink{classOOO_1_1Manifest_a5e88bb8ac85d60ed396a295cc7d2933f}{decryptFile}( fullPath, file->data() ) );
95       \} \textcolor{keywordflow}{else} \{
96         mImages.insert( fullPath, file->data() );
97       \}
98     \}
99   \}
100 
101   zip.close();
102 
103   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
104 \}
\end{DoxyCode}
\hypertarget{classOOO_1_1Document_ac61a883d4055dc5e684ca26f6904e74b}{\index{O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}!styles@{styles}}
\index{styles@{styles}!O\+O\+O\+::\+Document@{O\+O\+O\+::\+Document}}
\subsubsection[{styles}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Byte\+Array Document\+::styles (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classOOO_1_1Document_ac61a883d4055dc5e684ca26f6904e74b}


Definition at line 126 of file document.\+cpp.


\begin{DoxyCode}
127 \{
128   \textcolor{keywordflow}{return} mStyles;
129 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
generators/ooo/\hyperlink{generators_2ooo_2document_8h}{document.\+h}\item 
generators/ooo/\hyperlink{generators_2ooo_2document_8cpp}{document.\+cpp}\end{DoxyCompactItemize}
