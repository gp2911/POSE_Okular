\hypertarget{classPolyLineEngine}{\section{Poly\+Line\+Engine Class Reference}
\label{classPolyLineEngine}\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}}
}


\hyperlink{classPolyLineEngine}{Poly\+Line\+Engine}.  


Inheritance diagram for Poly\+Line\+Engine\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classPolyLineEngine}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPolyLineEngine_a07ffb1f3ce4b55915df6b8641a634761}{Poly\+Line\+Engine} (const Q\+Dom\+Element \&engine\+Element)
\item 
Q\+Rect \hyperlink{classPolyLineEngine_a822e6058b9e407228c83298678d3aa94}{event} (\hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133}{Event\+Type} type, \hyperlink{classAnnotatorEngine_ac2e3b75e12bacbb6974d15dd53954567}{Button} button, double n\+X, double n\+Y, double x\+Scale, double y\+Scale, const \hyperlink{classOkular_1_1Page}{Okular\+::\+Page} $\ast$)
\item 
void \hyperlink{classPolyLineEngine_ae2399ba29c9bc734ffe53db0310e54bd}{paint} (Q\+Painter $\ast$painter, double x\+Scale, double y\+Scale, const Q\+Rect \&)
\item 
\hyperlink{classQList}{Q\+List}$<$ \hyperlink{classOkular_1_1Annotation}{Okular\+::\+Annotation} $\ast$ $>$ \hyperlink{classPolyLineEngine_ac5d84e9165cd9ab117d161aa935d102e}{end} ()
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\hyperlink{classPolyLineEngine}{Poly\+Line\+Engine}. 

Definition at line 310 of file pageviewannotator.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classPolyLineEngine_a07ffb1f3ce4b55915df6b8641a634761}{\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}!Poly\+Line\+Engine@{Poly\+Line\+Engine}}
\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}!Poly\+Line\+Engine@{Poly\+Line\+Engine}}
\subsubsection[{Poly\+Line\+Engine}]{\setlength{\rightskip}{0pt plus 5cm}Poly\+Line\+Engine\+::\+Poly\+Line\+Engine (
\begin{DoxyParamCaption}
\item[{const Q\+Dom\+Element \&}]{engine\+Element}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classPolyLineEngine_a07ffb1f3ce4b55915df6b8641a634761}


Definition at line 313 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
314             : \hyperlink{classAnnotatorEngine_a42302fe858494d3e3ad90b8607c543ef}{AnnotatorEngine}( engineElement ), last( \textcolor{keyword}{false} )
315         \{
316             \textcolor{comment}{// parse engine specific attributes}
317             m\_block = engineElement.attribute( \textcolor{stringliteral}{"block"} ) == \textcolor{stringliteral}{"true"};
318             \textcolor{keywordtype}{bool} ok = \textcolor{keyword}{true};
319             \textcolor{comment}{// numofpoints represents the max number of points for the current}
320             \textcolor{comment}{// polygon/polyline, with a pair of exceptions:}
321             \textcolor{comment}{// -1 means: the polyline must close on the first point (polygon)}
322             \textcolor{comment}{// 0 means: construct as many points as you want, right-click}
323             \textcolor{comment}{//   to construct the last point}
324             numofpoints = engineElement.attribute( \textcolor{stringliteral}{"points"} ).toInt( &ok );
325             \textcolor{keywordflow}{if} ( !ok )
326                 numofpoints = -1;
327         \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classPolyLineEngine_ac5d84e9165cd9ab117d161aa935d102e}{\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}!end@{end}}
\index{end@{end}!Poly\+Line\+Engine@{Poly\+Line\+Engine}}
\subsubsection[{end}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Q\+List}$<$ {\bf Okular\+::\+Annotation}$\ast$ $>$ Poly\+Line\+Engine\+::end (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPolyLineEngine_ac5d84e9165cd9ab117d161aa935d102e}


Implements \hyperlink{classAnnotatorEngine_a50455740303878b891195132df27a2ab}{Annotator\+Engine}.



Definition at line 406 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
407         \{
408             \hyperlink{classAnnotatorEngine_a0df119b4d87a1e3ea8ed60a96d7ff444}{m\_creationCompleted} = \textcolor{keyword}{false};
409 
410             \textcolor{comment}{// find out annotation's description node}
411             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.isNull() )
412                 \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}();
413 
414             \textcolor{comment}{// find out annotation's type}
415             \hyperlink{classOkular_1_1Annotation}{Okular::Annotation} * ann = 0;
416             \textcolor{keyword}{const} QString typeString = \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"type"} );
417 
418             \textcolor{comment}{// create LineAnnotation from path}
419             \textcolor{keywordflow}{if} ( typeString == \textcolor{stringliteral}{"Line"} || typeString == \textcolor{stringliteral}{"Polyline"} || typeString == \textcolor{stringliteral}{"Polygon"} )
420             \{
421                 \textcolor{keywordflow}{if} ( points.count() < 2 )
422                     \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}();
423 
424                 \textcolor{comment}{//add note}
425                 \hyperlink{classOkular_1_1LineAnnotation}{Okular::LineAnnotation} * la = \textcolor{keyword}{new} 
      \hyperlink{classOkular_1_1LineAnnotation}{Okular::LineAnnotation}();
426                 ann = la;
427                 \hyperlink{classQLinkedList}{QLinkedList<Okular::NormalizedPoint>} list;
428                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < points.count(); ++i )
429                     list.append( points[ i ] );
430 
431                 la->\hyperlink{classOkular_1_1LineAnnotation_a8d55187d06930ee5abe8cb0737826b9e}{setLinePoints}( list );
432 
433                 \textcolor{keywordflow}{if} ( numofpoints == -1 )
434                 \{
435                     la->\hyperlink{classOkular_1_1LineAnnotation_a7a48ad13b37252c75d3bbab59393a941}{setLineClosed}( \textcolor{keyword}{true} );
436                     \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"innerColor"} ) )
437                         la->\hyperlink{classOkular_1_1LineAnnotation_ae5959ad2b144411d304ff790805f65ab}{setLineInnerColor}( QColor( 
      \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"innerColor"} ) ) );
438                 \}
439                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( numofpoints == 2 )
440                 \{
441                     \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"leadFwd"} ) )
442                         la->\hyperlink{classOkular_1_1LineAnnotation_ae91d934170b3ffd0b488c6a646a31e4e}{setLineLeadingForwardPoint}( 
      \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"leadFwd"} ).toDouble() );
443                     \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"leadBack"} ) )
444                         la->\hyperlink{classOkular_1_1LineAnnotation_a1990502f6bd88b4c95955003ce7af9b0}{setLineLeadingBackwardPoint}( 
      \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"leadBack"} ).toDouble() );
445                 \}
446 
447                 la->\hyperlink{classOkular_1_1Annotation_a6977075c78f130b71ddbbda924480f38}{setBoundingRectangle}( normRect );
448 
449             \}
450 
451             \textcolor{comment}{// safety check}
452             \textcolor{keywordflow}{if} ( !ann )
453                 \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}();
454 
455             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"width"} ) )
456                 ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_af0643b15b59d282c196f0c6114493d9e}{setWidth}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"width"} ).
      toDouble() );
457 
458             \textcolor{comment}{// set common attributes}
459             ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_a1c916cd50a0a4114188136d47943ef00}{setColor}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"color"} ) ?
460                     \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"color"} ) : 
      \hyperlink{classAnnotatorEngine_a8911b0455be7eedfb2c102ce19acdce2}{m\_engineColor} );
461             \textcolor{keywordflow}{if} ( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.hasAttribute( \textcolor{stringliteral}{"opacity"} ) )
462                 ann->\hyperlink{classOkular_1_1Annotation_ae1f845ddbd6d524b2b388c6c9ef26423}{style}().\hyperlink{classOkular_1_1Annotation_1_1Style_a5bf0bdd3bf954271ed4ba831316a7ee7}{setOpacity}( \hyperlink{classAnnotatorEngine_ac95af6291cc2f0c601e1bbf8a5e6a0bd}{m\_annotElement}.attribute( \textcolor{stringliteral}{"opacity"}, \textcolor{stringliteral}{
      "1.0"} ).toDouble() );
463             \textcolor{comment}{// return annotation}
464 
465             \textcolor{keywordflow}{return} \hyperlink{classQList}{QList< Okular::Annotation* >}() << ann;
466         \}
\end{DoxyCode}
\hypertarget{classPolyLineEngine_a822e6058b9e407228c83298678d3aa94}{\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}!event@{event}}
\index{event@{event}!Poly\+Line\+Engine@{Poly\+Line\+Engine}}
\subsubsection[{event}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Rect Poly\+Line\+Engine\+::event (
\begin{DoxyParamCaption}
\item[{{\bf Event\+Type}}]{type, }
\item[{{\bf Button}}]{button, }
\item[{double}]{n\+X, }
\item[{double}]{n\+Y, }
\item[{double}]{x\+Scale, }
\item[{double}]{y\+Scale, }
\item[{const {\bf Okular\+::\+Page} $\ast$}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPolyLineEngine_a822e6058b9e407228c83298678d3aa94}


Implements \hyperlink{classAnnotatorEngine_acca989fc60f9a6c20ed2518fafa8774e}{Annotator\+Engine}.



Definition at line 329 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
330         \{
331             \textcolor{comment}{// only proceed if pressing left button}
332 \textcolor{comment}{//            if ( button != Left )}
333 \textcolor{comment}{//                return rect;}
334 
335             \textcolor{comment}{// start operation}
336             \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133a7f6f77a85d31dc6afd375db9a53d5069}{Press} )
337             \{
338                 newPoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} = nX;
339                 newPoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} = nY;
340                 \textcolor{keywordflow}{if} ( button == \hyperlink{classAnnotatorEngine_ac2e3b75e12bacbb6974d15dd53954567a8c25b27f7e32e09ea9767d465de328a9}{Right} )
341                     last = \textcolor{keyword}{true};
342             \}
343             \textcolor{comment}{// move the second point}
344             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133a4efcf099c4a82b1eab7de0fb124563a8}{Move} )
345             \{
346                 movingpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} = nX;
347                 movingpoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} = nY;
348                 \textcolor{keyword}{const} QRect oldmovingrect = movingrect;
349                 movingrect = rect | QRect( (\textcolor{keywordtype}{int})( movingpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} * xScale ), (\textcolor{keywordtype}{int})( movingpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} * yScale ), 1, 1 );
350                 \textcolor{keywordflow}{return} oldmovingrect | movingrect;
351             \}
352             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( type == \hyperlink{classAnnotatorEngine_a00fb22eb4cb6eafb056f9066031db133ac80dbad38d0461d9e546aa694c2abc1c}{Release} )
353             \{
354                 \textcolor{keyword}{const} \hyperlink{classOkular_1_1NormalizedPoint}{Okular::NormalizedPoint} tmppoint(nX, nY);
355                 \textcolor{keywordflow}{if} ( fabs( tmppoint.x - newPoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ) + fabs( tmppoint.y - newPoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ) > 1e-2 )
356                     \textcolor{keywordflow}{return} rect;
357 
358                 \textcolor{keywordflow}{if} ( numofpoints == -1 && points.count() > 1 && ( fabs( points[0].x - newPoint.
      \hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} ) + fabs( points[0].y - newPoint.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} ) < 1e-2 ) )
359                 \{
360                     last = \textcolor{keyword}{true};
361                 \}
362                 \textcolor{keywordflow}{else}
363                 \{
364                     points.append( newPoint );
365                     rect |= QRect( (\textcolor{keywordtype}{int})( newPoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} * xScale ), (\textcolor{keywordtype}{int})( newPoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} * yScale ), 1, 1 );
366                 \}
367                 \textcolor{comment}{// end creation if we have constructed the last point of enough points}
368                 \textcolor{keywordflow}{if} ( last || points.count() == numofpoints )
369                 \{
370                     \hyperlink{classAnnotatorEngine_a0df119b4d87a1e3ea8ed60a96d7ff444}{m\_creationCompleted} = \textcolor{keyword}{true};
371                     last = \textcolor{keyword}{false};
372                     normRect = \hyperlink{classOkular_1_1NormalizedRect}{Okular::NormalizedRect}( rect, xScale, yScale );
373                 \}
374             \}
375 
376             \textcolor{keywordflow}{return} rect;
377         \}
\end{DoxyCode}
\hypertarget{classPolyLineEngine_ae2399ba29c9bc734ffe53db0310e54bd}{\index{Poly\+Line\+Engine@{Poly\+Line\+Engine}!paint@{paint}}
\index{paint@{paint}!Poly\+Line\+Engine@{Poly\+Line\+Engine}}
\subsubsection[{paint}]{\setlength{\rightskip}{0pt plus 5cm}void Poly\+Line\+Engine\+::paint (
\begin{DoxyParamCaption}
\item[{Q\+Painter $\ast$}]{painter, }
\item[{double}]{x\+Scale, }
\item[{double}]{y\+Scale, }
\item[{const Q\+Rect \&}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{classPolyLineEngine_ae2399ba29c9bc734ffe53db0310e54bd}


Implements \hyperlink{classAnnotatorEngine_a71b2e9fcbcca36caadefa79adb99c93f}{Annotator\+Engine}.



Definition at line 379 of file pageviewannotator.\+cpp.


\begin{DoxyCode}
380         \{
381             \textcolor{keywordflow}{if} ( points.count() < 1 )
382                 \textcolor{keywordflow}{return};
383 
384             \textcolor{keywordflow}{if} ( m\_block && points.count() == 2 )
385             \{
386                 \textcolor{keyword}{const} \hyperlink{classOkular_1_1NormalizedPoint}{Okular::NormalizedPoint} first = points[0];
387                 \textcolor{keyword}{const} \hyperlink{classOkular_1_1NormalizedPoint}{Okular::NormalizedPoint} second = points[1];
388                 \textcolor{comment}{// draw a semitransparent block around the 2 points}
389                 painter->setPen( \hyperlink{classAnnotatorEngine_a8911b0455be7eedfb2c102ce19acdce2}{m\_engineColor} );
390                 painter->setBrush( QBrush( \hyperlink{classAnnotatorEngine_a8911b0455be7eedfb2c102ce19acdce2}{m\_engineColor}.light(), Qt::Dense4Pattern ) );
391                 painter->drawRect( (\textcolor{keywordtype}{int})(first.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} * (\textcolor{keywordtype}{double})xScale), (\textcolor{keywordtype}{int})(first.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} * (\textcolor{keywordtype}{double})yScale),
392                                    (\textcolor{keywordtype}{int})((second.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} - first.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x}) * (\textcolor{keywordtype}{double})xScale), (\textcolor{keywordtype}{int})((second.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} - first.\hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y}) * (\textcolor{keywordtype}{double})yScale) );
393             \}
394             \textcolor{keywordflow}{else}
395             \{
396                 \textcolor{comment}{// draw a polyline that connects the constructed points}
397                 painter->setPen( QPen( \hyperlink{classAnnotatorEngine_a8911b0455be7eedfb2c102ce19acdce2}{m\_engineColor}, 2 ) );
398                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 1; i < points.count(); ++i )
399                     painter->drawLine( (\textcolor{keywordtype}{int})(points[i - 1].x * (\textcolor{keywordtype}{double})xScale), (\textcolor{keywordtype}{int})(points[i - 1].y * (\textcolor{keywordtype}{
      double})yScale),
400                                        (\textcolor{keywordtype}{int})(points[i].x * (\textcolor{keywordtype}{double})xScale), (\textcolor{keywordtype}{int})(points[i].y * (\textcolor{keywordtype}{double})
      yScale) );
401                 painter->drawLine( (\textcolor{keywordtype}{int})(points.last().x * (double)xScale), (int)(points.last().y * (double
      )yScale),
402                                    (int)(movingpoint.\hyperlink{classOkular_1_1NormalizedPoint_a857f49b9bc7712430d167472ef9dbd94}{x} * (\textcolor{keywordtype}{double})xScale), (\textcolor{keywordtype}{int})(movingpoint.
      \hyperlink{classOkular_1_1NormalizedPoint_ac2276daabda627d5f82bb1532c293047}{y} * (double)yScale) );
403             \}
404         \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
ui/\hyperlink{pageviewannotator_8cpp}{pageviewannotator.\+cpp}\end{DoxyCompactItemize}
