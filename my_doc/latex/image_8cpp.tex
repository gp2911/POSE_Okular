\hypertarget{image_8cpp}{\section{generators/plucker/unpluck/image.cpp File Reference}
\label{image_8cpp}\index{generators/plucker/unpluck/image.\+cpp@{generators/plucker/unpluck/image.\+cpp}}
}
{\ttfamily \#include $<$Qt\+Core/\+Q\+Temporary\+File$>$}\\*
{\ttfamily \#include $<$Qt\+Gui/\+Q\+Image$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include \char`\"{}jpeglib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}unpluck.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}image.\+h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structColorMapEntry}{Color\+Map\+Entry}
\item 
struct \hyperlink{structPALMPIX}{P\+A\+L\+M\+P\+I\+X}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{image_8cpp_a2bcba5db1d1eed615040166fb0cb9700}{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E}(x)~(((x)$>$$>$3) \& 0x1\+F)
\item 
\#define \hyperlink{image_8cpp_a673235b41eb2d4b046765b40b79e0679}{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N}(x)~((x) \& 0x7)
\item 
\#define \hyperlink{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}{C\+E\+L\+L\+S}(row, col)~cells\mbox{[}row$\ast$cols+col\mbox{]}
\item 
\#define \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T}(p)~(((p)\mbox{[}0\mbox{]} $<$$<$ 8)$\vert$((p)\mbox{[}1\mbox{]}))
\item 
\#define \hyperlink{image_8cpp_aa8b20ddec6246d14b8a353de6039f535}{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G}(p)~(((p)\mbox{[}0\mbox{]} $<$$<$ 24)$\vert$((p)\mbox{[}1\mbox{]} $<$$<$ 16)$\vert$((p)\mbox{[}2\mbox{]} $<$$<$ 8)$\vert$((p)\mbox{[}3\mbox{]}))
\item 
\#define \hyperlink{image_8cpp_a3ae67e0e27c41a598008c39ae91fd6bd}{P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G}~0x8000
\item 
\#define \hyperlink{image_8cpp_af650f3cea41e57f116130247fca6ba25}{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G}~0x4000
\item 
\#define \hyperlink{image_8cpp_a52c4867e627a2252e418ba70e2ec10b1}{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G}~0x2000
\item 
\#define \hyperlink{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}{P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G}~0x0400
\item 
\#define \hyperlink{image_8cpp_a9671c0a28bd8b654e94eefcdb18f3f4d}{P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G}~0x0200
\item 
\#define \hyperlink{image_8cpp_a25045c8b0122e892ab5266d998c161fc}{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E}~0x00
\item 
\#define \hyperlink{image_8cpp_aa0f9bd6c4cb0bd6ce5bd6b18c5418373}{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E}~0x01
\item 
\#define \hyperlink{image_8cpp_a2178387b811d93cb29add5c8142a9883}{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S}~0x02
\item 
\#define \hyperlink{image_8cpp_a09fa0c328fdd244095a6dfba5ee82975}{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E}~0x\+F\+F
\item 
\#define \hyperlink{image_8cpp_a23911563879fb8db9c76f3c9cc133e9c}{P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E}~232
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{image_8cpp_a9a90740d6471f1857cb46a88798ddfc6}{Transcribe\+Palm\+Image\+To\+J\+P\+E\+G} (unsigned char $\ast$image\+\_\+bytes\+\_\+in, Q\+Image \&image)
\item 
bool \hyperlink{image_8cpp_a9f87bc1b3987360442352d2d510c1c26}{Transcribe\+Multi\+Image\+Record} (\hyperlink{unpluck_8h_a693dc907f8df7998a38f41a4e3512e2c}{plkr\+\_\+\+Document} $\ast$doc, Q\+Image \&image, unsigned char $\ast$bytes)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}{\index{image.\+cpp@{image.\+cpp}!C\+E\+L\+L\+S@{C\+E\+L\+L\+S}}
\index{C\+E\+L\+L\+S@{C\+E\+L\+L\+S}!image.\+cpp@{image.\+cpp}}
\subsubsection[{C\+E\+L\+L\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+E\+L\+L\+S(
\begin{DoxyParamCaption}
\item[{}]{row, }
\item[{}]{col}
\end{DoxyParamCaption}
)~cells\mbox{[}row$\ast$cols+col\mbox{]}}}\label{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}


Definition at line 29 of file image.\+cpp.

\hypertarget{image_8cpp_a673235b41eb2d4b046765b40b79e0679}{\index{image.\+cpp@{image.\+cpp}!G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N@{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N}}
\index{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N@{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N}!image.\+cpp@{image.\+cpp}}
\subsubsection[{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+D\+A\+T\+A\+L\+E\+N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~((x) \& 0x7)}}\label{image_8cpp_a673235b41eb2d4b046765b40b79e0679}


Definition at line 27 of file image.\+cpp.

\hypertarget{image_8cpp_a2bcba5db1d1eed615040166fb0cb9700}{\index{image.\+cpp@{image.\+cpp}!G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E@{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E}}
\index{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E@{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E}!image.\+cpp@{image.\+cpp}}
\subsubsection[{G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+E\+T\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+C\+O\+D\+E\+\_\+\+T\+Y\+P\+E(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~(((x)$>$$>$3) \& 0x1\+F)}}\label{image_8cpp_a2bcba5db1d1eed615040166fb0cb9700}


Definition at line 26 of file image.\+cpp.

\hypertarget{image_8cpp_a9671c0a28bd8b654e94eefcdb18f3f4d}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+4\+\_\+\+B\+Y\+T\+E\+\_\+\+F\+I\+E\+L\+D\+\_\+\+F\+L\+A\+G~0x0200}}\label{image_8cpp_a9671c0a28bd8b654e94eefcdb18f3f4d}


Definition at line 46 of file image.\+cpp.

\hypertarget{image_8cpp_a23911563879fb8db9c76f3c9cc133e9c}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E@{P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E}}
\index{P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E@{P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+S\+I\+Z\+E~232}}\label{image_8cpp_a23911563879fb8db9c76f3c9cc133e9c}


Definition at line 53 of file image.\+cpp.

\hypertarget{image_8cpp_a09fa0c328fdd244095a6dfba5ee82975}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E}}
\index{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+N\+O\+N\+E~0x\+F\+F}}\label{image_8cpp_a09fa0c328fdd244095a6dfba5ee82975}


Definition at line 51 of file image.\+cpp.

\hypertarget{image_8cpp_a2178387b811d93cb29add5c8142a9883}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S}}
\index{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+P\+A\+C\+K\+B\+I\+T\+S~0x02}}\label{image_8cpp_a2178387b811d93cb29add5c8142a9883}


Definition at line 50 of file image.\+cpp.

\hypertarget{image_8cpp_aa0f9bd6c4cb0bd6ce5bd6b18c5418373}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E}}
\index{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+R\+L\+E~0x01}}\label{image_8cpp_aa0f9bd6c4cb0bd6ce5bd6b18c5418373}


Definition at line 49 of file image.\+cpp.

\hypertarget{image_8cpp_a25045c8b0122e892ab5266d998c161fc}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E}}
\index{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E@{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+S\+C\+A\+N\+L\+I\+N\+E~0x00}}\label{image_8cpp_a25045c8b0122e892ab5266d998c161fc}


Definition at line 48 of file image.\+cpp.

\hypertarget{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+L\+A\+G~0x0400}}\label{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}


Definition at line 45 of file image.\+cpp.

\hypertarget{image_8cpp_af650f3cea41e57f116130247fca6ba25}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+C\+O\+L\+O\+R\+M\+A\+P\+\_\+\+F\+L\+A\+G~0x4000}}\label{image_8cpp_af650f3cea41e57f116130247fca6ba25}


Definition at line 43 of file image.\+cpp.

\hypertarget{image_8cpp_a52c4867e627a2252e418ba70e2ec10b1}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+H\+A\+S\+\_\+\+T\+R\+A\+N\+S\+P\+A\+R\+E\+N\+C\+Y\+\_\+\+F\+L\+A\+G~0x2000}}\label{image_8cpp_a52c4867e627a2252e418ba70e2ec10b1}


Definition at line 44 of file image.\+cpp.

\hypertarget{image_8cpp_a3ae67e0e27c41a598008c39ae91fd6bd}{\index{image.\+cpp@{image.\+cpp}!P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G@{P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+L\+M\+\_\+\+I\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+E\+D\+\_\+\+F\+L\+A\+G~0x8000}}\label{image_8cpp_a3ae67e0e27c41a598008c39ae91fd6bd}


Definition at line 42 of file image.\+cpp.

\hypertarget{image_8cpp_aa8b20ddec6246d14b8a353de6039f535}{\index{image.\+cpp@{image.\+cpp}!R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G@{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G}}
\index{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G@{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+L\+O\+N\+G(
\begin{DoxyParamCaption}
\item[{}]{p}
\end{DoxyParamCaption}
)~(((p)\mbox{[}0\mbox{]} $<$$<$ 24)$\vert$((p)\mbox{[}1\mbox{]} $<$$<$ 16)$\vert$((p)\mbox{[}2\mbox{]} $<$$<$ 8)$\vert$((p)\mbox{[}3\mbox{]}))}}\label{image_8cpp_aa8b20ddec6246d14b8a353de6039f535}


Definition at line 40 of file image.\+cpp.

\hypertarget{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{\index{image.\+cpp@{image.\+cpp}!R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T@{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T}}
\index{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T@{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T}!image.\+cpp@{image.\+cpp}}
\subsubsection[{R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+E\+A\+D\+\_\+\+B\+I\+G\+E\+N\+D\+I\+A\+N\+\_\+\+S\+H\+O\+R\+T(
\begin{DoxyParamCaption}
\item[{}]{p}
\end{DoxyParamCaption}
)~(((p)\mbox{[}0\mbox{]} $<$$<$ 8)$\vert$((p)\mbox{[}1\mbox{]}))}}\label{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}


Definition at line 39 of file image.\+cpp.



\subsection{Function Documentation}
\hypertarget{image_8cpp_a9f87bc1b3987360442352d2d510c1c26}{\index{image.\+cpp@{image.\+cpp}!Transcribe\+Multi\+Image\+Record@{Transcribe\+Multi\+Image\+Record}}
\index{Transcribe\+Multi\+Image\+Record@{Transcribe\+Multi\+Image\+Record}!image.\+cpp@{image.\+cpp}}
\subsubsection[{Transcribe\+Multi\+Image\+Record}]{\setlength{\rightskip}{0pt plus 5cm}bool Transcribe\+Multi\+Image\+Record (
\begin{DoxyParamCaption}
\item[{{\bf plkr\+\_\+\+Document} $\ast$}]{doc, }
\item[{Q\+Image \&}]{image, }
\item[{unsigned char $\ast$}]{bytes}
\end{DoxyParamCaption}
)}}\label{image_8cpp_a9f87bc1b3987360442352d2d510c1c26}


Definition at line 403 of file image.\+cpp.


\begin{DoxyCode}
408 \{
409     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*       pbytes = 0;
410     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*       outbytes = 0;
411     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*       outptr = 0;
412     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*       ptr = &bytes[12];
413     \hyperlink{unpluck_8h_a2d3cdee2c160741b8a217b97e14b08b4}{plkr\_DataRecordType}  ptype;
414     \hyperlink{structPALMPIX}{PALMPIX}*             cells = 0;
415     \hyperlink{structPALMPIX}{PALMPIX}*             acell = 0;
416     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         record\_id = 0;
417              \textcolor{keywordtype}{int}         plen = 0;
418     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         x = 0;
419     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         y = 0;
420     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         cols = 0;
421     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         rows = 0;
422     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         width = 0;
423     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         height = 0;
424     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         bytes\_per\_row = 0;
425     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         flags = 0;
426     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         bits\_per\_pixel = 0;
427     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         version = 0;
428     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         transparent\_index = 0;
429     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         compression\_type = 0;
430     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         palm\_red\_bits = 0;
431     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         palm\_green\_bits = 0;
432     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         palm\_blue\_bits = 0;
433     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         outlen = 0;
434     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}         offset = 0;
435     \textcolor{keywordtype}{bool}                 status = \textcolor{keyword}{true};
436 
437     cols = (bytes[8] << 8) + bytes[9];
438     rows = (bytes[10] << 8) + bytes[11];
439 
440     cells = (\hyperlink{structPALMPIX}{PALMPIX} *) calloc (cols * rows, \textcolor{keyword}{sizeof} (\hyperlink{structPALMPIX}{PALMPIX}));
441 
442     height = 0;
443     \textcolor{keywordflow}{for} (y = 0; y < rows; y++) \{
444         width = 0;
445         bytes\_per\_row = 0;
446         \textcolor{keywordflow}{for} (x = 0; x < cols; x++) \{
447             acell = &\hyperlink{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}{CELLS} (y, x);
448             record\_id = (ptr[0] << 8) + ptr[1];
449             ptr += 2;
450             pbytes = \hyperlink{unpluck_8cpp_adbedc945ce6c9be1f34fd5cd770a3b24}{plkr\_GetRecordBytes} (doc, record\_id, &plen, &ptype);
451             \textcolor{keywordflow}{if} (pbytes == NULL) \{
452                 free (cells);
453                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
454             \}
455 
456             pbytes += 8;
457             acell->\hyperlink{structPALMPIX_a3c919d9d9bdf0bfdf67c7eb1f2c5a394}{width} = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (&pbytes[0]);
458             width += acell->\hyperlink{structPALMPIX_a3c919d9d9bdf0bfdf67c7eb1f2c5a394}{width};
459             acell->\hyperlink{structPALMPIX_aeb2458e16e733418d1897ea577f539df}{height} = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (&pbytes[2]);
460             acell->\hyperlink{structPALMPIX_af1a24f1ea6245a31aaba0a247f5f9488}{bytes\_per\_row} = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (&pbytes[4]);
461             bytes\_per\_row += acell->\hyperlink{structPALMPIX_af1a24f1ea6245a31aaba0a247f5f9488}{bytes\_per\_row};
462             acell->\hyperlink{structPALMPIX_a7159c9ddf91b7e3c6300e4100adbd6e5}{flags} = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (&pbytes[6]);
463             flags = acell->\hyperlink{structPALMPIX_a7159c9ddf91b7e3c6300e4100adbd6e5}{flags};
464             acell->\hyperlink{structPALMPIX_aa3505215b23213464cbdd7058e906571}{bits\_per\_pixel} = pbytes[8];
465             bits\_per\_pixel = acell->\hyperlink{structPALMPIX_aa3505215b23213464cbdd7058e906571}{bits\_per\_pixel};
466             acell->\hyperlink{structPALMPIX_a888fae9071575df1390d9dd301539f1f}{version} = pbytes[9];
467             version = acell->\hyperlink{structPALMPIX_a888fae9071575df1390d9dd301539f1f}{version};
468             acell->\hyperlink{structPALMPIX_a53bf150bd435a6aeadff69c8d025266d}{next\_depth\_offset} = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (&pbytes[1
      0]);
469             acell->\hyperlink{structPALMPIX_a991dabc462c6bb8c229d5c6f2789a9ea}{transparent\_index} = pbytes[12];
470             transparent\_index = acell->\hyperlink{structPALMPIX_a991dabc462c6bb8c229d5c6f2789a9ea}{transparent\_index};
471             acell->\hyperlink{structPALMPIX_a465da1cce6c60b201fcb17d48f793f79}{compression\_type} = pbytes[13];
472             compression\_type = acell->\hyperlink{structPALMPIX_a465da1cce6c60b201fcb17d48f793f79}{compression\_type};
473 
474             \textcolor{keywordflow}{if} (acell->\hyperlink{structPALMPIX_a7159c9ddf91b7e3c6300e4100adbd6e5}{flags} & \hyperlink{image_8cpp_af650f3cea41e57f116130247fca6ba25}{PALM\_HAS\_COLORMAP\_FLAG}) \{
475                 free (cells);
476                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
477             \}
478 
479             acell->\hyperlink{structPALMPIX_a5830c51eb001f0889defa52bb7e540c2}{bytes} = pbytes + 16;
480             offset = 16;
481             \textcolor{keywordflow}{if} (acell->\hyperlink{structPALMPIX_aa3505215b23213464cbdd7058e906571}{bits\_per\_pixel} == 16
482                 && (acell->\hyperlink{structPALMPIX_a7159c9ddf91b7e3c6300e4100adbd6e5}{flags} & \hyperlink{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}{PALM\_DIRECT\_COLOR\_FLAG})) \{
483                 acell->\hyperlink{structPALMPIX_a6afa309bd0d1f0e02e300fd4f059d0fd}{palm\_red\_bits} = pbytes[16];
484                 palm\_red\_bits = acell->\hyperlink{structPALMPIX_a6afa309bd0d1f0e02e300fd4f059d0fd}{palm\_red\_bits};
485                 acell->\hyperlink{structPALMPIX_a3640472263931e77689b659a3bb030f8}{palm\_green\_bits} = pbytes[17];
486                 palm\_green\_bits = acell->\hyperlink{structPALMPIX_a3640472263931e77689b659a3bb030f8}{palm\_green\_bits};
487                 acell->\hyperlink{structPALMPIX_abd2f75ac5d479323c3c0998940b0f17a}{palm\_blue\_bits} = pbytes[18];
488                 palm\_blue\_bits = acell->\hyperlink{structPALMPIX_abd2f75ac5d479323c3c0998940b0f17a}{palm\_blue\_bits};
489                 acell->\hyperlink{structPALMPIX_a5830c51eb001f0889defa52bb7e540c2}{bytes} = pbytes + 24;
490                 offset = 24;
491             \}
492         \}
493         height += acell->\hyperlink{structPALMPIX_aeb2458e16e733418d1897ea577f539df}{height};
494     \}
495 
496     outlen = bytes\_per\_row * height + offset;
497     outbytes = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) malloc (outlen);
498     outptr = outbytes;
499 
500     *outptr++ = width >> 8;
501     *outptr++ = width;
502     *outptr++ = height >> 8;
503     *outptr++ = height;
504     *outptr++ = bytes\_per\_row >> 8;
505     *outptr++ = bytes\_per\_row;
506     *outptr++ = flags >> 8;
507     *outptr++ = flags;
508     *outptr++ = bits\_per\_pixel;
509     *outptr++ = version;
510     *outptr++ = 0;              \textcolor{comment}{/* next\_depth\_offset */}
511     *outptr++ = 0;
512     *outptr++ = transparent\_index;
513     *outptr++ = compression\_type;
514     *outptr++ = 0;
515     *outptr++ = 0;
516 
517     \textcolor{keywordflow}{if} (acell->\hyperlink{structPALMPIX_aa3505215b23213464cbdd7058e906571}{bits\_per\_pixel} == 16
518         && (acell->\hyperlink{structPALMPIX_a7159c9ddf91b7e3c6300e4100adbd6e5}{flags} & \hyperlink{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}{PALM\_DIRECT\_COLOR\_FLAG})) \{
519         *outptr++ = palm\_red\_bits;
520         *outptr++ = palm\_green\_bits;
521         *outptr++ = palm\_blue\_bits;
522         *outptr++ = 0;
523         *outptr++ = 0;
524         *outptr++ = 0;
525         *outptr++ = 0;
526         *outptr++ = 0;
527     \}
528 
529     \textcolor{keywordflow}{for} (y = 0; y < rows; y++) \{
530         \textcolor{keywordtype}{int}                   i, h;
531         acell = &\hyperlink{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}{CELLS} (y, 0);
532         h = acell->\hyperlink{structPALMPIX_aeb2458e16e733418d1897ea577f539df}{height};
533         \textcolor{keywordflow}{for} (i = 0; i < h; i++) \{
534             \textcolor{keywordflow}{for} (x = 0; x < cols; x++) \{
535                 acell = &\hyperlink{image_8cpp_a34ae1a8b5ea4397ab5f49420723716bc}{CELLS} (y, x);
536                 memcpy (outptr, acell->\hyperlink{structPALMPIX_a5830c51eb001f0889defa52bb7e540c2}{bytes}, acell->\hyperlink{structPALMPIX_af1a24f1ea6245a31aaba0a247f5f9488}{bytes\_per\_row});
537                 acell->\hyperlink{structPALMPIX_a5830c51eb001f0889defa52bb7e540c2}{bytes} += acell->\hyperlink{structPALMPIX_af1a24f1ea6245a31aaba0a247f5f9488}{bytes\_per\_row};
538                 outptr += acell->\hyperlink{structPALMPIX_af1a24f1ea6245a31aaba0a247f5f9488}{bytes\_per\_row};
539             \}
540         \}
541     \}
542 
543     status = \hyperlink{image_8cpp_a9a90740d6471f1857cb46a88798ddfc6}{TranscribePalmImageToJPEG} (outbytes, image);
544 
545     free (outbytes);
546     free (cells);
547 
548     \textcolor{keywordflow}{return} status;
549 \}
\end{DoxyCode}
\hypertarget{image_8cpp_a9a90740d6471f1857cb46a88798ddfc6}{\index{image.\+cpp@{image.\+cpp}!Transcribe\+Palm\+Image\+To\+J\+P\+E\+G@{Transcribe\+Palm\+Image\+To\+J\+P\+E\+G}}
\index{Transcribe\+Palm\+Image\+To\+J\+P\+E\+G@{Transcribe\+Palm\+Image\+To\+J\+P\+E\+G}!image.\+cpp@{image.\+cpp}}
\subsubsection[{Transcribe\+Palm\+Image\+To\+J\+P\+E\+G}]{\setlength{\rightskip}{0pt plus 5cm}bool Transcribe\+Palm\+Image\+To\+J\+P\+E\+G (
\begin{DoxyParamCaption}
\item[{unsigned char $\ast$}]{image\+\_\+bytes\+\_\+in, }
\item[{Q\+Image \&}]{image}
\end{DoxyParamCaption}
)}}\label{image_8cpp_a9a90740d6471f1857cb46a88798ddfc6}


Definition at line 143 of file image.\+cpp.


\begin{DoxyCode}
147 \{
148     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    width;
149     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    height;
150     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    bytes\_per\_row;
151     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    flags;
152     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    next\_depth\_offset;
153     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    bits\_per\_pixel;
154     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    version;
155     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    transparent\_index;
156     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    compression\_type;
157     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    i;
158     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    j;
159     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    inval;
160     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    inbit;
161     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    mask;
162     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    incount;
163     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    palm\_red\_bits = 0;
164     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    palm\_green\_bits = 0;
165     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    palm\_blue\_bits = 0;
166     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  palm\_ptr;
167     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  x\_ptr;
168     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  imagedata = 0;
169     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  inbyte;
170     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  rowbuf;
171     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  lastrow;
172     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  imagedatastart;
173     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*  palmimage;
174     \hyperlink{structColorMapEntry}{ColorMapEntry}  *colormap;
175 
176     JSAMPLE*                     jpeg\_row;
177     \textcolor{keyword}{struct }jpeg\_compress\_struct  cinfo;
178     \textcolor{keyword}{struct }jpeg\_error\_mgr        jerr;
179     JSAMPROW                     row\_pointer[1];\textcolor{comment}{/* pointer to JSAMPLE row[s] */}
180 
181     palmimage = image\_bytes\_in;
182     width = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (palmimage + 0);
183     height = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (palmimage + 2);
184     bytes\_per\_row = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (palmimage + 4);
185     flags = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (palmimage + 6);
186     bits\_per\_pixel = palmimage[8];
187     version = palmimage[9];
188     next\_depth\_offset = \hyperlink{image_8cpp_a756a14a5789fcc36b0978f3132708bc5}{READ\_BIGENDIAN\_SHORT} (palmimage + 10);
189     transparent\_index = palmimage[12];
190     compression\_type = palmimage[13];
191     \textcolor{comment}{/* bytes 14 and 15 are reserved by Palm and always 0 */}
192 
193     \textcolor{keywordflow}{if} (compression\_type == \hyperlink{image_8cpp_a2178387b811d93cb29add5c8142a9883}{PALM\_COMPRESSION\_PACKBITS}) \{
194         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
195     \}
196     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((compression\_type != \hyperlink{image_8cpp_a09fa0c328fdd244095a6dfba5ee82975}{PALM\_COMPRESSION\_NONE}) &&
197              (compression\_type != \hyperlink{image_8cpp_aa0f9bd6c4cb0bd6ce5bd6b18c5418373}{PALM\_COMPRESSION\_RLE}) &&
198              (compression\_type != \hyperlink{image_8cpp_a25045c8b0122e892ab5266d998c161fc}{PALM\_COMPRESSION\_SCANLINE})) \{
199         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
200     \}
201 
202     \textcolor{comment}{/* as of PalmOS 4.0, there are 6 different kinds of Palm pixmaps:}
203 \textcolor{comment}{}
204 \textcolor{comment}{       1, 2, or 4 bit grayscale}
205 \textcolor{comment}{       8-bit StaticColor using the Palm standard colormap}
206 \textcolor{comment}{       8-bit PseudoColor using a user-specified colormap}
207 \textcolor{comment}{       16-bit DirectColor using 5 bits for red, 6 for green, and 5 for blue}
208 \textcolor{comment}{}
209 \textcolor{comment}{       Each of these can be compressed with one of four compression schemes,}
210 \textcolor{comment}{       "RLE", "Scanline", "PackBits", or none.}
211 \textcolor{comment}{}
212 \textcolor{comment}{       We begin by constructing the colormap.}
213 \textcolor{comment}{     */}
214 
215     \textcolor{keywordflow}{if} (flags & \hyperlink{image_8cpp_af650f3cea41e57f116130247fca6ba25}{PALM\_HAS\_COLORMAP\_FLAG}) \{
216         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
217     \}
218     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits\_per\_pixel == 1) \{
219         colormap = Palm1BitColormap;
220         imagedatastart = palmimage + 16;
221     \}
222     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits\_per\_pixel == 2) \{
223         colormap = Palm2BitColormap;
224         imagedatastart = palmimage + 16;
225     \}
226     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits\_per\_pixel == 4) \{
227         colormap = Palm4BitColormap;
228         imagedatastart = palmimage + 16;
229     \}
230     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits\_per\_pixel == 8) \{
231         colormap = Palm8BitColormap;
232         imagedatastart = palmimage + 16;
233     \}
234     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits\_per\_pixel == 16 && (flags & \hyperlink{image_8cpp_afd4849e7ddc12d7eb95c7fd6f07ae934}{PALM\_DIRECT\_COLOR\_FLAG})) \{
235         colormap = NULL;
236         palm\_red\_bits = palmimage[16];
237         palm\_green\_bits = palmimage[17];
238         palm\_blue\_bits = palmimage[18];
239         \textcolor{keywordflow}{if} (palm\_blue\_bits > 8 || palm\_green\_bits > 8 || palm\_red\_bits > 8) \{
240             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
241         \}
242         \textcolor{keywordflow}{if} (bits\_per\_pixel > (8 * \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}))) \{
243             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
244         \}
245         imagedatastart = palmimage + 24;
246     \}
247     \textcolor{keywordflow}{else} \{
248         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
249     \}
250 
251     QTemporaryFile tempFile;
252     tempFile.open();
253     FILE *outfile = fopen( QFile::encodeName( tempFile.fileName() ), \textcolor{stringliteral}{"w"} );
254     \textcolor{keywordflow}{if} ( !outfile )
255       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
256 
257     \textcolor{comment}{/* now create the JPEG image row buffer */}
258     jpeg\_row = (JSAMPLE *) malloc (\textcolor{keyword}{sizeof} (JSAMPLE) * (width * 3));
259 
260     \textcolor{comment}{/* Use standard JPEG error processing */}
261     cinfo.err = jpeg\_std\_error (&jerr);
262     \textcolor{comment}{/* Initialize the JPEG compression object. */}
263     jpeg\_create\_compress (&cinfo);
264 
265     jpeg\_stdio\_dest (&cinfo, outfile);
266 
267     cinfo.image\_width = width;  \textcolor{comment}{/* image width and height, in pixels */}
268     cinfo.image\_height = height;
269     cinfo.input\_components = 3; \textcolor{comment}{/* # of color components per pixel */}
270     cinfo.in\_color\_space = JCS\_RGB;     \textcolor{comment}{/* colorspace of input image */}
271 
272     jpeg\_set\_defaults (&cinfo);
273     jpeg\_set\_quality (&cinfo, 100,
274                       \textcolor{keyword}{true} \textcolor{comment}{/* limit to baseline-JPEG values */} );
275 
276     row\_pointer[0] = &jpeg\_row[0];
277 
278     jpeg\_start\_compress (&cinfo, \textcolor{keyword}{true});
279 
280     \textcolor{comment}{/* row by row, uncompress the Palm image and copy it to the JPEG buffer */}
281     rowbuf = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) malloc (bytes\_per\_row * width);
282     lastrow = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) malloc (bytes\_per\_row * width);
283     \textcolor{keywordflow}{for} (i = 0, palm\_ptr = imagedatastart, x\_ptr = imagedata; i < height;
284          ++i) \{
285 
286         \textcolor{comment}{/* first, uncompress the Palm image */}
287         \textcolor{keywordflow}{if} ((flags & \hyperlink{image_8cpp_a3ae67e0e27c41a598008c39ae91fd6bd}{PALM\_IS\_COMPRESSED\_FLAG})
288             && (compression\_type == \hyperlink{image_8cpp_aa0f9bd6c4cb0bd6ce5bd6b18c5418373}{PALM\_COMPRESSION\_RLE})) \{
289             \textcolor{keywordflow}{for} (j = 0; j < bytes\_per\_row;) \{
290                 incount = *palm\_ptr++;
291                 inval = *palm\_ptr++;
292                 \textcolor{keywordflow}{if} (incount + j <= bytes\_per\_row  * width)
293                 \{
294                     memset (rowbuf + j, inval, incount);
295                     j += incount;
296                 \}
297                 \textcolor{keywordflow}{else}
298                 \{
299                     free (rowbuf);
300                     free (lastrow);
301                     free (jpeg\_row);
302 
303                     jpeg\_destroy\_compress (&cinfo);
304 
305                     fclose( outfile );
306 
307                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
308                 \}
309             \}
310         \}
311         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((flags & PALM\_IS\_COMPRESSED\_FLAG)
312                  && (compression\_type == \hyperlink{image_8cpp_a25045c8b0122e892ab5266d998c161fc}{PALM\_COMPRESSION\_SCANLINE})) \{
313             \textcolor{keywordflow}{for} (j = 0; j < bytes\_per\_row; j += 8) \{
314                 incount = *palm\_ptr++;
315                 inval =
316                     ((bytes\_per\_row - j) < 8) ? (bytes\_per\_row - j) : 8;
317                 \textcolor{keywordflow}{for} (inbit = 0; inbit < inval; inbit += 1) \{
318                     \textcolor{keywordflow}{if} (incount & (1 << (7 - inbit)))
319                         rowbuf[j + inbit] = *palm\_ptr++;
320                     \textcolor{keywordflow}{else}
321                         rowbuf[j + inbit] = lastrow[j + inbit];
322                 \}
323             \}
324             memcpy (lastrow, rowbuf, bytes\_per\_row);
325         \}
326         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((flags & PALM\_IS\_COMPRESSED\_FLAG) &&
327                   (compression\_type == \hyperlink{image_8cpp_a09fa0c328fdd244095a6dfba5ee82975}{PALM\_COMPRESSION\_NONE})) ||
328                  (flags & PALM\_IS\_COMPRESSED\_FLAG) == 0) \{
329             memcpy (rowbuf, palm\_ptr, bytes\_per\_row);
330             palm\_ptr += bytes\_per\_row;
331         \}
332 
333         \textcolor{comment}{/* next, write it to the GDK bitmap */}
334         \textcolor{keywordflow}{if} (colormap) \{
335             mask = (1 << bits\_per\_pixel) - 1;
336             \textcolor{keywordflow}{for} (inbit = 8 - bits\_per\_pixel, inbyte = rowbuf, j = 0;
337                  j < width; ++j) \{
338                 inval = ((*inbyte) & (mask << inbit)) >> inbit;
339                 \textcolor{comment}{/* correct for oddity of the 8-bit color Palm pixmap... */}
340                 \textcolor{keywordflow}{if} ((bits\_per\_pixel == 8) && (inval == 0xFF))
341                     inval = 231;
342                 \textcolor{comment}{/* now lookup the correct color and set the pixel in the GTK bitmap */}
343                 jpeg\_row[(j * 3) + 0] = colormap[inval].red;
344                 jpeg\_row[(j * 3) + 1] = colormap[inval].green;
345                 jpeg\_row[(j * 3) + 2] = colormap[inval].blue;
346                 \textcolor{keywordflow}{if} (!inbit) \{
347                     ++inbyte;
348                     inbit = 8 - bits\_per\_pixel;
349                 \}
350                 \textcolor{keywordflow}{else} \{
351                     inbit -= bits\_per\_pixel;
352                 \}
353             \}
354         \}
355         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!colormap && bits\_per\_pixel == 16) \{
356             \textcolor{keywordflow}{for} (inbyte = rowbuf, j = 0; j < width; ++j) \{
357                 inval = (inbyte[0] << 8) | inbyte[1];
358                 jpeg\_row[(j * 3) + 0] =
359                     (inval >> (bits\_per\_pixel - palm\_red\_bits)) &
360                     ((1 << palm\_red\_bits) - 1);
361                 jpeg\_row[(j * 3) + 1] =
362                     (inval >> palm\_blue\_bits) & ((1 << palm\_green\_bits) -
363                                                  1);
364                 jpeg\_row[(j * 3) + 2] =
365                     (inval >> 0) & ((1 << palm\_blue\_bits) - 1);
366                 inbyte += 2;
367             \}
368         \}
369 
370         (void) jpeg\_write\_scanlines (&cinfo, row\_pointer, 1);
371     \}
372 
373     free (rowbuf);
374     free (lastrow);
375     free (jpeg\_row);
376 
377     jpeg\_finish\_compress (&cinfo);
378     jpeg\_destroy\_compress (&cinfo);
379 
380     fclose( outfile );
381 
382     \textcolor{keywordflow}{return} image.load( tempFile.fileName() );
383 \}
\end{DoxyCode}
