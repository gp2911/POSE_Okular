\hypertarget{libchmfile__search_8cpp}{\section{generators/chm/lib/libchmfile\+\_\+search.cpp File Reference}
\label{libchmfile__search_8cpp}\index{generators/chm/lib/libchmfile\+\_\+search.\+cpp@{generators/chm/lib/libchmfile\+\_\+search.\+cpp}}
}
{\ttfamily \#include $<$qregexp.\+h$>$}\\*
{\ttfamily \#include \char`\"{}libchmfile.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}libchmfileimpl.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H}(A)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{libchmfile__search_8cpp_a17cc37a7460f0c55fa27f233e21f4f94}{search\+Phrase} (\hyperlink{classLCHMFileImpl}{L\+C\+H\+M\+File\+Impl} $\ast$impl, const Q\+String\+List \&phrase, \hyperlink{libchmfileimpl_8h_a49915bbafbeae4acb86601a1e4f0c247}{L\+C\+H\+M\+Search\+Progress\+Results} \&results)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{\index{libchmfile\+\_\+search.\+cpp@{libchmfile\+\_\+search.\+cpp}!D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H@{D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H}}
\index{D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H@{D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H}!libchmfile\+\_\+search.\+cpp@{libchmfile\+\_\+search.\+cpp}}
\subsubsection[{D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+B\+U\+G\+\_\+\+S\+E\+A\+R\+C\+H(
\begin{DoxyParamCaption}
\item[{}]{A}
\end{DoxyParamCaption}
)}}\label{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}


Definition at line 28 of file libchmfile\+\_\+search.\+cpp.



\subsection{Function Documentation}
\hypertarget{libchmfile__search_8cpp_a17cc37a7460f0c55fa27f233e21f4f94}{\index{libchmfile\+\_\+search.\+cpp@{libchmfile\+\_\+search.\+cpp}!search\+Phrase@{search\+Phrase}}
\index{search\+Phrase@{search\+Phrase}!libchmfile\+\_\+search.\+cpp@{libchmfile\+\_\+search.\+cpp}}
\subsubsection[{search\+Phrase}]{\setlength{\rightskip}{0pt plus 5cm}bool search\+Phrase (
\begin{DoxyParamCaption}
\item[{{\bf L\+C\+H\+M\+File\+Impl} $\ast$}]{impl, }
\item[{const Q\+String\+List \&}]{phrase, }
\item[{{\bf L\+C\+H\+M\+Search\+Progress\+Results} \&}]{results}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{libchmfile__search_8cpp_a17cc37a7460f0c55fa27f233e21f4f94}


Definition at line 119 of file libchmfile\+\_\+search.\+cpp.


\begin{DoxyCode}
120 \{
121     \textcolor{comment}{// Accumulate the phrase data here.}
122     \hyperlink{libchmfileimpl_8h_a49915bbafbeae4acb86601a1e4f0c247}{LCHMSearchProgressResults} phrasekeeper;
123 
124     \textcolor{comment}{// On the first word, just fill the phrasekeeper with every occupence of the first word}
125     \hyperlink{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{DEBUG\_SEARCH} ((\textcolor{stringliteral}{"Search word(0): '%s'"}, phrase[0].ascii()));
126     \textcolor{keywordflow}{if} ( !impl->\hyperlink{classLCHMFileImpl_aef2f435b859a816d543af610ed65316e}{searchWord} ( phrase[0], \textcolor{keyword}{true}, \textcolor{keyword}{false}, phrasekeeper, \textcolor{keyword}{true} ) )
127         \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \textcolor{comment}{// the word not found, so the whole phrase is not found either.}
128 
129     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 1; i < phrase.size(); i++ )
130     \{
131         \hyperlink{libchmfileimpl_8h_a49915bbafbeae4acb86601a1e4f0c247}{LCHMSearchProgressResults} srchtmp;
132 
133         \hyperlink{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{DEBUG\_SEARCH} ((\textcolor{stringliteral}{"Search word(%d): '%s'"}, i, phrase[i].ascii()));
134         \textcolor{keywordflow}{if} ( !impl->\hyperlink{classLCHMFileImpl_aef2f435b859a816d543af610ed65316e}{searchWord} ( phrase[i], \textcolor{keyword}{true}, \textcolor{keyword}{false}, srchtmp, \textcolor{keyword}{true} ) )
135             \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \textcolor{comment}{// the ith word not found, so the whole phrase is not found either.}
136 
137         \textcolor{comment}{// Iterate the both arrays, and remove every word in phrasekeeper, which is not found}
138         \textcolor{comment}{// in the srchtmp, or is found on a different position.}
139         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} p1 = 0; p1 < phrasekeeper.size(); p1++ )
140         \{
141             \textcolor{keywordtype}{bool} found = \textcolor{keyword}{false};
142             
143             \hyperlink{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{DEBUG\_SEARCH} ((\textcolor{stringliteral}{"Ext loop (it %d): urloff %d"}, p1, phrasekeeper[p1].urloff));
144             
145             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} p2 = 0; p2 < srchtmp.size(); p2++ )
146             \{
147                 \textcolor{comment}{// look up for words on the same page}
148                 \textcolor{keywordflow}{if} ( srchtmp[p2].urloff != phrasekeeper[p1].urloff )
149                     \textcolor{keywordflow}{continue};
150                 
151                 \textcolor{comment}{// Now check every offset to find the one which is 1 bigger than the }
152                 findNextWords ( phrasekeeper[p1].offsets, srchtmp[p2].offsets );
153                 
154                 \textcolor{comment}{// If at least one next word is found, we leave the block intact, otherwise remove it.}
155                 \textcolor{keywordflow}{if} ( !phrasekeeper[p1].offsets.empty() )
156                     found = \textcolor{keyword}{true};
157             \}
158             
159             \textcolor{keywordflow}{if} ( !found )
160             \{
161                 \hyperlink{libchmfile__search_8cpp_a50a394b23fb3594a26d032fea015fb0c}{DEBUG\_SEARCH} ((\textcolor{stringliteral}{"Ext loop: this word not found on %d, remove it"}, phrasekeeper[
      p1].urloff));
162                 phrasekeeper.erase ( phrasekeeper.begin() + p1 );
163                 p1--;
164             \}
165         \}
166     \}
167 
168     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} o = 0; o < phrasekeeper.size(); o++ )
169         results.push\_back ( \hyperlink{classLCHMSearchProgressResult}{LCHMSearchProgressResult} (phrasekeeper[o].titleoff, 
      phrasekeeper[o].urloff) );
170             
171     \textcolor{keywordflow}{return} !results.empty();
172 \}
\end{DoxyCode}
