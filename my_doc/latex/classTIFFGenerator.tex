\hypertarget{classTIFFGenerator}{\section{T\+I\+F\+F\+Generator Class Reference}
\label{classTIFFGenerator}\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
}


{\ttfamily \#include $<$generator\+\_\+tiff.\+h$>$}

Inheritance diagram for T\+I\+F\+F\+Generator\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classTIFFGenerator}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classTIFFGenerator_1_1Private}{Private}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classTIFFGenerator_a8a4fcd61f40954d1c17fd3b880fe230c}{T\+I\+F\+F\+Generator} (Q\+Object $\ast$parent, const Q\+Variant\+List \&args)
\item 
virtual \hyperlink{classTIFFGenerator_ae8a40ff2851a47625811c041a30d61af}{$\sim$\+T\+I\+F\+F\+Generator} ()
\item 
bool \hyperlink{classTIFFGenerator_aebdfa77295efd1f9310b750e284dac5b}{load\+Document} (const Q\+String \&file\+Name, Q\+Vector$<$ \hyperlink{classOkular_1_1Page}{Okular\+::\+Page} $\ast$ $>$ \&pages\+Vector)
\item 
bool \hyperlink{classTIFFGenerator_ab72ff71c466bd6f0e76ec6ffcc228106}{load\+Document\+From\+Data} (const Q\+Byte\+Array \&file\+Data, Q\+Vector$<$ \hyperlink{classOkular_1_1Page}{Okular\+::\+Page} $\ast$ $>$ \&pages\+Vector)
\item 
const \hyperlink{classOkular_1_1DocumentInfo}{Okular\+::\+Document\+Info} $\ast$ \hyperlink{classTIFFGenerator_ae24ee9b78bb2dcc95ca8a74e2abea900}{generate\+Document\+Info} ()
\item 
bool \hyperlink{classTIFFGenerator_a17cf8bd0f2821fc8d85473f03ba93686}{print} (Q\+Printer \&printer)
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classTIFFGenerator_abcefb909d9a5f1ace54b27a096ca258d}{do\+Close\+Document} ()
\item 
Q\+Image \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image} (\hyperlink{classOkular_1_1PixmapRequest}{Okular\+::\+Pixmap\+Request} $\ast$request)
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 17 of file generator\+\_\+tiff.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classTIFFGenerator_a8a4fcd61f40954d1c17fd3b880fe230c}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{T\+I\+F\+F\+Generator}]{\setlength{\rightskip}{0pt plus 5cm}T\+I\+F\+F\+Generator\+::\+T\+I\+F\+F\+Generator (
\begin{DoxyParamCaption}
\item[{Q\+Object $\ast$}]{parent, }
\item[{const Q\+Variant\+List \&}]{args}
\end{DoxyParamCaption}
)}}\label{classTIFFGenerator_a8a4fcd61f40954d1c17fd3b880fe230c}


Definition at line 179 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
180     : \hyperlink{classOkular_1_1Generator}{Okular::Generator}( parent, args ),
181       d( \textcolor{keyword}{new} Private ), m\_docInfo( 0 )
182 \{
183     \hyperlink{classOkular_1_1Generator_abcebcc5f69e98b6227496198a5c69d2c}{setFeature}( \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a0764a910b194896e72da084c3c51a2d0}{Threaded} );
184     \hyperlink{classOkular_1_1Generator_abcebcc5f69e98b6227496198a5c69d2c}{setFeature}( \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a7b40b8f6b9e4330bddff3cdf0baf07a9}{PrintNative} );
185     \hyperlink{classOkular_1_1Generator_abcebcc5f69e98b6227496198a5c69d2c}{setFeature}( \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a0bb6cbe50f2ffb616e25106b2e34c289}{PrintToFile} );
186     \hyperlink{classOkular_1_1Generator_abcebcc5f69e98b6227496198a5c69d2c}{setFeature}( \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a1a4bb4a7fe37342df79c702b4b2aab8a}{ReadRawData} );
187 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_ae8a40ff2851a47625811c041a30d61af}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!````~T\+I\+F\+F\+Generator@{$\sim$\+T\+I\+F\+F\+Generator}}
\index{````~T\+I\+F\+F\+Generator@{$\sim$\+T\+I\+F\+F\+Generator}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{$\sim$\+T\+I\+F\+F\+Generator}]{\setlength{\rightskip}{0pt plus 5cm}T\+I\+F\+F\+Generator\+::$\sim$\+T\+I\+F\+F\+Generator (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classTIFFGenerator_ae8a40ff2851a47625811c041a30d61af}


Definition at line 189 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
190 \{
191     \textcolor{keywordflow}{if} ( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} )
192     \{
193         TIFFClose( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} );
194         d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} = 0;
195     \}
196 
197     \textcolor{keyword}{delete} m\_docInfo;
198     \textcolor{keyword}{delete} d;
199 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classTIFFGenerator_abcefb909d9a5f1ace54b27a096ca258d}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!do\+Close\+Document@{do\+Close\+Document}}
\index{do\+Close\+Document@{do\+Close\+Document}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{do\+Close\+Document}]{\setlength{\rightskip}{0pt plus 5cm}bool T\+I\+F\+F\+Generator\+::do\+Close\+Document (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}}\label{classTIFFGenerator_abcefb909d9a5f1ace54b27a096ca258d}
This method is called when the document is closed and not used any longer.

\begin{DoxyReturn}{Returns}
true on success, false otherwise. 
\end{DoxyReturn}


Implements \hyperlink{classOkular_1_1Generator_ad3f1dcb98f3bd87c87ad0e91ecf4a6d7}{Okular\+::\+Generator}.



Definition at line 238 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
239 \{
240     \textcolor{comment}{// closing the old document}
241     \textcolor{keywordflow}{if} ( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} )
242     \{
243         TIFFClose( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} );
244         d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} = 0;
245         \textcolor{keyword}{delete} d->\hyperlink{classTIFFGenerator_1_1Private_af7d4bd0a5182c81313f551c9648c7a8d}{dev};
246         d->\hyperlink{classTIFFGenerator_1_1Private_af7d4bd0a5182c81313f551c9648c7a8d}{dev} = 0;
247         d->\hyperlink{classTIFFGenerator_1_1Private_a7deeb49c28cbb031066e1656b7febf6a}{data}.clear();
248         \textcolor{keyword}{delete} m\_docInfo;
249         m\_docInfo = 0;
250         m\_pageMapping.clear();
251     \}
252 
253     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
254 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_ae24ee9b78bb2dcc95ca8a74e2abea900}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!generate\+Document\+Info@{generate\+Document\+Info}}
\index{generate\+Document\+Info@{generate\+Document\+Info}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{generate\+Document\+Info}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Okular\+::\+Document\+Info} $\ast$ T\+I\+F\+F\+Generator\+::generate\+Document\+Info (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classTIFFGenerator_ae24ee9b78bb2dcc95ca8a74e2abea900}
Returns the general information object of the document or 0 if no information are available. 

Reimplemented from \hyperlink{classOkular_1_1Generator_a9993dd0a2415499e23d8394e7a447e98}{Okular\+::\+Generator}.



Definition at line 307 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
308 \{
309     \textcolor{keywordflow}{if} ( !d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff} )
310         \textcolor{keywordflow}{return} 0;
311 
312     \textcolor{keywordflow}{if} ( m\_docInfo )
313         \textcolor{keywordflow}{return} m\_docInfo;
314 
315     m\_docInfo = \textcolor{keyword}{new} \hyperlink{classOkular_1_1DocumentInfo}{Okular::DocumentInfo}();
316 
317     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a786464e8e8c3e6ba1cd74e408487785b}{Okular::DocumentInfo::MimeType}, \textcolor{stringliteral}{"image/tiff"} );
318 
319     \textcolor{keywordtype}{char}* buffer = 0;
320     TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_IMAGEDESCRIPTION, &buffer );
321     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791acc3edf1d2abe6eecb0882f4389475591}{Okular::DocumentInfo::Description}, buffer ? 
      QString::fromLatin1( buffer ) : i18nc( \textcolor{stringliteral}{"Unknown description"}, \textcolor{stringliteral}{"Unknown"} ) );
322 
323     buffer = 0;
324     TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_SOFTWARE, &buffer );
325     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a4781bb7ac85d4fe7bdc448097aa1c48c}{Okular::DocumentInfo::Producer}, buffer ? 
      QString::fromLatin1( buffer ) : i18nc( \textcolor{stringliteral}{"Unknown producer"}, \textcolor{stringliteral}{"Unknown"} ) );
326 
327     buffer = 0;
328     TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_COPYRIGHT, &buffer );
329     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a54b1ae59c56cd90e64b518e4d729471a}{Okular::DocumentInfo::Copyright}, buffer ? 
      QString::fromLatin1( buffer ) : i18nc( \textcolor{stringliteral}{"Unknown copyright statement"}, \textcolor{stringliteral}{"Unknown"} ) );
330 
331     buffer = 0;
332     TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_ARTIST, &buffer );
333     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a1010574d070b1925e030c20fef3e7a35}{Okular::DocumentInfo::Author}, buffer ? 
      QString::fromLatin1( buffer ) : i18nc( \textcolor{stringliteral}{"Unknown author"}, \textcolor{stringliteral}{"Unknown"} ) );
334 
335     buffer = 0;
336     TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_DATETIME, &buffer );
337     QDateTime date = convertTIFFDateTime( buffer );
338     m\_docInfo->\hyperlink{classOkular_1_1DocumentInfo_a8bd5403394ab192f1103cbf2a8e48d9b}{set}( \hyperlink{classOkular_1_1DocumentInfo_a3a6e5f7fb246e29bcb2e830b6f770791a58a72aeacd3cb08e85d0f9f19b2fe83a}{Okular::DocumentInfo::CreationDate}, date.isValid()
       ? KGlobal::locale()->formatDateTime( date, KLocale::LongDate, \textcolor{keyword}{true}  ) : i18nc( \textcolor{stringliteral}{"Unknown creation date"}, \textcolor{stringliteral}{"
      Unknown"} ) );
339 
340     \textcolor{keywordflow}{return} m\_docInfo;
341 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!image@{image}}
\index{image@{image}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{image}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Image T\+I\+F\+F\+Generator\+::image (
\begin{DoxyParamCaption}
\item[{{\bf Okular\+::\+Pixmap\+Request} $\ast$}]{page}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}}\label{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}
Returns the image of the page as specified in the passed pixmap {\ttfamily request}.

\begin{DoxyWarning}{Warning}
this method may be executed in its own separated thread if the \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a0764a910b194896e72da084c3c51a2d0}{Threaded} is enabled! 
\end{DoxyWarning}


Reimplemented from \hyperlink{classOkular_1_1Generator_a6712c8d3c2759c3a1fcacbd503d3286e}{Okular\+::\+Generator}.



Definition at line 256 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
257 \{
258     \textcolor{keywordtype}{bool} generated = \textcolor{keyword}{false};
259     QImage img;
260 
261     \textcolor{keywordflow}{if} ( TIFFSetDirectory( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, mapPage( request->page()->number() ) ) )
262     \{
263         \textcolor{keywordtype}{int} rotation = request->page()->rotation();
264         uint32 width = 1;
265         uint32 height = 1;
266         uint32 orientation = 0;
267         TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_IMAGEWIDTH, &width );
268         TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_IMAGELENGTH, &height );
269 
270         \textcolor{keywordflow}{if} ( !TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_ORIENTATION, &orientation ) )
271             orientation = ORIENTATION\_TOPLEFT;
272 
273         QImage \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}( width, height, QImage::Format\_RGB32 );
274         uint32 * data = (uint32 *)\hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.bits();
275 
276         \textcolor{comment}{// read data}
277         \textcolor{keywordflow}{if} ( TIFFReadRGBAImageOriented( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, width, height, data, orientation ) != 0 )
278         \{
279             \textcolor{comment}{// an image read by ReadRGBAImage is ABGR, we need ARGB, so swap red and blue}
280             uint32 \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} = width * height;
281             \textcolor{keywordflow}{for} ( uint32 i = 0; i < \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size}; ++i )
282             \{
283                 uint32 red = ( data[i] & 0x00FF0000 ) >> 16;
284                 uint32 blue = ( data[i] & 0x000000FF ) << 16;
285                 data[i] = ( data[i] & 0xFF00FF00 ) + red + blue;
286             \}
287 
288             \textcolor{keywordtype}{int} reqwidth = request->width();
289             \textcolor{keywordtype}{int} reqheight = request->height();
290             \textcolor{keywordflow}{if} ( rotation % 2 == 1 )
291                 \hyperlink{htmlextension_8h_a6aa0d61b42274f15f4a693b0c7bea484}{qSwap}( reqwidth, reqheight );
292             img = \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.scaled( reqwidth, reqheight, Qt::IgnoreAspectRatio, Qt::SmoothTransformation )
      ;
293 
294             generated = \textcolor{keyword}{true};
295         \}
296     \}
297 
298     \textcolor{keywordflow}{if} ( !generated )
299     \{
300         img = QImage( request->width(), request->height(), QImage::Format\_RGB32 );
301         img.fill( qRgb( 255, 255, 255 ) );
302     \}
303 
304     \textcolor{keywordflow}{return} img;
305 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_aebdfa77295efd1f9310b750e284dac5b}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!load\+Document@{load\+Document}}
\index{load\+Document@{load\+Document}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{load\+Document}]{\setlength{\rightskip}{0pt plus 5cm}bool T\+I\+F\+F\+Generator\+::load\+Document (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{file\+Name, }
\item[{Q\+Vector$<$ {\bf Okular\+::\+Page} $\ast$ $>$ \&}]{pages\+Vector}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classTIFFGenerator_aebdfa77295efd1f9310b750e284dac5b}
Loads the document with the given {\ttfamily file\+Name} and fills the {\ttfamily pages\+Vector} with the parsed pages.

\begin{DoxyReturn}{Returns}
true on success, false otherwise. 
\end{DoxyReturn}


Implements \hyperlink{classOkular_1_1Generator_a388b47328a5297d53cdbdc6fcf074ee3}{Okular\+::\+Generator}.



Definition at line 201 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
202 \{
203     QFile* qfile = \textcolor{keyword}{new} QFile( fileName );
204     qfile->open( QIODevice::ReadOnly );
205     d->\hyperlink{classTIFFGenerator_1_1Private_af7d4bd0a5182c81313f551c9648c7a8d}{dev} = qfile;
206     d->\hyperlink{classTIFFGenerator_1_1Private_a7deeb49c28cbb031066e1656b7febf6a}{data} = QFile::encodeName( QFileInfo( *qfile ).fileName() );
207     \textcolor{keywordflow}{return} loadTiff( pagesVector, d->\hyperlink{classTIFFGenerator_1_1Private_a7deeb49c28cbb031066e1656b7febf6a}{data}.constData() );
208 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_ab72ff71c466bd6f0e76ec6ffcc228106}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!load\+Document\+From\+Data@{load\+Document\+From\+Data}}
\index{load\+Document\+From\+Data@{load\+Document\+From\+Data}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{load\+Document\+From\+Data}]{\setlength{\rightskip}{0pt plus 5cm}bool T\+I\+F\+F\+Generator\+::load\+Document\+From\+Data (
\begin{DoxyParamCaption}
\item[{const Q\+Byte\+Array \&}]{file\+Data, }
\item[{Q\+Vector$<$ {\bf Okular\+::\+Page} $\ast$ $>$ \&}]{pages\+Vector}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classTIFFGenerator_ab72ff71c466bd6f0e76ec6ffcc228106}
Loads the document from the raw data {\ttfamily file\+Data} and fills the {\ttfamily pages\+Vector} with the parsed pages.

\begin{DoxyNote}{Note}
the Generator has to have the feature \hyperlink{classOkular_1_1Generator_a8517096896273a5ba5b970be09313c77a1a4bb4a7fe37342df79c702b4b2aab8a}{Read\+Raw\+Data} enabled
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
true on success, false otherwise. 
\end{DoxyReturn}


Reimplemented from \hyperlink{classOkular_1_1Generator_ad65d9a0e78c500475bb403ab0ffd640c}{Okular\+::\+Generator}.



Definition at line 210 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
211 \{
212     d->\hyperlink{classTIFFGenerator_1_1Private_a7deeb49c28cbb031066e1656b7febf6a}{data} = fileData;
213     QBuffer* qbuffer = \textcolor{keyword}{new} QBuffer( &d->\hyperlink{classTIFFGenerator_1_1Private_a7deeb49c28cbb031066e1656b7febf6a}{data} );
214     qbuffer->open( QIODevice::ReadOnly );
215     d->\hyperlink{classTIFFGenerator_1_1Private_af7d4bd0a5182c81313f551c9648c7a8d}{dev} = qbuffer;
216     \textcolor{keywordflow}{return} loadTiff( pagesVector, \textcolor{stringliteral}{"<stdin>"} );
217 \}
\end{DoxyCode}
\hypertarget{classTIFFGenerator_a17cf8bd0f2821fc8d85473f03ba93686}{\index{T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}!print@{print}}
\index{print@{print}!T\+I\+F\+F\+Generator@{T\+I\+F\+F\+Generator}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}bool T\+I\+F\+F\+Generator\+::print (
\begin{DoxyParamCaption}
\item[{Q\+Printer \&}]{printer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classTIFFGenerator_a17cf8bd0f2821fc8d85473f03ba93686}
This method is called to print the document to the given {\ttfamily printer}. 

Reimplemented from \hyperlink{classOkular_1_1Generator_aa786d406a1b0db6679a3bc62bbe2dc82}{Okular\+::\+Generator}.



Definition at line 381 of file generator\+\_\+tiff.\+cpp.


\begin{DoxyCode}
382 \{
383     uint32 width = 0;
384     uint32 height = 0;
385 
386     QPainter p( &printer );
387 
388     \hyperlink{classQList}{QList<int>} pageList = \hyperlink{classOkular_1_1FilePrinter_aed485e5e3fbe591b16e15915e318a1b7}{Okular::FilePrinter::pageList}( printer, 
      \hyperlink{classOkular_1_1Generator_a4248672ef04e62660d51f16c0a862bbe}{document}()->pages(),
389                                                          \hyperlink{classOkular_1_1Generator_a4248672ef04e62660d51f16c0a862bbe}{document}()->currentPage() + 1,
390                                                          \hyperlink{classOkular_1_1Generator_a4248672ef04e62660d51f16c0a862bbe}{document}()->bookmarkedPageList() );
391 
392     \textcolor{keywordflow}{for} ( tdir\_t i = 0; i < pageList.count(); ++i )
393     \{
394         \textcolor{keywordflow}{if} ( !TIFFSetDirectory( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, mapPage( pageList[i] - 1 ) ) )
395             \textcolor{keywordflow}{continue};
396 
397         \textcolor{keywordflow}{if} ( TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_IMAGEWIDTH, &width ) != 1 ||
398              TIFFGetField( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, TIFFTAG\_IMAGELENGTH, &height ) != 1 )
399             \textcolor{keywordflow}{continue};
400 
401         QImage \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}( width, height, QImage::Format\_RGB32 );
402         uint32 * data = (uint32 *)\hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.bits();
403 
404         \textcolor{comment}{// read data}
405         \textcolor{keywordflow}{if} ( TIFFReadRGBAImageOriented( d->\hyperlink{classTIFFGenerator_1_1Private_abe0f02dd2a2177e43a18938d465ef328}{tiff}, width, height, data, ORIENTATION\_TOPLEFT ) != 0 )
406         \{
407             \textcolor{comment}{// an image read by ReadRGBAImage is ABGR, we need ARGB, so swap red and blue}
408             uint32 \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size} = width * height;
409             \textcolor{keywordflow}{for} ( uint32 i = 0; i < \hyperlink{synctex__parser_8c_aa23c661441688350614bd6a350d2b6ff}{size}; ++i )
410             \{
411                 uint32 red = ( data[i] & 0x00FF0000 ) >> 16;
412                 uint32 blue = ( data[i] & 0x000000FF ) << 16;
413                 data[i] = ( data[i] & 0xFF00FF00 ) + red + blue;
414             \}
415         \}
416 
417         \textcolor{keywordflow}{if} ( i != 0 )
418             printer.newPage();
419 
420         QSize targetSize = printer.pageRect().size();
421 
422         \textcolor{keywordflow}{if} ( (\hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.width() < targetSize.width()) && (\hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.height() < targetSize.height()) )
423         \{
424             \textcolor{comment}{// draw small images at 100% (don't scale up)}
425             p.drawImage( 0, 0, \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image} );
426         \} \textcolor{keywordflow}{else} \{
427             \textcolor{comment}{// fit to page}
428             p.drawImage( 0, 0, \hyperlink{classTIFFGenerator_aba1b5aafb7e194b48f4b5a8a02e47ddb}{image}.scaled( targetSize, Qt::IgnoreAspectRatio, 
      Qt::SmoothTransformation ) );
429         \}
430     \}
431 
432     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
433 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
generators/tiff/\hyperlink{generator__tiff_8h}{generator\+\_\+tiff.\+h}\item 
generators/tiff/\hyperlink{generator__tiff_8cpp}{generator\+\_\+tiff.\+cpp}\end{DoxyCompactItemize}
