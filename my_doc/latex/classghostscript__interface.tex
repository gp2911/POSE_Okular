\hypertarget{classghostscript__interface}{\section{ghostscript\+\_\+interface Class Reference}
\label{classghostscript__interface}\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
}


{\ttfamily \#include $<$psgs.\+h$>$}

Inheritance diagram for ghostscript\+\_\+interface\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classghostscript__interface}
\end{center}
\end{figure}
\subsection*{Signals}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classghostscript__interface_ae67f267e3aa962551a2872314978fed8}{error} (const Q\+String \&message, int duration)
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classghostscript__interface_a3bf3c8eee9c17fd5e01c98903b94640f}{ghostscript\+\_\+interface} ()
\item 
\hyperlink{classghostscript__interface_a1dbba27a394dfbb03b2584b55909dd0d}{$\sim$ghostscript\+\_\+interface} ()
\item 
void \hyperlink{classghostscript__interface_ad304fbc79f41cc832e8fe4c01751fb46}{clear} ()
\item 
void \hyperlink{classghostscript__interface_a5ae4823881dcb0f283d2ec705df38313}{set\+Post\+Script} (const \hyperlink{classPageNumber}{Page\+Number} \&page, const Q\+String \&Post\+Script)
\item 
void \hyperlink{classghostscript__interface_a493c8915bc644ffa3abeb34e8bc79d65}{set\+Include\+Path} (const Q\+String \&\+\_\+include\+Path)
\item 
void \hyperlink{classghostscript__interface_a567c1800359854b7a1b7cf24fcaea80f}{set\+Background\+Color} (const \hyperlink{classPageNumber}{Page\+Number} \&page, const Q\+Color \&background\+\_\+color, bool permanent=true)
\item 
void \hyperlink{classghostscript__interface_a4d9303488fdbbcb7519b68d6146c5a77}{restore\+Background\+Color} (const \hyperlink{classPageNumber}{Page\+Number} \&page)
\item 
void \hyperlink{classghostscript__interface_ae271c8afd873b5d6a77a67eddc12540a}{graphics} (const \hyperlink{classPageNumber}{Page\+Number} \&page, double dpi, long magnification, Q\+Painter $\ast$paint)
\item 
Q\+Color \hyperlink{classghostscript__interface_aa43188e3c387cb97e584a364bc7b3b6a}{get\+Background\+Color} (const \hyperlink{classPageNumber}{Page\+Number} \&page) const 
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static Q\+String \hyperlink{classghostscript__interface_ac8e4316169f38cf76721481781415913}{locate\+E\+P\+Sfile} (const Q\+String \&filename, const K\+Url \&base)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
Q\+String $\ast$ \hyperlink{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{Post\+Script\+Header\+String}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 36 of file psgs.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classghostscript__interface_a3bf3c8eee9c17fd5e01c98903b94640f}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{ghostscript\+\_\+interface}]{\setlength{\rightskip}{0pt plus 5cm}ghostscript\+\_\+interface\+::ghostscript\+\_\+interface (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a3bf3c8eee9c17fd5e01c98903b94640f}


Definition at line 48 of file psgs.\+cpp.


\begin{DoxyCode}
48                                              \{
49 
50   \hyperlink{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{PostScriptHeaderString} = \textcolor{keyword}{new} QString();
51 
52   knownDevices.append(\textcolor{stringliteral}{"png16m"});
53   knownDevices.append(\textcolor{stringliteral}{"jpeg"});
54   knownDevices.append(\textcolor{stringliteral}{"pnn"});
55   knownDevices.append(\textcolor{stringliteral}{"pnnraw"});
56   gsDevice = knownDevices.begin();
57 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_a1dbba27a394dfbb03b2584b55909dd0d}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!````~ghostscript\+\_\+interface@{$\sim$ghostscript\+\_\+interface}}
\index{````~ghostscript\+\_\+interface@{$\sim$ghostscript\+\_\+interface}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{$\sim$ghostscript\+\_\+interface}]{\setlength{\rightskip}{0pt plus 5cm}ghostscript\+\_\+interface\+::$\sim$ghostscript\+\_\+interface (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a1dbba27a394dfbb03b2584b55909dd0d}


Definition at line 59 of file psgs.\+cpp.


\begin{DoxyCode}
59                                               \{
60   \textcolor{keywordflow}{if} (\hyperlink{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{PostScriptHeaderString} != 0L)
61     \textcolor{keyword}{delete} \hyperlink{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{PostScriptHeaderString};
62   qDeleteAll(pageList);
63 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classghostscript__interface_ad304fbc79f41cc832e8fe4c01751fb46}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!clear@{clear}}
\index{clear@{clear}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::clear (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_ad304fbc79f41cc832e8fe4c01751fb46}


Definition at line 138 of file psgs.\+cpp.


\begin{DoxyCode}
138                                   \{
139   \hyperlink{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{PostScriptHeaderString}->truncate(0);
140 
141   \textcolor{comment}{// Deletes all items, removes temporary files, etc.}
142   qDeleteAll(pageList);
143   pageList.clear();
144 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_ae67f267e3aa962551a2872314978fed8}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!error@{error}}
\index{error@{error}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{error}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::error (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{message, }
\item[{int}]{duration}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classghostscript__interface_ae67f267e3aa962551a2872314978fed8}
Passed through to the top-\/level kpart. \hypertarget{classghostscript__interface_aa43188e3c387cb97e584a364bc7b3b6a}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!get\+Background\+Color@{get\+Background\+Color}}
\index{get\+Background\+Color@{get\+Background\+Color}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{get\+Background\+Color}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Color ghostscript\+\_\+interface\+::get\+Background\+Color (
\begin{DoxyParamCaption}
\item[{const {\bf Page\+Number} \&}]{page}
\end{DoxyParamCaption}
) const}}\label{classghostscript__interface_aa43188e3c387cb97e584a364bc7b3b6a}


Definition at line 126 of file psgs.\+cpp.


\begin{DoxyCode}
126                                                                              \{
127 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
128   kDebug(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::getBackgroundColor( "} << page << \textcolor{stringliteral}{" )"};
129 \textcolor{preprocessor}{#endif}
130 
131   \textcolor{keywordflow}{if} (pageList.value(page) == 0)
132     \textcolor{keywordflow}{return} Qt::white;
133   \textcolor{keywordflow}{else}
134     \textcolor{keywordflow}{return} pageList.value(page)->background;
135 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_ae271c8afd873b5d6a77a67eddc12540a}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!graphics@{graphics}}
\index{graphics@{graphics}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{graphics}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::graphics (
\begin{DoxyParamCaption}
\item[{const {\bf Page\+Number} \&}]{page, }
\item[{double}]{dpi, }
\item[{long}]{magnification, }
\item[{Q\+Painter $\ast$}]{paint}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_ae271c8afd873b5d6a77a67eddc12540a}


Definition at line 295 of file psgs.\+cpp.


\begin{DoxyCode}
295                                                                                                            
       \{
296 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
297   kDebug(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::graphics( "} << page << \textcolor{stringliteral}{", "} << dpi << \textcolor{stringliteral}{", ... ) called."};
298 \textcolor{preprocessor}{#endif}
299 
300   \textcolor{keywordflow}{if} (paint == 0) \{
301     kError(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::graphics(PageNumber page, double dpi, long magnification,
       QPainter *paint) called with paint == 0"} << endl;
302     \textcolor{keywordflow}{return};
303   \}
304 
305   resolution   = dpi;
306 
307   pixel\_page\_w = paint->viewport().width();
308   pixel\_page\_h = paint->viewport().height();
309 
310   \hyperlink{classpageInfo}{pageInfo} *info = pageList.value(page);
311 
312   \textcolor{comment}{// No PostScript? Then return immediately.}
313   \textcolor{keywordflow}{if} ((info == 0) || (info->\hyperlink{classpageInfo_a7147ce91acc430c40a335c9e4c5f93d7}{PostScriptString}->isEmpty())) \{
314 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
315     kDebug(kvs::dvi) << \textcolor{stringliteral}{"No PostScript found. Not drawing anything."};
316 \textcolor{preprocessor}{#endif}
317     \textcolor{keywordflow}{return};
318   \}
319 
320   QTemporaryFile gfxFile;
321   gfxFile.open();
322   \textcolor{keyword}{const} QString gfxFileName = gfxFile.fileName();
323   \textcolor{comment}{// We are want the filename, not the file.}
324   gfxFile.close();
325 
326   gs\_generate\_graphics\_file(page, gfxFileName, magnification);
327   
328   QImage MemoryCopy(gfxFileName);
329   paint->drawImage(0, 0, MemoryCopy);
330   \textcolor{keywordflow}{return};
331 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_ac8e4316169f38cf76721481781415913}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!locate\+E\+P\+Sfile@{locate\+E\+P\+Sfile}}
\index{locate\+E\+P\+Sfile@{locate\+E\+P\+Sfile}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{locate\+E\+P\+Sfile}]{\setlength{\rightskip}{0pt plus 5cm}Q\+String ghostscript\+\_\+interface\+::locate\+E\+P\+Sfile (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{filename, }
\item[{const K\+Url \&}]{base}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classghostscript__interface_ac8e4316169f38cf76721481781415913}
This method tries to find the Post\+Script file 'filename' in the D\+V\+I file's directory (if the base-\/\+U\+R\+L indicates that the D\+V\+I file is local), and, if that fails, uses kpsewhich to find the file. If the file is found, the full path (including file name) is returned. Otherwise, the method returns the first argument. T\+O\+D\+O\+: use the D\+V\+I file's base\+U\+R\+L, once this is implemented. 

Definition at line 334 of file psgs.\+cpp.


\begin{DoxyCode}
335 \{
336   \textcolor{comment}{// If the base URL indicates that the DVI file is local, try to find}
337   \textcolor{comment}{// the graphics file in the directory where the DVI file resides}
338   \textcolor{keywordflow}{if} (base.isLocalFile()) \{
339     QString path = base.path();       \textcolor{comment}{// -> "/bar/foo.dvi"}
340     QFileInfo fi1(path);
341     QFileInfo fi2(fi1.dir(),filename);
342     \textcolor{keywordflow}{if} (fi2.exists())
343       \textcolor{keywordflow}{return} fi2.absoluteFilePath();
344   \}
345 
346   \textcolor{comment}{// Otherwise, use kpsewhich to find the eps file.}
347   KProcess proc;
348   proc << \textcolor{stringliteral}{"kpsewhich"} << filename;
349   proc.execute();
350   \textcolor{keywordflow}{return} QString::fromLocal8Bit(proc.readLine().trimmed());
351 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_a4d9303488fdbbcb7519b68d6146c5a77}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!restore\+Background\+Color@{restore\+Background\+Color}}
\index{restore\+Background\+Color@{restore\+Background\+Color}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{restore\+Background\+Color}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::restore\+Background\+Color (
\begin{DoxyParamCaption}
\item[{const {\bf Page\+Number} \&}]{page}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a4d9303488fdbbcb7519b68d6146c5a77}


Definition at line 111 of file psgs.\+cpp.


\begin{DoxyCode}
112 \{
113 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
114   kDebug(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::restoreBackgroundColor( "} << page << \textcolor{stringliteral}{" )"};
115 \textcolor{preprocessor}{#endif}
116   \textcolor{keywordflow}{if} (pageList.value(page) == 0)
117     \textcolor{keywordflow}{return};
118 
119   \hyperlink{classpageInfo}{pageInfo} *info = pageList.value(page);
120   info->\hyperlink{classpageInfo_a41b9b0b4063989fa6b8feeec3a0c889c}{background} = info->\hyperlink{classpageInfo_a8c181d1ce452d9977f37978a952f8207}{permanentBackground};
121 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_a567c1800359854b7a1b7cf24fcaea80f}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!set\+Background\+Color@{set\+Background\+Color}}
\index{set\+Background\+Color@{set\+Background\+Color}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{set\+Background\+Color}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::set\+Background\+Color (
\begin{DoxyParamCaption}
\item[{const {\bf Page\+Number} \&}]{page, }
\item[{const Q\+Color \&}]{background\+\_\+color, }
\item[{bool}]{permanent = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a567c1800359854b7a1b7cf24fcaea80f}


Definition at line 90 of file psgs.\+cpp.


\begin{DoxyCode}
90                                                                                                            
                \{
91 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
92   kDebug(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::setBackgroundColor( "} << page << \textcolor{stringliteral}{", "} << background\_color << \textcolor{stringliteral}{
      " )"};
93 \textcolor{preprocessor}{#endif}
94 
95   \textcolor{keywordflow}{if} (pageList.value(page) == 0) \{
96     \hyperlink{classpageInfo}{pageInfo} *info = \textcolor{keyword}{new} \hyperlink{classpageInfo}{pageInfo}(QString::null);   \textcolor{comment}{//krazy:exclude=nullstrassign for old
       broken gcc}
97     info->\hyperlink{classpageInfo_a41b9b0b4063989fa6b8feeec3a0c889c}{background} = background\_color;
98     \textcolor{keywordflow}{if} (permanent)
99       info->\hyperlink{classpageInfo_a8c181d1ce452d9977f37978a952f8207}{permanentBackground} = background\_color;
100     \textcolor{comment}{// Check if dict is big enough}
101     \textcolor{keywordflow}{if} (pageList.count() > pageList.capacity() -2)
102       pageList.reserve(pageList.capacity()*2);
103     pageList.insert(page, info);
104   \} \textcolor{keywordflow}{else} \{
105     pageList.value(page)->background = background\_color;
106     \textcolor{keywordflow}{if} (permanent)
107       pageList.value(page)->permanentBackground = background\_color;
108   \}
109 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_a493c8915bc644ffa3abeb34e8bc79d65}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!set\+Include\+Path@{set\+Include\+Path}}
\index{set\+Include\+Path@{set\+Include\+Path}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{set\+Include\+Path}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::set\+Include\+Path (
\begin{DoxyParamCaption}
\item[{const Q\+String \&}]{\+\_\+include\+Path}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a493c8915bc644ffa3abeb34e8bc79d65}


Definition at line 82 of file psgs.\+cpp.


\begin{DoxyCode}
82                                                                       \{
83   \textcolor{keywordflow}{if} (\_includePath.isEmpty())
84      includePath = \textcolor{stringliteral}{"*"}; \textcolor{comment}{// Allow all files}
85   \textcolor{keywordflow}{else}
86      includePath = \_includePath+\textcolor{stringliteral}{"/*"};
87 \}
\end{DoxyCode}
\hypertarget{classghostscript__interface_a5ae4823881dcb0f283d2ec705df38313}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!set\+Post\+Script@{set\+Post\+Script}}
\index{set\+Post\+Script@{set\+Post\+Script}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{set\+Post\+Script}]{\setlength{\rightskip}{0pt plus 5cm}void ghostscript\+\_\+interface\+::set\+Post\+Script (
\begin{DoxyParamCaption}
\item[{const {\bf Page\+Number} \&}]{page, }
\item[{const Q\+String \&}]{Post\+Script}
\end{DoxyParamCaption}
)}}\label{classghostscript__interface_a5ae4823881dcb0f283d2ec705df38313}


Definition at line 66 of file psgs.\+cpp.


\begin{DoxyCode}
66                                                                                            \{
67 \textcolor{preprocessor}{#ifdef DEBUG\_PSGS}
68   kDebug(kvs::dvi) << \textcolor{stringliteral}{"ghostscript\_interface::setPostScript( "} << page << \textcolor{stringliteral}{", ... )"};
69 \textcolor{preprocessor}{#endif}
70 
71   \textcolor{keywordflow}{if} (pageList.value(page) == 0) \{
72     \hyperlink{classpageInfo}{pageInfo} *info = \textcolor{keyword}{new} \hyperlink{classpageInfo}{pageInfo}(PostScript);
73     \textcolor{comment}{// Check if dict is big enough}
74     \textcolor{keywordflow}{if} (pageList.count() > pageList.capacity() -2)
75       pageList.reserve(pageList.capacity()*2);
76     pageList.insert(page, info);
77   \} \textcolor{keywordflow}{else}
78     *(pageList.value(page)->PostScriptString) = PostScript;
79 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}{\index{ghostscript\+\_\+interface@{ghostscript\+\_\+interface}!Post\+Script\+Header\+String@{Post\+Script\+Header\+String}}
\index{Post\+Script\+Header\+String@{Post\+Script\+Header\+String}!ghostscript\+\_\+interface@{ghostscript\+\_\+interface}}
\subsubsection[{Post\+Script\+Header\+String}]{\setlength{\rightskip}{0pt plus 5cm}Q\+String$\ast$ ghostscript\+\_\+interface\+::\+Post\+Script\+Header\+String}}\label{classghostscript__interface_ae86990db25df0d7d5607fd58f573d8c1}


Definition at line 70 of file psgs.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
generators/dvi/\hyperlink{psgs_8h}{psgs.\+h}\item 
generators/dvi/\hyperlink{psgs_8cpp}{psgs.\+cpp}\end{DoxyCompactItemize}
