\hypertarget{classOkular_1_1AnnotationUtils}{\section{Okular\+:\+:Annotation\+Utils Class Reference}
\label{classOkular_1_1AnnotationUtils}\index{Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}}
}


Helper class for (recursive) annotation retrieval/storage.  




{\ttfamily \#include $<$annotations.\+h$>$}

\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classOkular_1_1Annotation}{Annotation} $\ast$ \hyperlink{classOkular_1_1AnnotationUtils_a790854adbb753b2a448640021442bf73}{create\+Annotation} (const Q\+Dom\+Element \&element)
\item 
static void \hyperlink{classOkular_1_1AnnotationUtils_aaf554db9b97842dd6298317dd539bf82}{store\+Annotation} (const \hyperlink{classOkular_1_1Annotation}{Annotation} $\ast$annotation, Q\+Dom\+Element \&element, Q\+Dom\+Document \&document)
\item 
static Q\+Dom\+Element \hyperlink{classOkular_1_1AnnotationUtils_a05b79294046a1756dd5fb120aa18b52b}{find\+Child\+Element} (const Q\+Dom\+Node \&parent\+Node, const Q\+String \&name)
\item 
static Q\+Rect \hyperlink{classOkular_1_1AnnotationUtils_a6b3fdb4e89227d26ec9e6f62bf4d0eb9}{annotation\+Geometry} (const \hyperlink{classOkular_1_1Annotation}{Annotation} $\ast$annotation, double scale\+X, double scale\+Y)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper class for (recursive) annotation retrieval/storage. 

Definition at line 52 of file annotations.\+h.



\subsection{Member Function Documentation}
\hypertarget{classOkular_1_1AnnotationUtils_a6b3fdb4e89227d26ec9e6f62bf4d0eb9}{\index{Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}!annotation\+Geometry@{annotation\+Geometry}}
\index{annotation\+Geometry@{annotation\+Geometry}!Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}}
\subsubsection[{annotation\+Geometry}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Rect Annotation\+Utils\+::annotation\+Geometry (
\begin{DoxyParamCaption}
\item[{const {\bf Annotation} $\ast$}]{annotation, }
\item[{double}]{scale\+X, }
\item[{double}]{scale\+Y}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classOkular_1_1AnnotationUtils_a6b3fdb4e89227d26ec9e6f62bf4d0eb9}
Returns the geometry of the given {\ttfamily annotation} scaled by {\ttfamily scale\+X} and {\ttfamily scale\+Y}. 

Definition at line 154 of file annotations.\+cpp.


\begin{DoxyCode}
156 \{
157     \textcolor{keyword}{const} QRect rect = ann->transformedBoundingRectangle().geometry( (\textcolor{keywordtype}{int})scaledWidth, (\textcolor{keywordtype}{int})scaledHeight );
158     \textcolor{keywordflow}{if} ( ann->subType() == \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a48f93d5a9352abc4e38a45f69075e504}{Annotation::AText} && ( ( (
      \hyperlink{classOkular_1_1TextAnnotation}{TextAnnotation}*)ann )->textType() == \hyperlink{classOkular_1_1TextAnnotation_af560204454bf812797bc95bea730b06eaf7d7133e8e4850bf030e108537a9887b}{TextAnnotation::Linked} ) )
159     \{
160         \textcolor{comment}{// To be honest i have no clue of why the 24,24 is here, maybe to make sure it's not too small?}
161         \textcolor{comment}{// But why only for linked text?}
162         \textcolor{keyword}{const} QRect rect24 = QRect( (\textcolor{keywordtype}{int})( ann->transformedBoundingRectangle().left * scaledWidth ),
163                                     (\textcolor{keywordtype}{int})( ann->transformedBoundingRectangle().top * scaledHeight ), 24, 24
       );
164         \textcolor{keywordflow}{return} rect24.united(rect);
165     \}
166 
167     \textcolor{keywordflow}{return} rect;
168 \}
\end{DoxyCode}
\hypertarget{classOkular_1_1AnnotationUtils_a790854adbb753b2a448640021442bf73}{\index{Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}!create\+Annotation@{create\+Annotation}}
\index{create\+Annotation@{create\+Annotation}!Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}}
\subsubsection[{create\+Annotation}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Annotation} $\ast$ Annotation\+Utils\+::create\+Annotation (
\begin{DoxyParamCaption}
\item[{const Q\+Dom\+Element \&}]{element}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classOkular_1_1AnnotationUtils_a790854adbb753b2a448640021442bf73}
Restore an annotation (with revisions if needed) from the dom {\ttfamily element}.

Returns a pointer to the complete annotation or 0 if element is invalid. 

Definition at line 90 of file annotations.\+cpp.


\begin{DoxyCode}
91 \{
92     \textcolor{comment}{// safety check on annotation element}
93     \textcolor{keywordflow}{if} ( !annElement.hasAttribute( \textcolor{stringliteral}{"type"} ) )
94         \textcolor{keywordflow}{return} 0;
95 
96     \textcolor{comment}{// build annotation of given type}
97     \hyperlink{classOkular_1_1Annotation}{Annotation} * annotation = 0;
98     \textcolor{keywordtype}{int} typeNumber = annElement.attribute( \textcolor{stringliteral}{"type"} ).toInt();
99     \textcolor{keywordflow}{switch} ( typeNumber )
100     \{
101         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a48f93d5a9352abc4e38a45f69075e504}{Annotation::AText}:
102             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1TextAnnotation}{TextAnnotation}( annElement );
103             \textcolor{keywordflow}{break};
104         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a7035dc978d8b79958f34e3d164838726}{Annotation::ALine}:
105             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1LineAnnotation}{LineAnnotation}( annElement );
106             \textcolor{keywordflow}{break};
107         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a2c11d328af34f5526fd9e761297fb3c2}{Annotation::AGeom}:
108             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1GeomAnnotation}{GeomAnnotation}( annElement );
109             \textcolor{keywordflow}{break};
110         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a03e002f9ae62005b2d7c7f1445507501}{Annotation::AHighlight}:
111             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1HighlightAnnotation}{HighlightAnnotation}( annElement );
112             \textcolor{keywordflow}{break};
113         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0ad542ded420c9b01f44ee923bf28ecd9a}{Annotation::AStamp}:
114             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1StampAnnotation}{StampAnnotation}( annElement );
115             \textcolor{keywordflow}{break};
116         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a4ed60063584ceb146c2a378f0df4ed37}{Annotation::AInk}:
117             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1InkAnnotation}{InkAnnotation}( annElement );
118             \textcolor{keywordflow}{break};
119         \textcolor{keywordflow}{case} \hyperlink{classOkular_1_1Annotation_af71b46e37d5f850b97d5c4de3be9aac0a904187454fd508d898a3d5843193ad43}{Annotation::ACaret}:
120             annotation = \textcolor{keyword}{new} \hyperlink{classOkular_1_1CaretAnnotation}{CaretAnnotation}( annElement );
121             \textcolor{keywordflow}{break};
122     \}
123 
124     \textcolor{comment}{// return created annotation}
125     \textcolor{keywordflow}{return} annotation;
126 \}
\end{DoxyCode}
\hypertarget{classOkular_1_1AnnotationUtils_a05b79294046a1756dd5fb120aa18b52b}{\index{Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}!find\+Child\+Element@{find\+Child\+Element}}
\index{find\+Child\+Element@{find\+Child\+Element}!Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}}
\subsubsection[{find\+Child\+Element}]{\setlength{\rightskip}{0pt plus 5cm}Q\+Dom\+Element Annotation\+Utils\+::find\+Child\+Element (
\begin{DoxyParamCaption}
\item[{const Q\+Dom\+Node \&}]{parent\+Node, }
\item[{const Q\+String \&}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classOkular_1_1AnnotationUtils_a05b79294046a1756dd5fb120aa18b52b}
Returns the child element with the given {\ttfamily name} from the direct children of {\ttfamily parent\+Node} or a null element if not found. 

Definition at line 138 of file annotations.\+cpp.


\begin{DoxyCode}
140 \{
141     \textcolor{comment}{// loop through the whole children and return a 'name' named element}
142     QDomNode subNode = parentNode.firstChild();
143     \textcolor{keywordflow}{while}( subNode.isElement() )
144     \{
145         QDomElement element = subNode.toElement();
146         \textcolor{keywordflow}{if} ( element.tagName() == name )
147             \textcolor{keywordflow}{return} element;
148         subNode = subNode.nextSibling();
149     \}
150     \textcolor{comment}{// if the name can't be found, return a dummy null element}
151     \textcolor{keywordflow}{return} QDomElement();
152 \}
\end{DoxyCode}
\hypertarget{classOkular_1_1AnnotationUtils_aaf554db9b97842dd6298317dd539bf82}{\index{Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}!store\+Annotation@{store\+Annotation}}
\index{store\+Annotation@{store\+Annotation}!Okular\+::\+Annotation\+Utils@{Okular\+::\+Annotation\+Utils}}
\subsubsection[{store\+Annotation}]{\setlength{\rightskip}{0pt plus 5cm}void Annotation\+Utils\+::store\+Annotation (
\begin{DoxyParamCaption}
\item[{const {\bf Annotation} $\ast$}]{annotation, }
\item[{Q\+Dom\+Element \&}]{element, }
\item[{Q\+Dom\+Document \&}]{document}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classOkular_1_1AnnotationUtils_aaf554db9b97842dd6298317dd539bf82}
Saves the {\ttfamily annotation} as a child of {\ttfamily element} taking care of saving all revisions if it has any. 

Definition at line 128 of file annotations.\+cpp.


\begin{DoxyCode}
130 \{
131     \textcolor{comment}{// save annotation's type as element's attribute}
132     annElement.setAttribute( \textcolor{stringliteral}{"type"}, (uint)ann->subType() );
133 
134     \textcolor{comment}{// append all annotation data as children of this node}
135     ann->store( annElement, document );
136 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
core/\hyperlink{annotations_8h}{annotations.\+h}\item 
core/\hyperlink{annotations_8cpp}{annotations.\+cpp}\end{DoxyCompactItemize}
