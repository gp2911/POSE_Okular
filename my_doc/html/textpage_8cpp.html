<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>GP&#39;s Okular Build: core/textpage.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GP&#39;s Okular Build
   </div>
   <div id="projectbrief">POSE 2014</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('textpage_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(13)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">textpage.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="textpage_8h_source.html">textpage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="textpage__p_8h_source.html">textpage_p.h</a>&quot;</code><br/>
<code>#include &lt;kdebug.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="area_8h_source.html">area.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug__p_8h_source.html">debug_p.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="page_8h_source.html">page.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="page__p_8h_source.html">page_p.h</a>&quot;</code><br/>
<code>#include &lt;cstring&gt;</code><br/>
<code>#include &lt;QtAlgorithms&gt;</code><br/>
<code>#include &lt;QVarLengthArray&gt;</code><br/>
</div>
<p><a href="textpage_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSearchPoint.html">SearchPoint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTinyTextEntity.html">TinyTextEntity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structWordWithCharacters.html">WordWithCharacters</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRegionText.html">RegionText</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad911313b0eb678ed7fadf84147e4d1d3"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classQList.html">QList</a>&lt; <a class="el" href="structWordWithCharacters.html">WordWithCharacters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a></td></tr>
<tr class="separator:ad911313b0eb678ed7fadf84147e4d1d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a69c9a8e3d3ed1e7180350337c5c725e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQList.html">QList</a>&lt; <a class="el" href="structQPair.html">QPair</a><br class="typebreak"/>
&lt; <a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a>, QRect &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="textpage_8cpp.html#a69c9a8e3d3ed1e7180350337c5c725e2">makeAndSortLines</a> (const <a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a> &amp;wordsTmp, int pageWidth, int pageHeight)</td></tr>
<tr class="separator:a69c9a8e3d3ed1e7180350337c5c725e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a209dadd7a945144fc847eb9bfc0a0271"><td class="memItemLeft" align="right" valign="top"><a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="textpage_8cpp.html#a209dadd7a945144fc847eb9bfc0a0271">addNecessarySpace</a> (<a class="el" href="namespaceOkular.html#a870e45698d8c99f4400310d019c77861">RegionTextList</a> tree, int pageWidth, int pageHeight)</td></tr>
<tr class="separator:a209dadd7a945144fc847eb9bfc0a0271"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ad911313b0eb678ed7fadf84147e4d1d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classQList.html">QList</a>&lt;<a class="el" href="structWordWithCharacters.html">WordWithCharacters</a>&gt; <a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="textpage_8cpp_source.html#l00278">278</a> of file <a class="el" href="textpage_8cpp_source.html">textpage.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a209dadd7a945144fc847eb9bfc0a0271"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a> addNecessarySpace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceOkular.html#a870e45698d8c99f4400310d019c77861">RegionTextList</a>&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageHeight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add spaces in between words in a line. It reuses the pointers passed in tree and might add new ones. You will need to take care of deleting them if needed </p>
<ol type="1">
<li>Call makeAndSortLines before adding spaces in between words in a line</li>
<li>Now add spaces between every two words in a line</li>
<li>Finally, extract all the space separated texts from each region and return it</li>
</ol>

<p>Definition at line <a class="el" href="textpage_8cpp_source.html#l01805">1805</a> of file <a class="el" href="textpage_8cpp_source.html">textpage.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;{</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">// Only change the texts under RegionTexts, not the area</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0 ; j &lt; tree.length() ; j++)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <a class="code" href="classRegionText.html">RegionText</a> &amp;tmpRegion = tree[j];</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="comment">// Step 01</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <a class="code" href="classQList.html">QList&lt; QPair&lt;WordsWithCharacters, QRect&gt;</a> &gt; sortedLines = <a class="code" href="textpage_8cpp.html#a69c9a8e3d3ed1e7180350337c5c725e2">makeAndSortLines</a>(tmpRegion.<a class="code" href="classRegionText.html#a57a630a26401ff61192e66eebbd163f0">text</a>(), pageWidth, pageHeight);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="comment">// Step 02</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; sortedLines.length() ; i++)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <a class="code" href="classQList.html">WordsWithCharacters</a> &amp;list = sortedLines[i].first;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0 ; k &lt; list.length() ; k++ )</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                <span class="keyword">const</span> QRect area1 = list.at(k).area().roundedGeometry(pageWidth,pageHeight);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                <span class="keywordflow">if</span>( k+1 &gt;= list.length() ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                <span class="keyword">const</span> QRect area2 = list.at(k+1).area().roundedGeometry(pageWidth,pageHeight);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> space = area2.left() - area1.right();</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                <span class="keywordflow">if</span>(space != 0)</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    <span class="comment">// Make a TinyTextEntity of string space and push it between it and it+1</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> left = area1.right();</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> right = area2.left();</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> top = area2.top() &lt; area1.top() ? area2.top() : area1.top();</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> bottom = area2.bottom() &gt; area1.bottom() ? area2.bottom() : area1.bottom();</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                    <span class="keyword">const</span> QString spaceStr(<span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                    <span class="keyword">const</span> QRect rect(QPoint(left,top),QPoint(right,bottom));</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classOkular_1_1NormalizedRect.html">NormalizedRect</a> entRect(rect,pageWidth,pageHeight);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    <a class="code" href="classTinyTextEntity.html">TinyTextEntity</a> *ent1 = <span class="keyword">new</span> <a class="code" href="classTinyTextEntity.html">TinyTextEntity</a>(spaceStr, entRect);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                    <a class="code" href="classTinyTextEntity.html">TinyTextEntity</a> *ent2 = <span class="keyword">new</span> <a class="code" href="classTinyTextEntity.html">TinyTextEntity</a>(spaceStr, entRect);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    <a class="code" href="structWordWithCharacters.html">WordWithCharacters</a> word(ent1, <a class="code" href="classQList.html">QList&lt;TinyTextEntity*&gt;</a>() &lt;&lt; ent2);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                    list.insert(k+1, word);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    <span class="comment">// Skip the space</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                    k++;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <a class="code" href="classQList.html">WordsWithCharacters</a> tmpList;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; sortedLines.length() ; i++)</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            tmpList += sortedLines.at(i).first;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        tmpRegion.<a class="code" href="classRegionText.html#ae8c5a639fec0e060eacb4247cb726da9">setText</a>(tmpList);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">// Step 03</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <a class="code" href="classQList.html">WordsWithCharacters</a> tmp;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; tree.length() ; i++)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        tmp += tree.at(i).text();</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;}</div>
<div class="ttc" id="textpage_8cpp_html_a69c9a8e3d3ed1e7180350337c5c725e2"><div class="ttname"><a href="textpage_8cpp.html#a69c9a8e3d3ed1e7180350337c5c725e2">makeAndSortLines</a></div><div class="ttdeci">QList&lt; QPair&lt; WordsWithCharacters, QRect &gt; &gt; makeAndSortLines(const WordsWithCharacters &amp;wordsTmp, int pageWidth, int pageHeight)</div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l01274">textpage.cpp:1274</a></div></div>
<div class="ttc" id="classOkular_1_1NormalizedRect_html"><div class="ttname"><a href="classOkular_1_1NormalizedRect.html">Okular::NormalizedRect</a></div><div class="ttdef"><b>Definition:</b> <a href="area_8h_source.html#l00105">area.h:105</a></div></div>
<div class="ttc" id="classTinyTextEntity_html"><div class="ttname"><a href="classTinyTextEntity.html">TinyTextEntity</a></div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l00119">textpage.cpp:119</a></div></div>
<div class="ttc" id="structWordWithCharacters_html"><div class="ttname"><a href="structWordWithCharacters.html">WordWithCharacters</a></div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l00258">textpage.cpp:258</a></div></div>
<div class="ttc" id="classRegionText_html"><div class="ttname"><a href="classRegionText.html">RegionText</a></div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l00285">textpage.cpp:285</a></div></div>
<div class="ttc" id="classRegionText_html_a57a630a26401ff61192e66eebbd163f0"><div class="ttname"><a href="classRegionText.html#a57a630a26401ff61192e66eebbd163f0">RegionText::text</a></div><div class="ttdeci">WordsWithCharacters text() const </div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l00306">textpage.cpp:306</a></div></div>
<div class="ttc" id="classRegionText_html_ae8c5a639fec0e060eacb4247cb726da9"><div class="ttname"><a href="classRegionText.html#ae8c5a639fec0e060eacb4247cb726da9">RegionText::setText</a></div><div class="ttdeci">void setText(const WordsWithCharacters &amp;wordsWithCharacters)</div><div class="ttdef"><b>Definition:</b> <a href="textpage_8cpp_source.html#l00321">textpage.cpp:321</a></div></div>
<div class="ttc" id="classQList_html"><div class="ttname"><a href="classQList.html">QList</a></div><div class="ttdef"><b>Definition:</b> <a href="browserextension_8h_source.html#l00034">browserextension.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69c9a8e3d3ed1e7180350337c5c725e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQList.html">QList</a>&lt; <a class="el" href="structQPair.html">QPair</a>&lt;<a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a>, QRect&gt; &gt; makeAndSortLines </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="textpage_8cpp.html#ad911313b0eb678ed7fadf84147e4d1d3">WordsWithCharacters</a> &amp;&#160;</td>
          <td class="paramname"><em>wordsTmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageHeight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create Lines from the words and sort them </p>
<p>We cannot assume that the generator will give us texts in the right order. We can only assume that we will get texts in the page and their bounding rectangle. The texts can be character, word, half-word anything. So, we need to:</p>
<ol type="1">
<li>Sort rectangles/boxes containing texts by y0(top)</li>
<li>Create textline where there is y overlap between <a class="el" href="classTinyTextEntity.html">TinyTextEntity</a> 's</li>
<li>Within each line sort the <a class="el" href="classTinyTextEntity.html">TinyTextEntity</a> 's by x0(left)</li>
</ol>

<p>Definition at line <a class="el" href="textpage_8cpp_source.html#l01274">1274</a> of file <a class="el" href="textpage_8cpp_source.html">textpage.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;{</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="classQList.html">QList&lt; QPair&lt;WordsWithCharacters, QRect&gt;</a> &gt; lines;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">     Make a new copy of the TextList in the words, so that the wordsTmp and lines do</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">     not contain same pointers for all the TinyTextEntity.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <a class="code" href="classQList.html">QList&lt;WordWithCharacters&gt;</a> words = wordsTmp;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">// Step 1</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    qSort(words.begin(),words.end(),compareTinyTextEntityY);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">// Step 2</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="classQList.html">QList&lt;WordWithCharacters&gt;::Iterator</a> it = words.begin(), itEnd = words.end();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">//for every non-space texts(characters/words) in the textList</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">for</span>( ; it != itEnd ; it++)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keyword">const</span> QRect elementArea = (*it).area().roundedGeometry(pageWidth,pageHeight);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0 ; i &lt; lines.length() ; i++)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <span class="comment">/* the line area which will be expanded</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">               line_rects is only necessary to preserve the topmin and bottommax of all</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">               the texts in the line, left and right is not necessary at all</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            QRect &amp;lineArea = lines[i].second;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> text_y1 = elementArea.top() ,</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                      text_y2 = elementArea.top() + elementArea.height() ,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                      text_x1 = elementArea.left(),</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                      text_x2 = elementArea.left() + elementArea.width();</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> line_y1 = lineArea.top() ,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                      line_y2 = lineArea.top() + lineArea.height(),</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                      line_x1 = lineArea.left(),</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                      line_x2 = lineArea.left() + lineArea.width();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">               if the new text and the line has y overlapping parts of more than 70%,</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">               the text will be added to this line</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">if</span>(doesConsumeY(elementArea,lineArea,70))</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                <a class="code" href="classQList.html">WordsWithCharacters</a> &amp;line = lines[i].first;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                line.append(*it);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> newLeft = line_x1 &lt; text_x1 ? line_x1 : text_x1;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> newRight = line_x2 &gt; text_x2 ? line_x2 : text_x2;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> newTop = line_y1 &lt; text_y1 ? line_y1 : text_y1;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> newBottom = text_y2 &gt; line_y2 ? text_y2 : line_y2;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                lineArea = QRect( newLeft,newTop, newRight - newLeft, newBottom - newTop );</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <span class="keywordflow">if</span>(found) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="comment">/* when we have found a new line create a new TextList containing</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">           only one element and append it to the lines</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordflow">if</span>(!found)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <a class="code" href="classQList.html">WordsWithCharacters</a> tmp;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            tmp.append((*it));</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            lines.append(<a class="code" href="structQPair.html">QPair&lt;WordsWithCharacters, QRect&gt;</a>(tmp, elementArea));</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// Step 3</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; lines.length() ; i++)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <a class="code" href="classQList.html">WordsWithCharacters</a> &amp;list = lines[i].first;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        qSort(list.begin(), list.end(), compareTinyTextEntityX);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">return</span> lines;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;}</div>
<div class="ttc" id="structQPair_html"><div class="ttname"><a href="structQPair.html">QPair</a></div><div class="ttdef"><b>Definition:</b> <a href="browserextension_8h_source.html#l00031">browserextension.h:31</a></div></div>
<div class="ttc" id="classQList_html"><div class="ttname"><a href="classQList.html">QList</a></div><div class="ttdef"><b>Definition:</b> <a href="browserextension_8h_source.html#l00034">browserextension.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_34ec08ec70b7578a86b9ade022a43b1a.html">core</a></li><li class="navelem"><a class="el" href="textpage_8cpp.html">textpage.cpp</a></li>
    <li class="footer">Generated on Tue Apr 15 2014 21:15:58 for GP&#39;s Okular Build by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
